

Brownian motion with asymptotically normal reflection]Brownian motion with asymptotically normal reflection in unbounded domains:
from  transience to stability

 
Department of Statistics, University of Warwick, UK
miha.bresar@warwick.ac.uk
 
Department of Statistics, University of Warwick, The Alan Turing Institute, UK
a.mijatovic@warwick.ac.uk

Department of Mathematical Sciences, Durham University, UK
andrew.wade@durham.ac.uk


[
    Andrew Wade
    March 30, 2023
==================




We quantify the asymptotic behaviour of  multidimensional drifltess diffusions in 
 domains unbounded in a single direction, with asymptotically normal reflections from the boundary. 
We identify the critical growth/contraction rates of the domain that separate   stability, null recurrence and transience. In the stable case we prove existence and uniqueness of the invariant distribution and establish the polynomial rate of decay of its tail. We also establish matching polynomial upper and lower bounds on the rate of convergence to stationarity in total variation. 
All exponents are explicit in the model parameters that determine the asymptotics of the growth rate of the domain, the interior covariance, and the reflection vector field.

Proofs are probabilistic, and use upper and lower 
tail bounds for additive functionals up to return times to compact sets, 
for which we develop  
novel sub/supermartingale criteria, applicable to general continuous semimartingales. Narrowing domains fall outside of the standard literature, 

in part because boundary local time can accumulate arbitrarily rapidly. Establishing Feller continuity (essential for characterizing stability) thus requires an extension of the usual approach. 

Our recurrence/transience classification 
extends previous work on strictly normal reflections, and expands the range of phenomena observed across all dimensions. For all recurrent cases, we provide quantitative information through upper and lower bounds on tails of return times to compact sets 
(seeÂ <cit.> for a short https://www.youtube.com/watch?v=oDDDWdbPx74YouTube video describing the results).









Key words:  Reflected diffusion; normal reflection; generalized parabolic domains; recurrence; transience; tails of return-times; invariant distribution; convergence rate in total variation.



AMS Subject Classification 2020:  60J60 (Primary); 60J25, 60J65 (Secondary).







Â§ INTRODUCTION AND MAIN RESULTS

We study the asymptotic behaviour of a multidimensional diffusion in an unbounded,
generalized parabolic domain, with asymptotically normal reflection from the boundary. Our model includes Brownian motion with normal reflection. 
We show that the phase transition between recurrence and transience occurs for asymptotically expanding domains. If the domain narrows asymptotically, we identify the phase transition between  null and positive recurrence.
In the recurrent case we characterise the asymptotic behaviour of the tails of the return times. Moreover, in the positive-recurrent case we prove the existence of the invariant distribution of the reflected diffusion and establish the polynomial rate of decay of its tail. Finally, we establish 
the polynomial rate of convergence to stationarity by proving matching 
upper and lower bounds on the total variation distance
between the marginal and the invariant distribution (see a short https://www.youtube.com/watch?v=oDDDWdbPx74YouTube video describing these resultsÂ <cit.>).

All the aforementioned  phenomena depend on the asymptotic behaviour of the boundary and are exhibited by a normally reflected Brownian motion. In particular, this implies that a normally reflected Brownian motion in an unbounded domain of any dimension (greater thanÂ 1) may 
converge in total variation to its invariant distribution, which has heavy tails.  

Before stating our results, we briefly describe  our setting. For any dâˆˆ, define a closed domain  := {(x,y) âˆˆ_+Ã—^d: y_d â‰¤ b(x)} in ^d+1, where 
Â·_d is the standard Euclidean norm on ^d,
:=[0,âˆ) and
b: _+ â†’_+ is a smooth function with b(0)=0 and b> 0 on (0,âˆ).
Let W = (W_t)_t âˆˆ be a standard Brownian motion in ^d+1 and Î£ a matrix-valued function on , taking values in positive-definite square matrices  of dimension (d+1).
Denote by Î£^1/2 the symmetric square root of Î£ and let Ï•: âˆ‚â†’^d+1 be a vector field  on âˆ‚.
Let 
the processes Z = (Z_t)_t âˆˆ [0,) 
and L=(L_t)_tâˆˆ[0,)
with state spaces  and , 
respectively, 
satisfy
the stochastic differential equationÂ (SDE)

    Z_t = z + âˆ«_0^t Î£^1/2(Z_s)  W_s + âˆ«_0^t Ï•(Z_s)  L_s 
      &   L_t = âˆ«_0^t 1{Z_s âˆˆâˆ‚} L_s,    t âˆˆ [0,),

where âˆˆ [0,âˆ] is a possibly finite explosion time
and L denotes the local time process of Z at the boundary âˆ‚.
For any starting point Z_0=zâˆˆ, 
byÂ <cit.>, SDEÂ (<ref>) has a unique strong solution (with law denoted by _z)
under the assumptions inÂ ass:covariance1, ass:domain1 andÂ ass:vector1 stated in SectionÂ <ref> below. 
Informally,Â ass:covariance1 requires Î£ to be bounded, Lipschitz and uniformly elliptic, ass:domain1 
requires regularity of b at zero to make the domain  smooth,
and ass:vector1 stipulates that the smooth bounded vector field Ï• points into the interior of .
Unlike in the case of oblique reflectionÂ <cit.>, asymptotically normal reflection
does not exhibit explosions.  TheoremÂ <ref>, stated and proved below, asserts that =âˆ _z-a.s. for all starting points zâˆˆ,
which we assume in the remainder of the introduction. 



 Â§.Â§ The main results

The asymptotic growth of the domain  
is described by the parameter 

    Î² := lim sup_x â†’âˆx b'(x)/b(x),

typically  equal to the limit lim_x â†’âˆx b'(x)/b(x)
(e.g.Â if  
b(x) = ax^Î² for x â‰¥ x_0 > 0 and some a > 0, or, more generally, if
b is regularly varying and b' is eventually monotone <cit.>).
For local time in SDEÂ (<ref>) to influence the long-time behaviour of the reflected process Z, we have to assume inÂ ass:domain2 below 
that Î²  inÂ (<ref>)  lies in the interval (-âˆ,1) (cf.Â SectionÂ <ref> below), making the growth of  sublinear (see RemarkÂ <ref> below) and, possibly, asymptotically narrowing. 
AssumptionÂ ass:covariance2 below
permits Î£ to vary smoothly with z =(x,y)âˆˆâŠ‚Ã—^d, but asserts 
that, as xâ†’âˆ, the diagonal entry of Î£ in the x-direction and the sum of the remaining diagonal entries converge to positive
values Ïƒ_1^2 and Ïƒ_2^2, respectively.
AssumptionÂ ass:covariance2 ensures that the process does not stop interacting with the boundary far away from the origin. 

 


AssumptionÂ ass:vector2 specifies linear factors s_0, c_0 âˆˆ (0,âˆ), which 
scale the projections of the vector field Ï• in the x and normal directions, so that, as xâ†’âˆ, the former projection is

asymptotic to s_0 b'(x) while the latter converges to 
c_0.

Since b'(x) â†’ 0 (as Î² < 1), the assumptionÂ ass:vector2 makes the vector fieldÂ Ï• asymptotically normal. Strictly normal reflection hasÂ s_0 = c_0.







The reflected process Z
is
transient (resp. recurrent) if lim_t â†’âˆZ_t_d+1 = âˆ 
(resp. there exists r_0 âˆˆ satisfying lim inf_t â†’âˆZ_t_d+1â‰¤ r_0) _z-a.s.
The recurrence/transience 
transition occurs at the critical growth rate of the boundary 

    Î²_c := c_0Ïƒ_1^2/s_0Ïƒ_2^2.





Suppose that AssumptionsÂ ass:domain2, ass:covariance2, ass:vector2 hold and the process 
Z solves SDEÂ (<ref>). Then the following statements hold for all starting points zâˆˆ:

    
  (a) if Î² < Î²_c, then Z is recurrent;
    
  (b) if Î² > Î²_c, then Z is transient;
    
  (c) if Î² = Î²_c and AssumptionsÂ ass:vector2plus, ass:domain2plus andÂ ass:covariance2plus are satisfied, then  Z is recurrent.





Write Z = (X,Y) âˆˆ in coordinates, so that X_t âˆˆ for tâˆˆ_+.  For any râˆˆ, let 

    Ï‚_r := inf{ t âˆˆ: X_t â‰¤ r}

(with convention infâˆ… :=âˆ) be the return time of Z to âˆ©[0,r]Ã—^d.
 

Define

    m_c  := (1-Î²/Î²_c)/2.

Note that, if Î²<Î²_c, then m_c>0. In this case the following result
implies that the return time
Ï‚_r
is a.s.Â finite, with m_c being the critical moment exponent.



Suppose that AssumptionsÂ ass:domain2, ass:covariance2, ass:vector2 hold and the process 
Z solves SDEÂ (<ref>). Then the following statements hold. 

    
  (a) If Î²âˆˆ(Î²_c,1), then for any level râˆˆ(0,âˆ) and starting point zâˆˆâˆ©(r,âˆ)Ã—^d, there is positive probability that component X does not reach level r,
    
    i.e., 
    _z(Ï‚_r = âˆ) > 0.
    
  (b) If Î²âˆˆ (-âˆ,Î²_c), then 
    for any >0, there exists x_0âˆˆ(0,âˆ), such that for every r>x_0 and zâˆˆâˆ©(r,âˆ)Ã—^d, there exist constants   C_1,C_2âˆˆ(0,âˆ)
for which
    
    C_1t^-m_c-â‰¤_z(Ï‚_râ‰¥ t) â‰¤ C_2t^-m_c+  for all tâˆˆ(1,âˆ).








We say that the process Z is positive recurrent if
_z[Ï‚_r] < âˆ holds for all z âˆˆ and sufficiently large r.
The process Z is null recurrent if it is recurrent but not positive recurrent. 
TheoremÂ <ref>(b) implies that Z is positive (resp. null) recurrent if Î² < -Î²_c
(resp. -Î²_c<Î²<Î²_c).

 By TheoremÂ <ref>(b), positive recurrence of Z occurs if 
 Î² < -Î²_c. In this case, we study properties of the invariant distribution of Z on .
Recall that, byÂ <cit.>, the process Z is strong Markov. An invariant distribution
Ï€ of Z is a probability measure on the Borel Ïƒ-algebra â„¬() generated by  the open subsets of ,
satisfying  âˆ«__z [f(Z_t)]Ï€( z)=âˆ«_ f(z)Ï€( z) for all bounded measurable functions f:â†’ and all tâˆˆ.
A total variation distance between two probability measures Ï†_1 and Ï†_2, defined on â„¬, is given by 
Ï†_1-Ï†_2_TV=sup_Bâˆˆâ„¬|Ï†_1(B)-Ï†_2(B)|.
Define  
    M_c := -(1+Î²/Î²_c)/2,
 
and note that, in the case Î² < -Î²_c, we have M_c>0.



SupposeÂ ass:domain2, ass:covariance2, ass:vector2 hold, 
Z solves SDEÂ (<ref>), and
Î² < -Î²_c.
Then the reflected process Z possesses  a unique invariant distribution Ï€. Moreover, for any Ïµ>0, the following statements hold:

    
  (a) there exist  constants c_Ï€, C_Ï€âˆˆ(0,âˆ)  such that 

    c_Ï€  r^-2M_c-Ïµâ‰¤Ï€({zâˆˆ:z_d+1â‰¥ r})â‰¤ C_Ï€ r^-2M_c+Ïµ,  for all râˆˆ[1,âˆ);

    
  (b) for any starting point zâˆˆ of Z,
there exist constants c_TV,C_TVâˆˆ(0,âˆ) 
such that

    c_TV t^-M_c - Ïµâ‰¤_z(Z_tâˆˆÂ·)-Ï€_TVâ‰¤ C_TVt^-M_c + Ïµ,  for all  tâˆˆ[1,âˆ).





The total variation distance between two probability measures PÌƒ and QÌƒ on a Ïƒ-algebra  of the state space Î©Ìƒ is defined via

    PÌƒ-QÌƒ_TV := sup_A âˆˆ|PÌƒ(A)-QÌƒ(A)|.






TheoremÂ <ref> shows that, surprisingly, a reflected Brownian motion Z in âŠ‚^d+1 with normal reflection 
(i.e., Z in the class of models with Ïƒ_1^2=1, Ïƒ_2^2=d, and 
c_0=s_0, so that Î²_c=1/d)
on an unbounded domain may be polynomially ergodic if the domain narrows sufficiently fast, i.e.Â Î²<-1/d.
In this case the tail 
Ï€({zâˆˆ:z_d+1>r}) 
of the invariant distribution Ï€ decays asymptotically as r^1+dÎ² when râ†’âˆ. Note that if Î²<-1/d,   the domain  has finite volume in ^d+1. However, by modifying either the covariance matrix or the reflection vector field so that Î²_c<1/d, for any Î²âˆˆ(-1/d,-Î²_c) we obtain polynomial stability of the reflected Brownian motion in a domain with infinite volume.  

 TheoremÂ <ref>(a)
characterises the critical moment of the invariant distribution Ï€ of the reflected process Z in a domain  with Î²<-Î²_c:
for any Î± in [0,2M_c) (resp. (2M_c,âˆ)), the moment âˆ«_z_d+1^Î±Ï€( z)  is finite (resp. infinite).
Moreover, by RemarkÂ <ref> below, for every zâˆˆ we have _z(Z_tâˆˆâˆ‚)=0 for Lebesgue almost every tâˆˆ. By TheoremÂ <ref>(b), this implies Ï€(âˆ‚)=0.




The polynomial rate of convergence in total variation of Z_t to stationarity, given in TheoremÂ <ref>(b), is half of the rate of decay of the tail of its stationary measure. Differently put, by TheoremÂ <ref>, we have

    lim_t â†’âˆlog_z(Z_tâˆˆÂ·)-Ï€_TV/log t =1/2lim_râ†’âˆlogÏ€({zâˆˆ:z_d+1>r})/log r = -M_c.





 Â§.Â§ Discussion of the main results

The fact that Ï• is an asymptotically normal reflection implies that, in the case with Î² > 0, the process accumulates a positive drift in the horizontal direction when it reaches the boundary. Here, we observe phase transitions between recurrence and transience depending on the model parameters. When Î² < 0, the process accumulates a negative drift in horizontal direction. In this case, the process is always recurrent, and in some cases the invariant distribution exists. 

We now comment on the comment on the structure of the proofs and discuss features of the theorems in the previous section. A key step in the proofs of 
TheoremsÂ <ref>,Â <ref> andÂ <ref> consists of reducing the problem to certain super/submartingale
conditions that can be verified. We stress that the processes involved (that turn out to be super/submartingales) in all non-critical cases, covering phenomena from transience to stability, are transformations of the reflected process in SDEÂ (<ref>) via a single parametric family of Lyapunov functions. The class of functions we use are not, and should not be, harmonic because the analysis of the return times and quantitative properties of the invariant distribution and rate of convergence require the presence of a sufficiently strong drift.




  Â§.Â§.Â§ Positive recurrence


TheoremÂ <ref> 
provides detailed information on the ergodicity of the reflected process Z, with lower bounds matching the upper bounds.  
To the best of our knowledge, this is the first  characterisation of the  rate convergence to stationarity in the context of reflecting diffusion, including the ones with drift. Upper bounds abound: for exampleÂ <cit.> provide upper bounds on the rate of convergence for various reflected diffusions with drift via drift conditions inÂ <cit.> (due to the presence of the drift, the upper bounds in this case are sub-exponential). 



In contrast, the literature for lower bounds is scarce. 
Our approach to the lower bounds on the rate of convergence is purely probabilistic. It rests on 
novel continuous super/submartingale methods, based on LemmaÂ <ref> below,
which provide a general setting where the full force of the  idea behindÂ <cit.> (see LemmaÂ <ref> in AppendixÂ <ref> below)
can be exploited.  
The approach is robust to the underlying stochastic model and appears to be applicable to a general continuous ergodic Markov processes.   




The first step in the proof of TheoremÂ <ref>
consists of establishing the Feller continuity (TheoremÂ <ref> below) and 
irreducibility (PropositionÂ <ref> below) for the reflected process Z. The key technical challenge in this step consists of controlling the growth of the local time (cf. SectionÂ <ref> below), which requires establishing Feller continuity of the stopped process first (see proof of TheoremÂ <ref> for details).

Once Feller continuity and irreducibility of Z have been established, the upper bounds in TheoremÂ <ref> are proved 
using supermartingale conditions together with the classical convergence results inÂ <cit.>, applicable in the 
subexponential case. This yields finiteness of moments of the invariant distribution Ï€, which is then translated into upper bounds on the tails  in TheoremÂ <ref> via Markov's  inequality. 

The lower bounds in TheoremÂ <ref> require a lower bound on the tail of the invariant distribution Ï€. In contrast to the upper bounds, characterising infinite moments of Ï€
alone does not yield a lower bound on the tail of Ï€. In order to circumvent this problem, we give a criterion for âˆ«_ H Ï€=âˆ for any  non-decreasing function H (not only polynomial). This criterion is obtained by LemmaÂ <ref>.
Once established, the criterion 
yields lower bounds on the tail of Ï€ via elementary methods (see proof of LemmaÂ <ref> below). The lower bound on the rate of convergence in total variation in TheoremÂ <ref> follow from a supermartingale property of a transformed reflected diffusion inÂ (<ref>), the lower bounds on the tail of the stationary distribution Ï€
and a general result inÂ <cit.> (see LemmaÂ <ref> in AppendixÂ <ref> below) that converts the tails of the stationary distribution to a lower bound on the convergence rate in total variation. 

Finally we note that, in TheoremÂ <ref>, the critical case Î²=-Î²_c is omitted for brevity. Its analysis would require additional assumptions and a new Lyapunov function, analogous to the ones used in the proof of the critical case of TheoremÂ <ref>(c). We expect that, under appropriate assumptions, such analysis would yield ergodicity of the normally reflected Brownian motion with logarithmic decay in any dimension. 






  Â§.Â§.Â§ Return times

If the reflected process is transient, return times to compact sets are not finite almost surely (we will thus discuss TheoremÂ <ref>(a) in SectionÂ <ref> below). In the recurrent case,
the upper bound on the tail of the return time in TheoremÂ <ref>(b) is established via a supermartingale condition of a transformation of the reflected process, which (viaÂ <cit.>) implies the finiteness of the moments of return times. The upper bounds in the theorem then follow by Markov's inequality. 



The lower bound in  TheoremÂ <ref>(b) is established via certain submartingale conditions and 
lower bounds on the tails of return times to bounded sets in LemmaÂ <ref>.
As in the proof of TheoremÂ <ref> discussed above,
 LemmaÂ <ref> is again critical here (as the infinite moment criterion ofÂ <cit.> cannot be applied to obtain the lower bounds on the tail). Note that 
 LemmaÂ <ref> is applicable in the entire recurrent regime.
 This is key in the 
 proof of TheoremÂ <ref>(b), in contrast to the proof of TheoremÂ <ref>, where LemmaÂ <ref> is applied in the positive-recurrent case only. 
 






 As our modelling assumptions ass:covariance2, ass:domain2, ass:vector2 are asymptotic (i.e., they only specify the limiting behaviour both of the coefficients of SDEÂ (<ref>), the domain  and the reflection vector field as x â†’âˆ, see SectionÂ <ref> below for details), it is natural for TheoremÂ <ref>(b) to assert the tail behaviour of return times for sufficiently large levels r only. However, with some further work,
using an argument based on uniform ellipticity and
escape from the boundary, extending
the ideas ofÂ <cit.> and SectionÂ <ref> below
from first moment to higher moments estimates, this requirement could be removed.







Note also that, by AssumptionÂ ass:domain2, the function b is sublinear as x â†’âˆ, implying that there exist positive constants c < C, such that c x â‰¤z_d+1â‰¤ Cx for all z=(x,y)âˆˆâˆ© (1,âˆ)Ã—^d.
TheoremÂ <ref> may thus be restated for return times of Z=(X,Y), given in terms of Z_d+1, instead of the scalar process X.



 

Recall that for the modulus of the scalar Brownian motion, the critical exponent for return times equals 1/2, with moments of order less (resp. greater) than 1/2 being finite (resp. infinite).
By TheoremÂ <ref>(b), for domains with asymptotically increasing 
(resp. decreasing) boundary function b, i.e.Â Î² > 0 (resp. Î²<0), the critical exponent m_c for the return times of the reflected process satisfies 0<m_c<1/2 (resp. 1/2<m_c). Differently put, the reflected process in an asymptotically expanding (resp. narrowing) domain is, due to the asymptotically positive (resp. negative) projection of the reflection vector field in the x-direction,
â€œlessâ€ (resp. â€œmoreâ€) recurrent than the modulus of the scalar Brownian motion.


In the case Î² = 0, the boundary function b may (but need not, see LemmaÂ <ref> below) be asymptotically constant, see the discussion in RemarkÂ <ref> below. 


In this case, the projection of the reflection vector field converges to zero sufficiently fast, so that the critical moment exponent of the return time equals m_c= 1/2,
regardless of other model parameters. 




  Â§.Â§.Â§ The recurrence/transience dichotomy


TheoremÂ <ref>  characterises the recurrence/transience dichotomy for the reflected process defined by the SDE inÂ (<ref>) above. 
Its proof relies on a generalisation to continuous time, given in  SectionÂ <ref> below, of the classical Fosterâ€“Lyapunov criteria for transience and recurrence. We stress that our approach is purely probabilistic: our criteria are phrased in terms of continuous-time supermartingale conditions. In particular,  neither the Markov property nor any explicit knowledge of the infinitesimal characteristics of the process are required (cf.Â discussion about the approach inÂ <cit.> in SectionÂ <ref> below). Both of these features are crucial in the proof of TheoremÂ <ref>.



The critical asymptotic growth rate 
Î²_c is always positive (see AssumptionsÂ ass:covariance2 andÂ ass:vector2). 
By TheoremÂ <ref>, if Î²_c â‰¥ 1, then Z is recurrent 
for all boundary functions b satisfyingÂ ass:domain2. 
This is for example the case for the two-dimensional Brownian motion 
(Ïƒ_1^2=Ïƒ_2^2=1 and d=1)
with normal reflection (c_0=s_0) in âŠ‚^2, as 
in this case we have 
Î²_c = 1.
Note that, in any dimension dâˆˆ,
the critical growth rate Î²_c may be greater than one, implying recurrence for all boundary functions satisfyingÂ ass:domain2.

TheoremÂ <ref>(a) strengthens transience 
of Z, stated in TheoremÂ <ref>(b). TheoremÂ <ref>(a) shows
that for any r>0 and  z âˆˆâˆ©(r,âˆ)Ã—^d,
the process Z does not visit the set 
âˆ©[0,r]Ã—^d
with positive probability (under _z), even though x-r>0 can be arbitrarily small (where z=(x,y)). The proof of TheoremÂ <ref>(b)
establishes only that, with positive probability, the process Z does not return 
to âˆ©[0,r]Ã—^d
 after reaching the set
 âˆ©(r_1,âˆ)Ã—^d
for a sufficiently large r_1âˆˆ(r,âˆ).
As our assumptions are asymptotic, this extension requires proving, using basic analytical techniques, that,  with positive probability, the reflected process reaches an arbitrarily high level before visiting a neighbourhood of the origin.



 Â§.Â§ A heuristic




  To give some intuition behind the main results, we describe a heuristic comparison with reflecting Brownian motion in an interval.

We try to estimate how much horizontal drift the process accumulates via reflections by heuristic renewal argument <cit.>. Suppose that the process is at the horizontal position x. Over the short time scale we can approximate the of the vertical coordinate by a reflecting diffusion Y_t/b(x) on the unit sphere ğ•Š^d-1, where b(x) = r, for some râˆˆ. This diffusion has zero drift and combined infinitesimal variance of Ïƒ_2^2/b(x)^2 along with the vertical reflection of magnitude c_0/b(x). For râˆˆ define Ï„_r = inf{t â‰¥ 0: Y_t_d = r}. Let y_r denote the starting point for the process Y satisfying y_r_d = r. Let _y_r denote the expectation with respect to the process Y started at Y_0 = y_r. Recall that b(x)=r. We apply ItÃ´â€™s formula for diffusions with reflection to the process r^-2Y_t_d^2. Note that from the infinitesimal variance, it follows that the drift of the process is of magnitude r^-2Ïƒ_2^2 and the boundary reflection is at -2r^-1c_0.

In the first case we start at y_r/2 and terminate at Ï„_r, and in the second case we start at y_r and terminate at Ï„_r/2. We obtain

    1 = _y_r/2[r^-2Y_Ï„_r^2] = 4^-1 + r^-2_y_r/2[âˆ«_0^Ï„_rÏƒ_2^2 t] = 4^-1 + r^-2Ïƒ_2^2_y_r/2[Ï„_r],

and

    4^-1 = r^-2_y_r[Y_Ï„_r/2^2] = 1 + r^-2Ïƒ_2^2_y_r[Ï„_r/2] - 2r^-1 c_0 _y_r[L_Ï„_r/2].

Clearly L_Ï„_r = 0 _y_r/2-a.s.
From the above equation we obtain

    _z_r/2[L_Ï„_r] + _z_r[L_Ï„_r/2]/_z_r[Ï„_r/2] + _z_r/2[Ï„_r] = Ïƒ_2^2/2rc_0.

Since r = b(x), the expected local time accumulated by Y_t at { y _d= r}, over  the  complete cycle starting at y_r/2_d = r/2 and ending again at y_r/2_d = r/2, is equal to Ïƒ_2^2/2c_0b(x). 


Recall that X denotes the x-component of the reflected process Z inÂ (<ref>).
An informative heuristic argument in <cit.>, based on the renewal theorem, 
estimates that the average local time 

accumulates as 


Suppose the process is at horizontal positionÂ x.
Over short time-scales, 
imagine we may approximate the behaviour of the vertical coordinate by a diffusion on the interval [-b(x),b(x)].
This diffusion has zero drift and infinitesimal variance aboutÂ Ïƒ^2.
The (vertical) reflection is effectively of magnitudeÂ c_0. After a transformation, this is
equivalent to unit-magnitude reflection for Brownian motion on [-b(x)/c_0,b(x)/c_0] with variance Ïƒ^2/c_0^2.
By an heuristic renewal argument similar toÂ <cit.>, this process should accrue boundary local time on average at rate about Ïƒ^2/2c_0 b(x).



    L_tâ‰ˆÏƒ_2^2/(2c_0b(x)) t,    when  X_t is at level x.

By SDEÂ (<ref>) and the definition of Î² inÂ (<ref>), the total instantaneous drift of X
(when X_t=x)
is thus approximately equal to
s_0 Ïƒ_2^2 b'(x)/(2c_0 b(x)) â‰ˆ s_0 Ïƒ_2^2 Î²/(2c_0 x) for large xâˆˆ. 
Consequently, the large-scale behaviour of the horizontal coordinate X of Z is resembles that of the solution of the SDE
XÌƒ_t = s_0 Ïƒ_2^2 Î²/(2c_0 XÌƒ_t) t+Ïƒ_1WÌƒ_t
for large times t and values XÌƒ_t,
where  Î²âˆˆ(-âˆ,1) and WÌƒ is a one-dimensional Brownian motion. After time-changing the SDE for XÌƒ 
by tâ†¦ tÏƒ_1^2, we obtain  a Bessel-type process 

whose drift coefficient is determined by
the ratio Î²/Î²_c. For Î² > 0, we have a Bessel process of dimension 
2Î²/Î²_c and


the transition between recurrence and transience in the heuristic matches that of the result in TheoremÂ <ref>. In the case Î²<0,  the standard literature on Langevin diffusionsÂ <cit.> implies that the invariant distribution exists if Î²< -Î²_c, the tail of invariant distribution decays at the rate x^Î²/Î²_c+1 (as xâ†’âˆ) and the convergence to the invariant distribution is polynomial with the critical exponent (1+Î²/Î²_c)/2. Again the heuristic coincides with our results inÂ TheoremÂ <ref>.

 
The definition of the asymptotically normal reflection requires the projection of the vector field Ï• in the x-direction to decay as s_0 b'(x)â†’0, when xâ†’âˆ. 
The heuristic inÂ (<ref>) further motivates this definition: allowing a rate of decay 
of the projection of Ï• in the x-direction
different from that ofÂ b'(x) 
would miss phase transitions and other criticality phenomena.  
Moreover, heuristicÂ (<ref>) and the definition of Î² inÂ (<ref>) suggest that, in the super-linear case  
 Î²>1, the drift of X produced by the reflection at the boundary is asymptotically decays as x^-Î² for large x âˆˆ.  Such a drift is too weak to influence the long-term behaviour of the reflected process, because the process does not interact with the boundary sufficiently often. 





Finally we note that the heuristic inÂ (<ref>)
illustrates the difference between our domain , satisfyingÂ ass:domain2,
and the smooth domains studied inÂ <cit.>. 
Recall fromÂ <cit.> that  the domain  with asymptotically narrowing boundary does not satisfy the assumptions ofÂ <cit.>. This difference is more than just a technical caveat: one of the crucial features of the domains considered inÂ <cit.> is the availability of bounds, uniform in the starting point, of the increments of expected local time. In contrast, for a narrowing domain 
 (i.e., b(x)â†’ 0 when xâ†’âˆ), byÂ (<ref>),
an increment of local time over a short time period cannot be bounded uniformly in the starting point because its growth is proportional to 1/b(x).

We circumvent this issue via localisation, resulting in more involved proofs of fundamental properties such as the Feller continuity (see TheoremÂ <ref>).
Moreover, in the case of asymptotically oblique reflection, 
a narrowing domain  may result in an explosive reflected 
Brownian motion and explosive local timeÂ <cit.>, suggesting further that local time in 
can grow arbitrarily fast.





 Â§.Â§ Related literature



The theory of reflecting diffusions began withÂ <cit.>.
A large literature is dedicated to reflecting diffusions in bounded domains (see e.g.Â <cit.>). In the unbounded case, the classical domains are cones  (see e.g. <cit.>). Reflecting diffusions have been extensively studied due to their vast applications, including queueing theoryÂ <cit.> and mathematical financeÂ <cit.>.

Our domain  in the case of (strictly)
normal reflection has been  studied inÂ <cit.>.
TheoremÂ <ref>  can be viewed as a generalisation
of a result inÂ <cit.>, which 
considers the case where Î£(z)
equals the identity matrix and the reflection vector field is given by the unit normal on the entire boundary âˆ‚. In the context of our model, this setting is within the subclass Ïƒ_1^2=1, Ïƒ_2^2=d 
and c_0=s_0=1 (recall that these constants specify only the limiting values of Î£(z) and the reflection field Ï•
on âˆ‚ as xâ†’âˆ).

ByÂ <cit.>, the  (d+1)-dimensional Brownian motion with normal reflection has phase transitions between transience and recurrence at Î²_c = 1/d, cf.Â (<ref>).
In particular, when dimension d is large, recurrence occurs only when the the boundary function grows at 
rate slower than 1/d, i.e., very slowly.
In addition, TheoremÂ <ref>(a) reveals that a (d+1)-dimensional reflected Brownian motion may be recurrent for a boundary function b with growth close to linear if 
the projection of the reflection vector field Ï• in the x-direction decays as 
 s_0 b'(x)â†’0, when xâ†’âˆ, for a sufficiently small constant s_0>0 (note that the projection in the x-direction of the normal reflection 
decays precisely at the rate b'(x)â†’0).
Moreover, TheoremÂ <ref>(a) and the formula inÂ (<ref>) imply that Z 
with normal reflection (i.e.Â s_0=c_0)
may be recurrent for the growth rate Î² (of the boundary function b) arbitrarily close to one, if the instantaneous variance of Z in the x-direction is greater than the sum of the variances in all other directions. 

 A general result inÂ <cit.>, for domains satisfying existence and uniqueness conditions ofÂ <cit.>,  states
that a (d+1)-dimensional Brownian motion with normal reflection is positive recurrent if and only if  has finite volume. As in the case of TheoremÂ <ref> above,
 TheoremÂ <ref> and formulaÂ (<ref>)  contrast with the result ofÂ <cit.>. 
 It is easy to see that the right choice of parameters results in 
 positive (resp. null) recurrence in the domains with infinite (resp. finite) volume, e.g.Â Î²<-1/(s_0d) (resp. 
 -1/(s_0d)<Î²<1/(s_0d)) in the example in the previous paragraph.

 
 
 
 
 
 
 
 
 
 










As discussed in SectionÂ <ref> above, some of the technical difficulties in our paper arise due to the fact that our domain 
 with the function b decreasing to zero (e.g.Â Î² < 0)
violates the smoothness condition of domains inÂ <cit.>.
A general framework, via submartingale problems, for a large family of domains that fail to satisfy the assumptionsÂ <cit.> was developed inÂ <cit.>. Similar ideas were employed inÂ <cit.> to characterise stationary distribution for large family of reflecting diffusions with piecewise smooth boundaries.
Finally we note that the invariant distribution and the rate of convergence of the reflecting Brownian motion with drift have been studied inÂ <cit.>, motivated by applications in particle systems (see SectionÂ <ref> above  for a brief discussion of the relation between our result and those inÂ <cit.>).
The structure of the paper is given in the table of contents above.

 






Â§ MODELLING ASSUMPTIONS AND PRELIMINARY RESULTS





 Â§.Â§ Modelling assumptions

For any  d âˆˆ := {1,2,â€¦}, let Â·_d denote the Euclidean norm on ^d. 

Define the closed domain âŠ‚Ã—^d, where  [0,âˆ), by

    := { z =(x,y)âˆˆÃ—^d:  y _d â‰¤ b(x)},  where b: â†’

is
strictly positive and differentiable on (0,âˆ) with b(0)=0.
Let 
âˆ‚={zâˆˆ:y_d =b(x)} be the boundary of  in ^d+1 and denote the unit sphere in ^d by ğ•Š^d-1 := { u âˆˆ^d: u _d = 1}. Let e_x := (1,0) âˆˆğ•Š^dâŠ‚Ã—^d denote the unit vector in the x-direction and, for any u âˆˆğ•Š^d-1, define e_u := (0,u) âˆˆğ•Š^d. 
We can express z=(x,y)âˆˆ 
as z=xe_x+y_d e_Å·, 
where Å· := y /  y _dâˆˆğ•Š^d-1 for y _d > 0
(if 
y _d =0, we may chose Å· to be any vector in ğ•Š^d-1).




Recall that the functions Î£: â†’_d+1^+
and Ï•:âˆ‚â†’^d+1
are the instantaneous variance and the reflection vector field at the boundary of the domain  in SDEÂ (<ref>) above. Throughout we denote 
by 
_d+1^+ 
the group of positive  definite square matrices  of dimension (d+1).











  ass:domain1(D1)
Let b be a continuous function on , with b(0) = 0 and b(x) > 0 for x > 0. Suppose that b is twice continuously differentiable  on (0,âˆ), such that (i) lim inf_x â†’ 0 (b(x)b'(x)) > 0, and (ii) lim_x â†’ 0(bâ€(x)/b'(x)^3) exists in (-âˆ,0].


 

  ass:covariance1(C1) 
Let Î£: â†’_d+1^+ be bounded, globally Lipschitz, and uniformly elliptic, i.e., there exists Î´_Î£ > 0 such that, for every u  âˆˆğ•Š^d and all z âˆˆ, we have âŸ¨Î£(z)u,uâŸ©â‰¥Î´_Î£.
 
 




 


  ass:vector1(V1) 
Suppose Ï•: âˆ‚â†’^d+1 is a C^2-vector field, satisfying sup_z âˆˆâˆ‚Ï•(z)_d+1 < âˆ and 
 
    inf_x > 0inf_Å·âˆˆğ•Š^d-1âŸ¨Ï•(x,b(x) Å·),n(x,b(x) Å·) âŸ© > 0,

 where n(z)=n(x,b(x) Å·) 
 is the inwards-pointing unit normal vector at z=(x,y)âˆˆâˆ‚.
 
  
  
  AssumptionÂ ass:vector1 requires the vector field Ï• to be smooth, of bounded magnitude and have a uniformly positive component in the normal direction (throughout the paper, âŸ¨Â·,Â·âŸ© denotes the standard inner product on ^d+1).
  AssumptionÂ ass:domain1 guarantees that the boundary âˆ‚ is sufficiently regular everywhere, including the origin (seeÂ <cit.> for details). 
AssumptionÂ ass:covariance1 ensures that the process Z is not locally constrained in any direction. Throughout we use the  


matrix norm  Î£(z)_op := sup_vâˆˆğ•Š^dÎ£(z) v_d+1.
(In particular, since Î£^1/2(z)_op^2 = sup_v âˆˆğ•Š^dâŸ¨Î£(z)v,vâŸ©=Î£(z)_op equals the largest eigenvalue of Î£, the boundedness of Î£ implies the boundedness of Î£^1/2.)
  
  


Under assumptions ass:vector1, ass:domain1 and ass:covariance1, the process Z may explode with positive probability. In fact, byÂ <cit.>, we may have (<âˆ)=1. 

The following additional assumptions preclude explosion (i.e., as we shall see, imply (=âˆ)=1) and allow us to characterise transience and recurrence of the process Z;
see TheoremÂ <ref> above for a detailed statement.



  ass:domain2(D2) 
Suppose thatÂ ass:domain1 holds, lim_x â†’âˆ b'(x) = lim_x â†’âˆ bâ€(x) = 0, the limit inÂ (<ref>) exists and satisfies lim_xâ†’âˆ xb'(x)/b(x)=Î²âˆˆ (-âˆ,1).
 
  ass:covariance2(C2) 
 Suppose that ass:covariance1 holds and that there exist Ïƒ_1^2,Ïƒ_2^2 âˆˆ (0, âˆ) such that

    âŸ¨Î£(z)e_x,e_xâŸ© = Ïƒ_1^2(1+o_(1))   and  Î£(z) -Ïƒ_1^2 = Ïƒ_2^2(1+o_(1))  as xâ†’âˆ.


  ass:vector2(V2) 
Suppose that ass:vector1 holds and that there exist s_0,c_0 âˆˆ (0,âˆ) such that 
 
    âŸ¨Ï•(z),e_x âŸ© = s_0b'(x)(1+o_âˆ‚(1))  and  âŸ¨Ï•(z),-e_Å·âŸ© =c_0(1+o_âˆ‚(1))  as xâ†’âˆ.



Here and throughout,
for any g:â†’(0,âˆ)
and âˆˆ{,âˆ‚}, 
o_(g(x)) 
as xâ†’âˆ
denotes a function f:â†’ 
satisfying






lim_xâ†’âˆsup_y:(x,y) âˆˆ|f(x,y)|/g(x) = 0.




Since Assumption ass:domain2 requires lim_xâ†’âˆ xb'(x)/b(x)=Î² < 1, 
for any Î²' âˆˆ (Î²,1) we have
b(x) < C_0x^Î²' for some positive constant C_0 and all sufficiently large x âˆˆ, implying that b has sublinear growth as x â†’âˆ. Note however that, as x â†’âˆ, Assumption ass:domain2 allows b to have any of the following limits: infinity (requiring Î²â‰¥ 0), a positive finite limit (requiring Î² = 0) or a limit equal to 0 (requiring Î²â‰¤ 0). Interestingly, in the case Î²=0 the boundary function b  may exhibit a variety of different behaviours at infinity. For instance, b may grow to infinity (e.g.Â b(x) â‰ˆlog x), converge to 0 (e.g.Â b(x) â‰ˆ 1/log x), or be asymptotically constant. Furthermore, it is also possible for the function b to oscillate, 

i.e.Â  lim sup_x â†’âˆb(x) = âˆ and lim inf_x â†’âˆ b(x) = 0. For example, any function b satisfying 
    b(x) â‰ˆ (1 + (loglog x)^-2 + sinloglog x)loglog x  as xâ†’âˆ,

exhibits such behaviour (see AppendixÂ <ref> for proof that such a function satisfiesÂ ass:domain2).

AssumptionÂ ass:covariance2 ensures that the instantaneous covariance of the process Z stabilises at a positive level in the x-direction as x tends to infinity, without taking up all of the volatility of the process (Î£ denotes the sum of the diagonal elements of Î£). 
Since for the unit normal n(x,y) at (x,y)âˆˆâˆ‚, the inner products âŸ¨ n(x,y),e_xâŸ©
and 
âŸ¨ n(x,y),-e_Å·âŸ©
are asymptotically equivalent to b'(x) and 1, respectively,
as xâ†’âˆ, AssumptionÂ ass:vector2 requires that the vector field Ï• has the same asymptotic behaviour as the unit normal n(x,y) up to positive constants. As we shall see, it is precisely this property that precludes explosions of the process Z and gives rise to the phenomena studied in this paper. 


TheoremÂ <ref> above gives rise to the critical exponent Î²_c,
defined inÂ (<ref>) above,
at which the global behaviour of Z transitions between recurrence and transience.  
Quantification of the limits in  AssumptionsÂ ass:vector2, ass:domain2 and ass:covariance2 are required to understand the behaviour of Z if the boundary of the domain grows at the critical rate   
Î²=Î²_c (seeÂ (<ref>) above for the link between the growth rate of the boundary and exponent Î²).






  ass:domain2plus(D2+)
Assume ass:domain1 and that there exists  Î²âˆˆ (0, 1)  such that

    x b'(x) = Î² b(x)(1+o(b(x)^2x^-2)  )   as x â†’âˆ.


  ass:covariance2plus(C2+)
Assume ass:covariance1 and that there exist Ïƒ_1^2,Ïƒ_2^2 âˆˆ (0, âˆ) and  Ïµ > 0 such that, as xâ†’âˆ,

    âŸ¨Î£(z)e_x,e_xâŸ© = Ïƒ_1^2(1+o_(x^-))   and  Î£(z) - Ïƒ_1^2 = Ïƒ_2^2(1+o_(x^-Ïµ)).


  ass:vector2plus(V2+)
Assume ass:vector1 and that there exist s_0,c_0 âˆˆ (0,âˆ) such that, as xâ†’âˆ, 
 
    âŸ¨Ï•(z),e_x âŸ© = s_0b'(x)(1+o_âˆ‚(b(x)^2x^-2))   and  âŸ¨Ï•(x,y),-e_Å·âŸ© =c_0(1+o_âˆ‚(b(x)^2x^-2)).









 Â§.Â§ ItÃ´'s formula for the reflected process
and Lyapunov functions


We start by noting that under AssumptionsÂ ass:covariance1, ass:domain1 andÂ ass:vector1,  byÂ <cit.>, SDEÂ (<ref>) has a unique strong solution (Z,L,) for any starting point in a generalised parabolic domain  defined inÂ (<ref>).
In SectionÂ <ref> we prove TheoremÂ <ref>
(which shows that =âˆ, a.s.) and TheoremÂ <ref>. 
SectionsÂ <ref> andÂ <ref>
prove TheoremsÂ <ref> andÂ <ref>, respectively.

A key step in each of these proofs consists of the application of ItÃ´'s formula to an appropriate Lyapunov function. More precisely,
let f:â†’ denote a C^2-function on the open domain âˆ–âˆ‚, such that its gradient âˆ‡ f (i.e., the vector of the partial derivatives of f) has a continuous extension to the closed domain  (e.g. if 
 f has a C^2-extension to an open set in ^d+1 containing , which is typically the case in applications below).
By  ItÃ´â€™s formulaÂ <cit.> we obtain

    f(Z_t) = f(Z_0) + M_t 
        + 1/2âˆ«_0^t Î”_Î£ f(Z_s) s + âˆ«_0^t âŸ¨âˆ‡ f(Z_s),Ï•(Z_s)âŸ© L_s,  0â‰¤ t<,

where Î”_Î£ f :=  (Î£^1/2H(f)Î£^1/2)=(Î£ H(f))

is the Î£-Laplacian of f (recall that the Hessian matrix H(f):â†’_d+1^+ consists of the second partial derivatives of f). The (scalar) process M and its quadratic variation [M] on the stochastic interval [0,) are given by 

    M_t := âˆ«_0^t âŸ¨âˆ‡ f(Z_s),Î£^1/2(Z_s) W_sâŸ©&
    [M]_t=âˆ«_0^t Î£^1/2(Z_s)âˆ‡ f(Z_s)_d+1^2  s,0â‰¤ t<.


The strategy of the proofs that follow consists of  applying the continuous semimartingale results of SectionÂ <ref> below
to the process Îº=f(Z) 
for suitable C^2-Lyapunov functions f.
In particular, we will 
use the representation of the quadratic variation [M]
inÂ (<ref>) to conclude that the appropriately stopped process M is a true martingale. 






















Pick w âˆˆâˆ–{0}.
Define
k_w:=1+ sup_x âˆˆ(|w(1-w)|^1/2b(x)-x).

Note that, underÂ ass:domain2, the function b has sublinear growth at infinity (see RemarkÂ <ref> above), implying 1 â‰¤ k_w < âˆ. 
For any z=(x,y)âˆˆ and parameter Î³âˆˆ define

    f_w,1(z):=(x+k_w)(1  + w(1-w)y _d^2/2(x+k_w)^2)^1/w  &   f_w,Î³(z):=f_w,1(z)^Î³.

Since, for (x,y) âˆˆ, we have y_d â‰¤ b(x), the definition of k_w implies  

    1/2â‰¤ 1  + w(1-w)y _d^2/(2(x+k_w)^2)â‰¤ 3/2   for all 
    wâˆˆâˆ–{0}.

Thus
(x+k_w)2^-1/| w|â‰¤ f_w,1(x,y)â‰¤ (x+k_w)2^1/| w| for all parameter values wâˆˆâˆ–{0}. Moreover, 
for any (x,y) âˆˆ we have 

    (x+k_w)^Î³2^-|Î³|/| w|â‰¤ f_w,Î³(x,y)â‰¤ (x+k_w)^Î³2^|Î³|/| w|    for all  Î³âˆˆ.


Note that, for Î³>0
(resp.Â Î³ <0), the function 
f_w,Î³ tends to infinity (resp.Â zero) as xâ†’âˆ, 

making it suitable for the application of the results in SectionÂ <ref>.
Moreover, it is clear that (for all choices of parameters Î³ and w) 
f_w,Î³ is a C^2-function on the open domain âˆ–âˆ‚ and its gradient âˆ‡ f_w,Î³ has a continuous extension to the closed domain .

The Lyapunov function f_w,Î³ is inspired by a generalisation of a polynomial approximation of the 2-dimensional harmonic function h_w(z) = r^wcos(wÎ¸) (given in polar coordinates z=(r,Î¸) of the plane), previously used in the analysis of the reflected processes in wedgesÂ <cit.>. 






The following lemma provides asymptotic properties of the relevant derivatives of f_w,Î³.



Let assumptionsÂ ass:vector2, ass:domain2 and ass:covariance2 hold and fix 
Î³âˆˆ and wâˆˆâˆ–{0}. Then


    Î”_Î£ f_w,Î³(z) = Î³ f_w,1(z)^Î³-2(Ïƒ_1^2(Î³-1)+Ïƒ_2^2(1-w)  +o_(1))  as xâ†’âˆ.

There exists a constant C>0, such that

    âˆ‡ f_w,Î³(z)_d+1^2 â‰¤ C (x+k_w)^2(Î³-1) for all  z=(x,y)
    âˆˆ.

Moreover, 
if Î³ (s_0 Î²/c_0 - 1 + w)<0 (resp.Â >0), then 
there exists a positive x_0 such that for all z=(x,y) âˆˆâˆ‚âˆ© [x_0,âˆ)Ã—^d  we have
âŸ¨âˆ‡ f_w,Î³(z),Ï•(z)âŸ© < 0 (resp.Â > 0).





Note that the constants in o_(1), as well as C and x_0, in LemmaÂ <ref>
depend on the values of the parameters Î³âˆˆ and wâˆˆâˆ–{0}.



Denote 
v(x,y):=y/(x+k_w)âˆˆ^d and define the scalar

h(z):=1  + w(1-w) v(z)_d^2/2.
For any z=(x,y)âˆˆ we have y_dâ‰¤ b(x) 
and, byÂ ass:domain2 (see also RemarkÂ <ref> above), b(x)=o(x^Î²') as xâ†’âˆ for any Î²'âˆˆ(Î²,1).
Hence v(z)_d=o_(1) and, for any râˆˆ, h(z)^r = 1 + o_(1) as xâ†’âˆ.
Since
h(z)>0 
(byÂ (<ref>))
and 
f_w,1(z)=(x+k_w)h(z)^1/w
for any z=(x,y)âˆˆ,  we obtain 

    âˆ‡ f_w,1(z)   =h(z)^1/w(
    e_x(1-(1-w)v(z)_d^2/h(z)) + e_Å· (1-w)v(z)_d/h(z))
    
    
    
    
    
       =
    (1+ o_(1))(e_x+e_Å·(1-w)v(z)_d)
    
    
    
    
      as xâ†’âˆ.

(See the first paragraph of SectionÂ <ref>
for the definition of Å·, e_x and e_Å·.)
Moreover, since
v(z)_d=o_(1) as xâ†’âˆ
and
âˆ‡ f_w,Î³(z)=Î³ f_w,Î³-1(z)âˆ‡ f_w,1(z), 
byÂ (<ref>)
there exists a positive constant C satisfying

    âˆ‡ f_w,Î³(z)_d+1^2    = Î³^2f_w,Î³-1(z)^2 (1 + o_(1)) â‰¤ C(x+k_w)^2(Î³-1)  for all z=(x,y)âˆˆ.






Recall that f_w,Î³-1(z)>0 byÂ (<ref>) for all zâˆˆ.
Thus, for zâˆˆâˆ‚,
the signs of 
âŸ¨âˆ‡ f_w,Î³(z),Ï•(z)âŸ©
and
Î³âŸ¨âˆ‡ f_w,1(z),Ï•(z)âŸ©
are equal.
AssumptionÂ ass:vector2 implies
âŸ¨ e_x,Ï•(z)âŸ©=s_0b'(x)(1+o_âˆ‚(1))
and 
âŸ¨ e_Å·,Ï•(z)âŸ©=-c_0(1 +o_âˆ‚(1)) 

as xâ†’âˆ. 
Note that for z=(x,y)âˆˆâˆ‚
we have v(z)_d=b(x)/(x+k_w).
ByÂ (<ref>) we thus obtain



    Î³âŸ¨âˆ‡ f_w,1(z),Ï•(z)âŸ©   = Î³ (s_0b'(x) -c_0 (1-w)v(z)_d)(1 + o_âˆ‚(1))
    
       =Î³  b(x) (x+k_w)^-1( s_0 (x+k_w) b'(x)/b(x) - c_0 (1-w)) (1+ o_âˆ‚(1)) 
       = Î³ b(x)(x+k_w)^-1(  s_0 Î² - c_0 (1-w) + o_âˆ‚(1)) (1+ o_âˆ‚(1))
       =  c_0 b(x)(x+k_w)^-1[Î³(s_0 Î²/c_0 - 1 + w )+ o_âˆ‚(1)],

where the third equality in the display follows from the definition of Î² inÂ ass:domain2.
ByÂ ass:vector2, the model parameter c_0 is positive. Thus for
z=(x,y)âˆˆâˆ‚ with x sufficiently large,
the sign of Î³âŸ¨âˆ‡ f_w,1(z),Ï•(z)âŸ©
equals that of Î³(s_0 Î²/c_0 - 1 + w ) as claimed in the lemma. 



By definition we have f_w,Î³(z) = f_w,1(z)^Î³. Hence, for any z âˆˆ, the Hessian takes the form

    H(f_w,Î³)(z)=Î³(Î³-1)f_w,1(z)^Î³-2âˆ‡ f_w,1(z)(âˆ‡ f_w,1(z))^ 
    +Î³ f_w,1(z)^Î³-1H(f_w,1)(z),

where (âˆ‡ f_w,1(z))^ denotes the (d+1)-dimensional row vector with coordinates given by the first partial derivatives of f_w,1(z).
Since Î”_Î£ f_w,Î³ = (Î£^1/2H(f_w,Î³)Î£^1/2)=(Î£ H(f_w,Î³)), for z = (x,y)âˆˆ we have

    Î”_Î£ f_w,Î³(z) =Î³(Î³-1)f_w,1(z)^Î³-2âŸ¨Î£(z)âˆ‡ f_w,1(z),âˆ‡ f_w,1(z)âŸ©
    +Î³ f_w,1(z)^Î³-1Î”_Î£ f_w,1(z).

ByÂ ass:covariance2 andÂ (<ref>), we have
âŸ¨Î£(z)âˆ‡ f_w,1(z),âˆ‡ f_w,1(z)âŸ©  =âŸ¨Î£(z)e_x,e_xâŸ© + o_(1) = Ïƒ_1^2 (1+ o_(1)). 

Note that âˆ‚_x h(z) = -w(1-w)y_d^2(x+k_w)^-3
and
âˆ‚_y_i h(z) = w(1-w)y_i (x+k_w)^-2
for any z=(x,y)âˆˆ (y_i is the i-th coordinate of yâˆˆ^d).
An elementary (but tedious) calculation, based on the representation f_w,1(z)=(x+k_w)h(z)^1/w, yields

    âˆ‚_y_i^2f_w,1(z)    =(1-w)(x+k_w)^-1h(z)^1/w-1 +o_((x+k_w)^-1)
       =(1-w)(x+k_w)^-1(1+o_(1))    as xâ†’âˆ

for every iâˆˆ{1,â€¦,d}
(recall that h(z)^1/w-1=1+o_(1)).
Moreover, all other elements of the Hessian 
H(f_w,1)(z) are of order o_((x+k_w)^-1)
as xâ†’âˆ.
Thus, by definition
Î”_Î£ f_w,1(z)=(Î£(z)H(f_w,1)(z)) and the fact that Î£ is bounded byÂ ass:covariance1 (contained inÂ ass:covariance2)
we get

    Î”_Î£ f_w,1(z)=((Î£(z))-âŸ¨Î£(z)e_x,e_xâŸ©)(1-w)(x+k_w)^-1(1+o_(1))  as xâ†’âˆ.

By AssumptionÂ ass:covariance2,
it thus follows that 
Î”_Î£ f_w,1(z)=Ïƒ_2^2(1-w)(x+k_w)^-1(1+o_(1)) as xâ†’âˆ.
The expression inÂ (<ref>) is now a direct consequence ofÂ (<ref>).


    âˆ‚_x h(z)    = -w(1-w)y_d^2 (x+k_w)^-3
    âˆ‚_x f_w,1(z)    = h(z)^1/w-(1-w)y_d^2(x+k_w)^-2h(z)^1/w-1
    âˆ‚_x^2 f_w,1(z)    =(1-w)v(z)_d^2(x+k_w)^-1h(z)^1/w-1[1+(1-w)^2v(z)_d^2h(z)^-1]
       = (1-w)v(z)_d^2(x+k_w)^-1(1+ o_(1))  as xâ†’âˆ
    âˆ‚_y_iâˆ‚_x f_w,1(z)    = -(1-w)y_i(x+k_w)^-2h(z)^1/w-1[1+(1-w)v(z)_d^2h(z)^-1]



    âˆ‚_y_i h(z)    = w(1-w)y_i (x+k_w)^-2
    âˆ‚_y_i f_w,1(z)    =(1-w)(x+k_w)^-1y_ih(z)^1/w-1



    âˆ‚_xâˆ‚_x f_w,1(z)    = -(1-w)v(z)_d^2(x+k_w)^-1h(z)^1/w, 
    âˆ‚_xâˆ‚_y_i f_w,1(z)    = (1-w)y_i(x+k_w)^-2h(z)^1/w-1, 
    âˆ‚_y_iâˆ‚_y_jf_w,1(z)    =1{i=j}(1-w)(x+k_w)^-1h(z)^1/w-1 + (1-w)^3 y_iy_j(x+k_w)^-3h(z)^1/w-2,

we have 

    Î”_Î£f_w,1(z)    = ((Î£(z))-âŸ¨Î£(z)e_x,e_xâŸ©)(1-w)(x+k_w)^-1h(z)^1/w-1 + o_((x+k_w)^-1)    
       =Ïƒ_2^2(1-w)(x+k_w)^-1(1+o_(1)),

where the second equality follows from the assumptionÂ ass:covariance2.
ByÂ (<ref>) can estimate the Î”_Î£ f_w,Î³(z) for z = (x,y) âˆˆ,

    Î”_Î£ f_w,Î³(z)    = Î³(Î³-1)f_w,1(z)^Î³-2(Ïƒ_1^2 + o_(1)) 
        Â Â + Î³ f_w,1(z)^Î³-1(x+k_w)^-1(Ïƒ_2^2(1-w) + o_(1)) 
       = Î³ f_w,1(z)^Î³-2(Ïƒ_1^2(Î³-1)+Ïƒ_2^2(1-w)  +o_(1)).





By LemmaÂ <ref>, the function f_w,Î³ 
controls the sign of the inner product
âŸ¨âˆ‡ f_w,Î³(z),Ï•(z)âŸ©
for z=(x,y)âˆˆâˆ‚
with sufficiently large xâˆˆ.
Controlling the sign of
âŸ¨âˆ‡ f_w,Î³(z),Ï•(z)âŸ©
for all z=(x,y)âˆˆâˆ‚
is crucial for analysing the moments of Z_t at a fixed time t (see the proof of TheoremÂ <ref>) as well as establishing drift conditions in the case of positive recurrence (see LemmaÂ <ref> in SectionÂ <ref> below). This requires a slight modification of the function f_w,Î³, which we now describe.

Fix arbitrary x_0,x_1âˆˆ(0,âˆ), satisfying x_0<x_1, and define
the function m:Ã—^dâ†’[0,1] as follows: for  z=(x,y)âˆˆÃ—^d let 

    m(z)    := exp((x_1-x_0)^-2-((x_1-x_0)^2-(x_1-x)^2)^-1)1{x_0<x<x_1}+1{x_1â‰¤ x}.

The function m is smooth, âˆ‚_x m(z)â‰¥ 0 for all zâˆˆÃ—^d, 
and the following holds: for any 
 z_i=(x_i,y)âˆˆÃ—^d, iâˆˆ{0,1}, we have
m(z_0) = âˆ‚_x m(z_0) = âˆ‚_x^2 m(z_0)  = 0 and m(z_1) = 1, âˆ‚_x m(z_1) = âˆ‚_x^2 m(z_1) = 0.
For any constant  kâˆˆ(0,âˆ), define

    F_w,Î³(z) := f_w,Î³(z)m(z)+k(1-m(z)),   zâˆˆ.

The function F_w,Î³ 
is clearly a C^2-function on the open domain âˆ–âˆ‚ and its gradient âˆ‡ F_w,Î³ has a continuous extension to the closed domain 
(for all  parameters Î³âˆˆ and wâˆˆâˆ–{0}). 



Let AssumptionsÂ ass:vector2, ass:domain2 and ass:covariance2 hold and fix 
Î³âˆˆ and wâˆˆâˆ–{0}. Then, if Î³(Î² s_0/c_0 -1 + w) < 0, there exist kâˆˆ(0,âˆ)  and 0<x_0<x_1 such that 

    âŸ¨âˆ‡ F_w,Î³(z),Ï•(z)âŸ©â‰¤ 0    for all  zâˆˆâˆ‚.




Note that for any constants 0<k<âˆ and 0<x_0<x_1, for all zâˆˆ
we have

    âŸ¨âˆ‡ F_w,Î³(z),Ï•(z) âŸ©
           = (f_w,Î³(z)-k)âˆ‚_x m(z)âŸ¨ e_x,Ï•(z)âŸ© + m(z)âŸ¨âˆ‡ f_w,Î³(z),Ï•(z)âŸ©.

Since Î³(Î² s_0/c_0 -1 + w) < 0, by LemmaÂ <ref>, there exists x_0'>0 such that âŸ¨âˆ‡ f_w,Î³(z),Ï•(z)âŸ© < 0  for all zâˆˆâˆ‚âˆ© [x_0',âˆ)Ã—^d.
By AssumptionÂ ass:vector2, 
âŸ¨Ï•(z), e_xâŸ© = s_0 b'(x)(1+f(z)) for all zâˆˆâˆ‚,
where f:âˆ‚â†’ satisfies sup_y:(x,y)âˆˆâˆ‚ |f(x,y)|â†’0 as xâ†’âˆ.
Pick x_0â€âˆˆ such that sup_y:(x,y)âˆˆâˆ‚ |f(x,y)|<1/2 for all xâˆˆ[x_0â€,âˆ).


There are two possibilities. 



(I) There exists x_0âˆˆ[max{x_0',x_0â€},âˆ) such that  |b'(x_0)|>0.
If 
b'(x_0)>0 (resp. b'(x_0)<0), by the continuity of b', there exists x_1âˆˆ(x_0,âˆ), such that b'(x)>0 (resp. b'(x)<0) for all xâˆˆ[x_0,x_1].
Since s_0>0 by AssumptionÂ ass:vector2, for any z=(x,y)âˆˆâˆ‚ with xâˆˆ[x_0,x_1], we have 
âŸ¨Ï•(z), e_xâŸ© = s_0 b'(x)(1+f(z))>s_0b'(x)/2>0
(resp. âŸ¨Ï•(z), e_xâŸ© = s_0 b'(x)(1+f(z))<s_0b'(x)/2<0).
ByÂ (<ref>),  f_w,Î³ is a positive bounded
function on the set âˆ©[x_0,x_1]Ã—^d.
Thus we may pick k in the interval (sup_(x,y)âˆˆâˆ‚:x_0â‰¤ xâ‰¤ x_1 f_w,Î³(x,y),âˆ) (resp. (0,inf_(x,y)âˆˆâˆ‚:x_0â‰¤ xâ‰¤ x_1 f_w,Î³(x,y))).
Since the function m, defined above, satisfies min{âˆ‚_x m(z),m(z)}â‰¥0  for all zâˆˆ, âˆ‚_x m(z)=0 for all z=(x,y) with xâˆˆ[x_1,âˆ)
and âˆ‚_x m(z)=m(z)=0 for all z=(x,y) with xâˆˆ[0,x_0],
byÂ (<ref>) it follows âŸ¨âˆ‡ F_w,Î³(z),Ï•(z) âŸ©â‰¤ 0 for all zâˆˆâˆ‚.
















(II) |b'(x)|=0 for all xâˆˆ[max{x_0',x_0â€},âˆ).

Thus, for any x_0, x_1âˆˆ[max{x_0',x_0â€},âˆ) with x_0<x_1, 
we have âˆ‚_x m(z)âŸ¨ e_x,Ï•(z)âŸ©= âˆ‚_x m(z)s_0 b'(x)(1+f(z))=0 for all zâˆˆ.
Hence, for any kâˆˆ(0,âˆ), byÂ (<ref>)  we have  âŸ¨âˆ‡ F_w,Î³(z),Ï•(z)âŸ© = m(z)âŸ¨âˆ‡ f_w,Î³(z),Ï•(z)âŸ©â‰¤ 0 for all zâˆˆâˆ‚.


The function  f_w,Î³ suffices  to establish TheoremÂ <ref>(a)â€“(b) when the asymptotic exponent Î² is away from the critical value Î²_c defined inÂ (<ref>). In the critical case Î²=Î²_c,
logarithmic (rather than polynomial) growth 
of the Lyapunov function is required. 


The function we now define for this purpose is inspired by the analysis of the reflecting Brownian motion and random walk in a wedge inÂ <cit.>.
Pick an arbitrary constant Î´âˆˆ(0,âˆ) and
let g_Î´:â†’ (1,âˆ) be a continuous function, twice differentiable in the interior of , satisfying

    g_Î´(z) = log (x) -x^-Î´ + Ïƒ_1^2/Ïƒ_2^2y_d^2/2x^2 (1+Î´ x^-Î´)+1  for z = (x,y) âˆˆ with x âˆˆ (,âˆ),

with Ïƒ_1^2 and Ïƒ_2^2 given inÂ ass:covariance2plus.
Since for any (x,y)âˆˆ we have y_dâ‰¤ b(x) and b is sublinear byÂ ass:domain2plus (cf. RemarkÂ <ref>), there exists a positive constant C_Î´âˆˆ (0,âˆ) such that
    log x â‰¤ g_Î´(z) â‰¤ C_Î´ + log x,    for z=(x,y)âˆˆ with x > .

The relevant asymptotic properties of the derivatives of g_Î´ are in the next lemma. 



Assume 
Î² = Î²_c,
where Î² (resp. Î²_c) is defined inÂ (<ref>) (resp.Â (<ref>)).
Let AssumptionsÂ ass:vector2plus, ass:domain2plus and ass:covariance2plus hold and choose Î´âˆˆ(0, min{Ïµ, 1 - Î²}), where Ïµ > 0 is the rate of decay in AssumptionÂ ass:covariance2plus.
Then there exists an x_0 > 0 such that 

    Î”_Î£ g_Î´ < 0 on âˆ©[x_0,âˆ)Ã—^d  and  âŸ¨âˆ‡ g_Î´,Ï•âŸ© 
        < 0 on âˆ‚âˆ©[x_0,âˆ)Ã—^d.










Recall that Î²=Î²_c=c_0Ïƒ_1^2/(s _0Ïƒ_2^2). ByÂ (<ref>), for z = (x,y)âˆˆ with x>, we have

    âˆ‡ g_Î´(z)      =  e_x(x^-1(1+Î´ x^-Î´) -Ïƒ_1^2/Ïƒ_2^2y_d^2/x^3(1-Î´ x^-Î´(1+Î´/2)) ) 
        + e_Å·(Ïƒ_1^2/Ïƒ_2^2y_d/x^2(1+Î´ x^-Î´ ));

see the first paragraph of SectionÂ <ref>
for the definition of Å·, e_x and e_Å·. 



ByÂ ass:vector2plus we have
âŸ¨ e_x,Ï•(z)âŸ©=s_0b'(x)(1+o_âˆ‚(b(x)^2x^-2))

=s_0Î² b(x)x^-1(1+o_âˆ‚(b(x)^2x^-2)) as xâ†’âˆ,
where the second equality follows fromÂ ass:domain2plus,
and 
âŸ¨ e_Å·,Ï•(z)âŸ©=-c_0(1+o_âˆ‚(b(x)^2x^-2)) 

as xâ†’âˆ. 
Since z = (x,y)âˆˆâˆ‚ satisfies y_d =b(x) as xâ†’âˆ, byÂ (<ref>) we obtain

    âŸ¨âˆ‡ g_Î´(z),Ï•(z)âŸ©   =s_0Î² b(x)x^-2 (1+Î´ x^-Î´)o_âˆ‚(b(x)^2x^-2)
        -s_0^2Î²^2c_0^-1 b(x)^3x^-4(1+o_âˆ‚(b(x)^2x^-2)) 
       = -s_0^2c_0^-1Î²^2 b(x)^3x^-4+ o_âˆ‚(b(x)^3x^-4)  as xâ†’âˆ.

Thus there exists x_0>0, such that âŸ¨âˆ‡ g_Î´(z),Ï•(z)âŸ©<0 for all z=(x,y)âˆˆâˆ‚âˆ© [x_0,âˆ)Ã—^d.

By RemarkÂ <ref> above, for any Î²'âˆˆ(Î²,1) it holds 
b(x)=o(x^Î²') as xâ†’âˆ, implying 
y_d/x=o_(1) as xâ†’âˆ. 
By assumption Î´âˆˆ(0,1-Î²). Thus b(x)=o(x^Î²+Î´), implying  b(x)^2x^-4 = o(x^-2-Î´) and b(x)x^-3 = o(x^-2-Î´) as xâ†’âˆ. 
Recall fromÂ (<ref>) that,
for any i âˆˆ{1,â€¦,d}, 
the i-th partial derivative âˆ‚_y_i g_Î´ along the coordinate y_i of y equals 
âˆ‚_y_i g_Î´(z)=Î² s_0c_0^-1y_i x^-2(1+Î´ x^-Î´) for x>,
implying 
âˆ‚^2_y_i g_Î´(z)=Î² s_0c_0^-1x^-2(1+Î´ x^-Î´).
By the representation of the gradientÂ (<ref>) and the fact y_dâ‰¤ b(x) for every z=(x,y)âˆˆ, we have âˆ‚_x^2 g_Î´(z) = -x^-2(1+Î´(1+Î´)x^-Î´)+o_(x^-2-Î´), while 
all mixed derivatives in the Hessian H(g_Î´)(z) are of order b(x)x^-3 = o_(x^-2-Î´) as x â†’âˆ.
Thus, by the definition
Î”_Î£ g_Î´(z)=(Î£(z)H(g_Î´)(z)) and the fact that
âˆ‚^2_y_i g_Î´
does not depend on the index i âˆˆ{1,â€¦,d} and is bounded for x>,
we get



    Î”_Î£ g_Î´(z) =   âŸ¨Î£(z)e_x,e_xâŸ©âˆ‚_x^2 g_Î´(z)  +((Î£(z))-âŸ¨Î£(z)e_x,e_xâŸ©) âˆ‚^2_y_1 g_Î´(z) 
    
    +o_(x^-2-Î´) 
    
    =    -x^-2 (1+Î´(1+Î´)x^-Î´) (Ïƒ_1^2 + o_(x^-))
    + (Ïƒ_2^2+o_(x^-))Î² s_0c_0^-1 x^-2(1+Î´ x^-Î´)
        + o_(x^-2-Î´) 
    =  -Ïƒ_1^2Î´^2x^-2-Î´  +o_(x^-2-Î´)  as xâ†’âˆ,

where the last equality follows form the identity  s_0Î²Ïƒ_2^2/c_0=Ïƒ_1^2 and 
the fact Î´<Ïµ. Hence, the sign of Î”_Î£ g_Î´(z) is negative for zâˆˆ(x,y)âˆˆ with x sufficiently large as claimed in lemma.




Â§ NON-EXPLOSION, RECURRENCE/TRANSIENCE CRITERIA, AND RETURN TIMES OF CONTINUOUS SEMIMARTINGALES



This section develops certain semimartingale tools for classifying asymptotic behaviour via Fosterâ€“Lyapunov criteria.
The general theory developed in this section is expected to have broad applicability. In the present paper, it will be applied to study the reflected process Z, given by SDEÂ (<ref>), via the Lyapunov functions constructed and analysed in SectionÂ <ref> above.

Fix a probability space (Î©,,) and a filtration (_t)_t âˆˆ satisfying the usual conditions. Consider an (_t)-adapted  continuous process Îº = (Îº_t)_t âˆˆ, taking values in [0,âˆ].

Let  denote the set of all [0,âˆ]-valued stopping times with respect to (_t)_tâˆˆ.
For any â„“,r âˆˆ and stopping time T âˆˆ, define the first entry times (after T) by

    Î»_â„“,T :=  T + inf{s âˆˆ: T < âˆ,Â Îº_T+sâ‰¤â„“}, 
    Ï_r,T :=  T + inf{s âˆˆ: T < âˆ, Â Îº_T+sâ‰¥ r},

where we adopt the convention infâˆ… := +âˆ. If T = 0, we write Î»_â„“ := Î»_â„“,0 and Ï_r := Ï_r,0. Almost sure limits Ï_âˆ := lim_r â†’âˆÏ_r and Ï_âˆ,T = lim_r â†’âˆÏ_r,T exist by monotonicity. 
Explosion of the process Îº occurs
if the event {Ï_âˆ < âˆ} has positive  probability. 
Since Ï_r,T = Ï_r on the event {T < Ï_r }, we have Ï_âˆ = Ï_âˆ,T on the event { T < Ï_âˆ}.  
For r_0â‰¤ r,
we define the first exit time from the interval [r_0,r] after some stopping time T âˆˆ by 

    S_r,T := Î»_r_0,Tâˆ§Ï_r,T.

Here and throughout we denote xâˆ§ y:=min{x,y} and 
xâˆ¨ y:=max{x,y}
for any x,yâˆˆ[0,âˆ].




 Â§.Â§ Non-explosion

We first establish criteria for Îº not to explode.


The main application of this result in the present paper is to prove that the reflected process with asymptotically normal reflection cannot explode. 

This should be contrasted with the case of the asymptotically oblique reflection, where explosion may occur, see the characterisation inÂ <cit.>.
The non-explosion criteria inÂ <cit.> are more delicate than the ones in LemmaÂ <ref>, but require transience of the underlying semimartingale, making them inapplicable to the entire class of processes considered here. The following result is more robust (i.e.Â with simpler assumptions), has an elementary proof and covers all the models analysed in this paper. 



Let Îº  = (Îº_t)_t âˆˆ be an [0,âˆ]-valued (_t)-adapted continuous process 

and V: â†’ (0,âˆ) a continuous function with lim_x â†’âˆ V(x) = âˆ. Suppose there exist r_0,Î·âˆˆ, such that for all r âˆˆ (r_0,âˆ) and any  T âˆˆ, such that [V(Îº_T)1{T<Ï_âˆ}]<âˆ, the process Î¶^T,r = (Î¶^T,r_t)_t âˆˆ,
defined by

    Î¶^T,r_t := (V(Îº_(t+T)âˆ§ S_r,T)-Î·(t âˆ§ (S_r,T-T)))1{T < Ï_âˆ},

is an (_t+T)-supermartingale, i.e., for 0 â‰¤ s â‰¤ t < âˆ, 

    [Î¶^T,r_t|_s + T] â‰¤Î¶^T,r_s ,

Then (Ï_âˆ = âˆ) = 1.

Furthermore, if for the (possibly random) starting value Îº_0, we assume [V(Îº_0)]<âˆ then [V(Îº_t)] < âˆ for all tâˆˆ.




Choose r_1âˆˆ(r_0,âˆ) 
and define recursively the upcrossing and downcrossing times of the process Îº over the interval [r_0,r_1] as follows: Î¸_1 := 0, and if Î¸_k has been defined for some kâˆˆ, then 
Î¸_k := Î»_r_0,Î¸_k and  Î¸_k+1 := Ï_r_1,Î¸_k. Thus we have 0=Î¸_1â‰¤Î¸_1â‰¤â‹¯â‰¤Î¸_k â‰¤Î¸_k â‰¤Î¸_k+1â‰¤â‹¯.
Moreover, for any t âˆˆ, we denote 
    D(t,r_0,r_1) :=sup{ k âˆˆ;Â Î¸_k â‰¤ t},
 
the number of downcrossings of the interval [r_0,r_1] up to time t for the process Îº. Since any continuous function on the compact interval [0,t] 
crosses an interval of positive length at most finitely many times, we have D(t,r_0,r_1) < âˆ a.s.

Assume  now (Ï_âˆ < âˆ) > 0. Then there exists t_0 âˆˆ such that (Ï_âˆ < t_0) > 0.  We will prove by induction that {Î¸_k<Ï_âˆ}âˆ©{Ï_âˆ < t_0}={Ï_âˆ < t_0} a.s.Â holds for all k âˆˆ.
The induction hypothesis holds for k=1 since
Î¸_1=0 < Ï_âˆ a.s.
Assume the almost-sure equality of events holds for some kâˆˆ.

Set T := Î¸_k and note 
V(Îº_T)1{T<Ï_âˆ}= V(r_1)1{T<Ï_âˆ}, since the paths of Îº are continuous and, on the event {T<Ï_âˆ}, we have T<âˆ. In particular, V(Îº_T)1{T<Ï_âˆ} is bounded and hence integrable.





Pick any r âˆˆ (r_1,âˆ) and consider 
 the supermartingale Î¶^T,r defined inÂ (<ref>).
 Note that (Tâˆ¨ t_0)-T is a bounded (_T+t)-stopping time since,
 for any sâˆˆ, we have {T âˆ¨ t_0 -T â‰¤ s} = {t_0 âˆ¨ Tâ‰¤  T+s }âˆˆ_T+s as both t_0âˆ¨ T and s+T are (_t)-stopping times.
 Applying the optional sampling theorem to Î¶^T,r
 at (Tâˆ¨ t_0)-T yields:

    (Ï_r,T<Î»_r_0,Tâˆ§ (Tâˆ¨ t_0), T<Ï_âˆ|_T) V(r)- Î· t_0    â‰¤[Î¶_(Tâˆ¨ t_0)-T^T,r|_T] 
       â‰¤Î¶^T,r_0 = V(r_1)1{T<Ï_âˆ}.

Taking expectations on both sides, we obtain the following inequality for every râˆˆ(r_1,âˆ):

    (Ï_r,T<Î»_r_0,Tâˆ§ (Tâˆ¨ t_0), T<Ï_âˆ)â‰¤  (V(r_1)+ Î· t_0)/V(r).

Thus, by the monotone convergence theorem, we obtain

    0â‰¤(Ï_âˆâ‰¤Î»_r_0,Tâˆ§ (Tâˆ¨ t_0),T<Ï_âˆ )     =
    lim_râ†’âˆ(Ï_r,T<Î»_r_0,Tâˆ§ (Tâˆ¨ t_0),T<Ï_âˆ ) 
       â‰¤lim sup_râ†’âˆ(V(r_1)+t_0Î·)/V(r)=0,

implying
{T<Ï_âˆ}=
{Ï_âˆ>Î»_r_0,Tâˆ§ (Tâˆ¨ t_0)}âˆ©{T<Ï_âˆ}
a.s.
We hence 
obtain 

    {Ï_âˆ < t_0}    ={T<Ï_âˆ}âˆ©{Ï_âˆ<t_0}
    =
    {Ï_âˆ>Î»_r_0,Tâˆ§ (Tâˆ¨ t_0)}âˆ©{T<Ï_âˆ}âˆ©{Ï_âˆ<t_0}
        =
    {Î»_r_0,T<Ï_âˆ}âˆ©{Ï_âˆ<t_0} a.s.

The first equality in this display holds by the induction hypothesis, the second holds byÂ (<ref>),  and the third equality follows from the fact that Tâ‰¤Î»_r_0,T by definitionÂ (<ref>).





Since the 

equality 
{Î¸_k = Î»_r_0,T < Ï_âˆ}={Ï_r_1,Î¸_k =Î¸_k+1 < Ï_âˆ} holds almost surely,

we proved that {Î¸_k+1<Ï_âˆ}âˆ©{Ï_âˆ < t_0}={Ï_âˆ < t_0} almost surely,
thus verifying the induction step.

We conclude that 

    {Î¸_1<â€¦<Î¸_k<Ï_âˆ<t_0}= â‹‚_i=1^k{Î¸_i < Ï_âˆ < t_0} = {Ï_âˆ < t_0}  a.s.Â for all kâˆˆ.
  
Since {Î¸_i<Î¸_i+1}={Î¸_i<Î¸_i<Î¸_i+1} for every iâˆˆ and
D(t_0,r_0,r_1) < âˆ a.s., it follows that (Ï_âˆ < t_0) = 0, contradicting our assumption (Ï_âˆ<âˆ)>0.



For any tâˆˆ, by the assumptions in the lemma, for any r âˆˆ (r_0,âˆ) and any stopping time Tâˆˆ, satisfying [V(Îº_T)1{T<âˆ}] < âˆ, it holds that

    [V(Îº_(t+T) âˆ§Î»_r_0,Tâˆ§Ï_r,T)1{T<âˆ}|_T] â‰¤Î· t + V(Îº_T)1{T < âˆ}    a.s.

Moreover, since the process Îº does not explode we have  lim_râ†’âˆÏ_r,T = âˆ a.s. 
Thus,
by Fatou's lemma for conditional expectations, which applies since the function  V is positive, and the inequality inÂ (<ref>), we get

    [V(Îº_(t+T)âˆ§Î»_r_0,T)1{T<âˆ}|_T]   =
    [lim inf_râ†’âˆV(Îº_(t+T) âˆ§Î»_r_0,Tâˆ§Ï_r,T)1{T<âˆ}|_T]
       â‰¤lim inf_râ†’âˆ[V(Îº_(t+T) âˆ§Î»_r_0,Tâˆ§Ï_r,T)1{T<âˆ}|_T] 
       â‰¤Î· t + V(Îº_T)1{T < âˆ}    a.s.


To prove that V(Îº) is an integrable process, we will again make use of the crossing times over the interval [r_0,r_1], denoted by Î¸_k,Î¸_k, for k-th downcrossing and upcrossing times respectively. We pick tâˆˆ and estimate,

    [V(Îº_t)]    = [V(Îº_t) âˆ‘_k=1^âˆ( 1{Î¸_kâ‰¤ t â‰¤Î¸_k} + 1{Î¸_k < t <Î¸_k+1})] 
       â‰¤sup{V(r):râˆˆ[0,r_1]} + âˆ‘_k=1^âˆ[V(Îº_t) 1{Î¸_k â‰¤ tâ‰¤Î¸_k }].


On the event {Î¸_k â‰¤ tâ‰¤Î¸_k }, we have V(Îº_t) = V(Îº_t âˆ§Î»_r_0,Î¸_k), since Î»_r_0,Î¸_k = Î¸_k a.s. Moreover, if k = 1, then V(Îº_Î¸_1) = V(Îº_0) and if kâ‰¥ 2, then V(Îº_Î¸_k) =  V(r_1) holds on the event  {Î¸_k â‰¤ tâ‰¤Î¸_k }âˆˆ_Î¸_k, implying

    [V(Îº_t)^1/21{Î¸_k â‰¤ tâ‰¤Î¸_k }]
       = [[ V(Îº_((t-Î¸_k)+Î¸_k) âˆ§Î»_r_0,Î¸_k)^1/21{Î¸_k â‰¤ tâ‰¤Î¸_k }|_Î¸_k]] 
       â‰¤[[ V(Îº_((t-Î¸_k)+Î¸_k) âˆ§Î»_r_0,Î¸_k)|_Î¸_k] 1{Î¸_k â‰¤ tâ‰¤Î¸_k }|_Î¸_k] 
       â‰¤[Î· t1{Î¸_k < t <  Î¸_k} + V(Îº_Î¸_k)1{Î¸_k â‰¤ tâ‰¤Î¸_k }] 
       â‰¤Î· t(Î¸_k â‰¤ tâ‰¤Î¸_k ) + (V(r_1)  + [V(Îº_0)] )(Î¸_k â‰¤ t â‰¤Î¸_k).

This inequality, which holds for every kâˆˆ, andÂ (<ref>) implies

    [V(Îº_t)] â‰¤ 2V(r_1) + [V(Îº_0)] + Î· t < âˆ    for every tâˆˆ(0,âˆ).







 Â§.Â§ Transience and recurrence criteria for continuous semimartingales


LemmasÂ <ref> andÂ <ref> of the present subsection  provide sufficient conditions for recurrence and transience, respectively, for a continuous semimartingale  Îº. They are continuous-time analogues to the Foster-Lyapunov criteria for discrete-time processes discussed in  e.g.Â <cit.>.



Let
V: â†’ (0,âˆ) be a continuous function with lim_x â†’âˆ V(x) = âˆ and
 Îº  = (Îº_t)_t âˆˆ an -valued (_t)-adapted continuous process satisfying lim sup_t â†’âˆÎº_t  = âˆ a.s. If there exists such r_0 > 0, such that for all t_0 âˆˆ and r âˆˆ (r_0,âˆ), the process (V(Îº_(t+t_0)âˆ§ S_r,t_0))_t âˆˆ is an (_t+t_0)-supermartingale (recall that r_0 features in S_r,t_0=Î»_r_0,t_0âˆ§Ï_r,t_0 by definitionÂ (<ref>)), i.e., 
 [V(Îº_t_0)]<âˆ and
 for 0 â‰¤ s â‰¤ t < âˆ,

    [V(Îº_(t + t_0) âˆ§ S_r,t_0)|_s + t_0] â‰¤ V(Îº_(s + t_0) âˆ§ S_r,t_0),

then (lim inf_t â†’âˆÎº_t  â‰¤ r_0)  =  1.



Up to requiring verification over a smaller class of stopping times, the hypotheses of LemmaÂ <ref>
essentially imply those of LemmaÂ <ref> with Î·=0. Thus, a Lyapunov function that implies recurrence will also often yield non-explosion. In the case of a transient process, however, Î·>0 is typically needed for LemmaÂ <ref> to be applicable.





Pick t_0 âˆˆ, r âˆˆ (r_0,âˆ) and consider the (_t+t_0)-supermartingale (V(Îº_(t+t_0)âˆ§ S_r,t_0))_tâˆˆ.

Note that the assumption lim sup_t â†’âˆÎº_t = âˆ a.s. implies S_r,t_0 < âˆ a.s. and hence 

it holds that lim_t â†’âˆV(Îº_(t+t_0) âˆ§ S_r,t_0) = V(Îº_S_r,t_0) a.s. 

The supermartingale property, Fatou's lemma, definitionÂ (<ref>) and the continuity of Îº imply

    âˆ>[V(Îº_t_0)]     â‰¥   lim inf_t â†’âˆ[V(Îº_(t + t_0) âˆ§ S_r,t_0)] â‰¥[lim inf_t â†’âˆV(Îº_(t + t_0) âˆ§ S_r,t_0)] 
        =    [V(Îº_S_r,t_0)] â‰¥(Ï_r,t_0 < Î»_r_0,t_0) V(r).

Thus, for all râˆˆ(r_0,âˆ), we obtain

    (inf_t â‰¥ t_0Îº_t â‰¤ r_0) â‰¥(Î»_r_0,t_0 < âˆ) â‰¥(Î»_r_0,t_0 <Ï_r,t_0) â‰¥ 1 - [V(Îº_t_0)]/V(r).

Since  lim_r â†’âˆV(r) =âˆ by assumption, it follows that (inf_t â‰¥ t_0Îº_t â‰¤ r_0) = 1 for any fixed t_0 âˆˆ, implying (lim inf_t â†’âˆÎº_t  â‰¤ r_0)=(âˆ©_t_0âˆˆ{inf_t â‰¥ t_0Îº_t â‰¤ r_0})=1.







Let
V: â†’ (0,âˆ) be a continuous function with lim_x â†’âˆ V(x) = 0 and
 Îº  = (Îº_t)_t âˆˆ an -valued (_t)-adapted continuous process satisfying lim sup_t â†’âˆÎº_t  = âˆ a.s.
If there exists r_0 > 0, such that for all T âˆˆ, satisfying  T < âˆ a.s., and r âˆˆ (r_0,âˆ), the process (V(Îº_(t+T)âˆ§ S_r,T))_t âˆˆ, is an (_t+T)-supermartingale, i.e., for 0 â‰¤ s â‰¤ t < âˆ,

    [V(Îº_(t + T) âˆ§ S_r,T)|_s + T] â‰¤ V(Îº_(s + T) âˆ§ S_r,T),

then 

(lim_t â†’âˆÎº_t = âˆ) = 1.




Note that the function V in LemmaÂ <ref> is assumed to be continuous and have limit zero at infinity, making it bounded. Thus, for any T âˆˆ, satisfying  T < âˆ a.s., we have [V(Îº_T)]<âˆ. Once we have such a candidate function V, in order to apply LemmaÂ <ref>, we only need to check the (_t+T)-supermartingale property inÂ (<ref>).




Pick an arbitrary â„“âˆˆ(r_0,âˆ). For any
r, r_1âˆˆ, satisfying â„“<r_1<r,  define T := Ï_r_1. 
Since lim sup_t â†’âˆÎº_t = âˆ a.s., we have T = Ï_r_1<âˆ a.s. and Ï_r,T<âˆ a.s., implying further by definitionÂ (<ref>) that 
S_r,T=Î»_r_0,Tâˆ§Ï_r,Tâ‰¤Ï_r,T<âˆ a.s.

Define the process Î¾ = (Î¾_t)_t âˆˆ by 
Î¾_t:= V(Îº_(t + T)âˆ§Î»_â„“,Tâˆ§Ï_r,T),
t âˆˆ.

Since Î»_â„“,Tâˆ§Ï_r,Tâ‰¤ S_r,T a.s., 
the process Î¾ equals the (_t+T)-supermartingale 
(V(Îº_(t+T)âˆ§ S_r,T))_t âˆˆ stopped 
at the (_t+T)-stopping time 
Î»_â„“,Tâˆ§Ï_r,T-T.
Thus, by RemarkÂ <ref> andÂ <cit.>, the process Î¾ is a positive  (_t+T)-supermartingale. 

Hence, for all t âˆˆ, we have 

    V(Îº_T) = Î¾_0 â‰¥[Î¾_t |_T] â‰¥[Î¾_t 1{Î»_â„“,Tâ‰¤Ï_r,T}|_T].


Since Îº is continuous, 
it holds
lim_tâ†’âˆÎ¾_t 1{Î»_â„“,Tâ‰¤Ï_r,T}
=V(â„“)1{Î»_â„“,Tâ‰¤Ï_r,T}
and V(Îº_T)=V(r_1) a.s. 
The (conditional) Fatou's lemma yields

    (Î»_â„“,Tâ‰¤Ï_r,T|_T)
    V(â„“)    = [lim inf_t â†’âˆÎ¾_t1{Î»_â„“,Tâ‰¤Ï_r,T}|_T] 
       â‰¤lim inf_t â†’âˆ[Î¾_t1{Î»_â„“,Tâ‰¤Ï_r,T}|_T]â‰¤Î¾_0 = V(Îº_T)= V(r_1).

Since, by assumption,
Îº_tâˆˆ a.s. for all tâˆˆ, Îº does not explode. Thus 
lim_r â†’âˆÏ_r,T = âˆ a.s. and, since
Ï_r,T<âˆ a.s. for all râˆˆ(r_1,âˆ),
we get (recall V(â„“)>0)

    (Î»_â„“,T < âˆ)=(âˆª_râˆˆâˆ©(r_1,âˆ){Î»_â„“,Tâ‰¤Ï_r,T}) =lim_râ†’âˆ(Î»_â„“,Tâ‰¤Ï_r,T) â‰¤ V(r_1)/V(â„“).


Recall T=Ï_r_1<âˆ a.s. and 
note {lim inf_t â†’âˆÎº_tâ‰¤â„“}âŠ‚{Î»_â„“,Ï_r_1 < âˆ} for all r_1âˆˆ(â„“,âˆ).
The inequality
(lim inf_t â†’âˆÎº_tâ‰¤â„“) â‰¤(Î»_â„“,Ï_r_1 < âˆ)
for all r_1âˆˆ(â„“,âˆ),
the upper bound inÂ (<ref>) and the hypotheses V(r_1)â†’0 as r_1â†’âˆ imply

    (lim inf_t â†’âˆÎº_tâ‰¤â„“) â‰¤lim sup_r_1 â†’âˆ(Î»_â„“,Ï_r_1 < âˆ) = 0.

Thus lim inf_t â†’âˆÎº_t>â„“ a.s.
Since â„“âˆˆ(r_0,âˆ) was arbitrary, transience follows.




 Â§.Â§ Lower bounds on the tails of return times and associated additive functionals



In this subsection we establish lower bounds for the tails of the return times of continuous semimartingales and associated additive functionals. In the Markovian setting, there exists a rich theory providing upper bounds for additive functionals considered here, in the context of establishing related upper bounds on the tails of the invariant distribution (seeÂ <cit.> and the references therein). Moreover, in the continuous semimartingale setting,Â <cit.> establishes upper bounds on the return-time moments. Comparatively, the literature dedicated to lower bounds on the tails of the return times is scarce. Some results in this direction can be found inÂ <cit.>, however the assumptions are too restrictive to be used in our model. 
Our approach, based on the maximal inequality in PropositionÂ <ref> below, is inspired by the discrete-time results inÂ <cit.>.



The link between between additive functionals studied in the present subsection and the invariant distributions in the Markovian setting, described inÂ <cit.>,
enables the application of LemmaÂ <ref> below
in the proofs of lower bounds on the tails of the invariant distribution and the sub-exponential convergence rate
in total variation (stated in  TheoremÂ <ref>).
LemmaÂ <ref> is also crucial for 
establishing the lower bounds on the tails of return times in TheoremÂ <ref>.



Let Î¾ = (Î¾_t)_tâˆˆ be an -valued (_t)-adapted continuous process and f:^2 â†’ a measurable function. For some r > 0, let Ï„_r:=inf{tâˆˆ:Î¾_tâ‰¥ r}
(with infâˆ… =âˆ) and assume
 
(Î¾_tâˆ§Ï„_r- âˆ«_0^tâˆ§Ï„_r f(u,Î¾_u) u)_tâˆˆ
is an (_t)-supermartingale. 
Then, for any sâˆˆ(0,âˆ), we have (sup_0â‰¤ t â‰¤ sÎ¾_tâ‰¥ r|_0)â‰¤ r^-1(Î¾_0 + [âˆ«_0^sâˆ§Ï„_r f(u,Î¾_u) u|_0]).



Pick sâˆˆ(0,âˆ) and consider the  stopping time Ï„_r âˆ§ s, bounded above by s. By assumption we have [Î¾_Ï„_r âˆ§ s - âˆ«_0^Ï„_r âˆ§ s f(u,Î¾_u) u|_0] â‰¤Î¾_0, which implies that

    [Î¾_Ï„_r âˆ§ s|_0] â‰¤Î¾_0 + [âˆ«_0^Ï„_r âˆ§ s f(u,Î¾_u) u |_0].

Moreover, by the definition of Ï„_r in the proposition we have {Ï„_r â‰¤ s}={sup_uâˆˆ[0,s]Î¾_uâ‰¥ r}
a.s. Since the equality Î¾_Ï„_r âˆ§ s = r holds on this event, byÂ (<ref>)
we have

    (sup_0â‰¤ t â‰¤ sÎ¾_t â‰¥ r|_0) = r^-1[Î¾_Ï„_r âˆ§ s1{Ï„_r â‰¤ s}|_0] â‰¤ r^-1(Î¾_0 + [âˆ«_0^Ï„_r âˆ§ s f(u,Î¾_u) u|_0]),

implying the proposition.


Note that, in the case 
[âˆ«_0^sâˆ§Ï„_r f(u,Î¾_u) u]=âˆ, both the statement and the proof of PropositionÂ <ref>
are formally correct, but not informative. In particular, 
when applying PropositionÂ <ref> we need 
[âˆ«_0^sâˆ§Ï„_r f(u,Î¾_u) u]<âˆ, which follows easily 
if, for example, the function f is continuous (and hence bounded on [0,s]Ã—[0,r]).



Let Îº = (Îº_t)_tâˆˆ be an -valued (_t)-adapted continuous process satisfying lim sup_tâ†’âˆÎº_t =âˆ a.s. Suppose that there exist  pâˆˆ(0,âˆ), â„“âˆˆ(0,âˆ), and C âˆˆ (0,âˆ), such that the following hold for all râˆˆ(â„“,âˆ):


  *  the process (Îº_tâˆ§Î»_â„“âˆ§Ï_r^p)_tâˆˆ is an (_t)-submartingale;


  *  for any  qâˆˆ(0,1) and r_q := (1-q)^-1r, the process 

    (Îº_(Ï_r_q+t)âˆ§Î»_r,Ï_r_q^-2 - Câˆ«_Ï_r_q^(Ï_r_q + t) âˆ§Î»_r,Ï_r_qÎº_u^-4 u)_tâˆˆ,

is an (_Ï_r_q+t)-supermartingale.

Let h:â†’ be a non-decreasing measurable function. Then 
for all râˆˆ(â„“,âˆ),  qâˆˆ(0,1)
and âˆˆ(0,C^-1q(1-q)],
we have 

    (âˆ«_0^Î»_â„“ h(Îº_s) s â‰¥ h(r)r^2|_0)â‰¥ qmin{(Îº_0^p-â„“^p) (1-q)^pr^-p, 1},   on the event {Îº_0 > â„“}.

In particular, for all tâˆˆ(â„“,âˆ) (with hâ‰¡1  and =C^-1q(1-q)), we have

    (Î»_â„“â‰¥ t|_0) â‰¥ qmin{(Îº_0^p-â„“^p)((1-q)^3q/C)^p/2t^-p/2, 1},  on the event {Îº_0 > â„“}.




Pick qâˆˆ (0,1), r âˆˆ(â„“,âˆ) and note that it suffices to prove the lemma for =C^-1q(1-q). We start by establishing the following inequality: 

    (Î»_r,Ï_r_q > Ï_r_q  +  r^2|_Ï_r_q) â‰¥ q  a.s.





Define (Î¾_t)_tâˆˆ by Î¾_t := Îº_Ï_r_q + t^-2 and note thatÂ (<ref>) yields
Ï„_r^-2:=inf{t>0:Î¾_t â‰¥ r^-2}=Î»_r,Ï_r_q-Ï_r_q.

By AssumptionÂ <ref>, the process (Î¾_tâˆ§Ï„_r^-2 - âˆ«_0^tâˆ§Ï„_r^-2 CÎ¾_u^2 u)_tâˆˆ is an (_Ï_r_q+t)-supermartingale.  By PropositionÂ <ref> applied to Î¾ and the stopping time Ï„_r^-2,  we obtain

    (Î»_r,Ï_r_q â‰¤Ï_r_q +t|_Ï_r_q )    = (Ï„_r^-2â‰¤ t|_Ï_r_q )=(sup_0â‰¤ u â‰¤ tÎ¾_u â‰¥ r^-2|_Ï_r_q) 
       â‰¤ r^2( Î¾_0 + [âˆ«_0^tâˆ§Ï„_r^-2 CÎ¾_u^2 u|_Ï_r_q] ) 
       = r^2(Îº_Ï_r_q^-2 +[ Câˆ«_Ï_r_q^(Ï_r_q+t)âˆ§Î»_r,Ï_r_qÎº_u^-4 u|_Ï_r_q ]) 
       â‰¤ r^2(r_q^-2 + Ctr^-4) â‰¤ (1-q)^2 + Cr^-2t
          for any tâˆˆ(0,âˆ).

It follows that (Î»_r,Ï_r_q  > Ï_r_q  + t) â‰¥ 1 - ((1-q)^2 + Cr^-2t). Taking t =  r^2, we obtainÂ (<ref>).









Note that on the event {Î»_r,Ï_r_q  > Ï_r_q +  r^2}, we have h(Îº_Ï_r_q + t)â‰¥ h(r) for all tâˆˆ[0, r^2] and measurable non-decreasing functions h:â†’.
Since r>â„“, the inclusion

    {âˆ«_0^Î»_â„“ h(Îº_t)  t â‰¥ h(r)r^2 }âŠƒ{Ï_r_q  < Î»_â„“}âˆ©{Î»_r,Ï_r_q  > Ï_r_q  +  r^2}
 holds and,
by the inequality inÂ (<ref>), we obtain 

    ( âˆ«_0^Î»_â„“ h(Îº_t)  t â‰¥ h(r)r^2|_0)    â‰¥[1{Ï_r_q  < Î»_â„“}(Î»_r,Ï_r_q  > Ï_r_q  +  r^2|_Ï_r)  |_0] 
       â‰¥ q(Ï_r_q <Î»_â„“|_0).


By assumption
lim sup_tâ†’âˆÎº_t =âˆ a.s. and thus 
Ï_r_q âˆ§Î»_â„“<âˆ a.s. 
Since (Îº_tâˆ§Ï_r_qâˆ§Î»_â„“^p)_tâˆˆ is a continuous (_t)-submartingale by AssumptionÂ <ref>, dominated convergence implies

    Îº_0^p â‰¤lim_tâ†’âˆ[Îº_tâˆ§Î»_â„“âˆ§Ï_r_q ^p|_0] = [Îº_Î»_â„“âˆ§Ï_r_q ^p|_0] â‰¤â„“^p + (Ï_r_q <Î»_â„“|_0)r_q^p.

On the event {Îº_0 > â„“} we obtain (Ï_r_q<Î»_â„“|_0) â‰¥ ((Îº_0^p-â„“^p)r_q^-p)âˆ§ 1. Combining this result withÂ (<ref>) implies the  general case of the lemma. The special case follows by setting hâ‰¡1.








Â§ NON-EXPLOSION AND RECURRENCE/TRANSIENCE DICHOTOMY FOR THE REFLECTED PROCESS
 



 Â§.Â§ Diffusivity and non-explosion under asymptotically normal reflection


The non-explosion of Z is essentially due to AssumptionÂ ass:vector2, which stipulates that the horizontal projection of the reflection  vanishes sufficiently fast when Z_t is far from the origin. In contrast, in the asymptotically oblique caseÂ <cit.>, the horizontal projection of the reflection vector field
has

a strictly positive limit as Z_t_d+1â†’âˆ, which  in a domain 
that narrows sufficiently fast, may lead to explosive behaviourÂ Ï„_ < âˆ a.s.



Suppose that AssumptionsÂ ass:domain2, ass:covariance2, ass:vector2 hold and
let (Z,L) satisfy SDEÂ (<ref>) in the domain  on the stochastic interval [0,).
For any starting point zâˆˆ, the process Z 
does not explode,  i.e.Â _z(Ï„_=âˆ)=1, and 

the second moment of Z_t  is finite and diffusive,
i.e.,
sup_tâˆˆ_z Z_t_d+1^2/(1+t)<âˆ. 


 
The finiteness of the first moment of Z_t_d+1, implied by TheoremÂ <ref>, is crucial in the proof of recurrence in TheoremÂ <ref>(a) and TheoremÂ <ref>(c) (see SectionÂ <ref> below for details).
A minor modification of the final step in the proof of TheoremÂ <ref>
would imply that the p-th moment of Z_t is also diffusive for any pâˆˆ(0,âˆ),
i.e., sup_tâˆˆ_z Z_t_d+1^p/(1+t)^p/2<âˆ
(see RemarkÂ <ref>, after the proof of TheoremÂ <ref> below).


    AssumeÂ ass:vector2, ass:domain2 and ass:covariance2 are satisfied.
Consider the process  f_w,Î³(Z)
for any Î³âˆˆ(-âˆ,1] and wâˆˆâˆ–{0},
where the function f_w,Î³ is 
given inÂ (<ref>).
ItÃ´'s formula applied to f_w,Î³(Z)
on the stochastic interval [0,) is given inÂ (<ref>). The quadratic variation of the local martingale M inÂ (<ref>)
grows at most linearly in time. Indeed, 
the representation inÂ (<ref>) and the bound inÂ (<ref>) of LemmaÂ <ref> (recall that Î³â‰¤ 1) imply

    [M]_t â‰¤âˆ«_0^t Î£(Z_s)_opâˆ‡ f_w,Î³(Z_s)_d+1^2  sâ‰¤ C_Î³ t,  for 0 â‰¤ t < Ï„_,

for a   constant C_Î³âˆˆ. 
The inequality inÂ (<ref>) relies on the norm
Î£_op=Î£^1/2_op^2
being bounded via
AssumptionÂ ass:covariance1. 

Our first task is to prove _z(=âˆ)=1 for any zâˆˆ. Pick w âˆˆ(-âˆ, 1-Î² s_0/c_0)âˆ–{0}, ensuring by LemmaÂ <ref> that âŸ¨âˆ‡ f_w,1(z),Ï•(z)âŸ© < 0
for all z=(x,y)âˆˆ with sufficiently large x, and define the process Îº := f_w,1(Z). 
Recall the definition of the stopping times Ï_r (for any râˆˆ_+ and T=0) inÂ (<ref>) and Ï_âˆ=lim_râ†’âˆÏ_r, both
given in SectionÂ <ref>
for the process Îº.
ByÂ (<ref>), the function f_w,1 has linear growth at infinity, implying the equality of the events
{<âˆ}={Ï_âˆ<âˆ}.

We will apply LemmaÂ <ref> with the identity function V(r) = r for all r âˆˆ (2^-1/|w|-1,âˆ)
to conclude (Ï_âˆ<âˆ)=0. Since Î³=1, byÂ (<ref>) in LemmaÂ <ref>,
we have 

    Î”_Î£ f_w,1(z) = f_w,1(z)^-1Ïƒ_2^2(1-w) + o_(1)  as xâ†’âˆ.

Thus, byÂ (<ref>), there exists Î·>0 satisfying |Î”_Î£ f_w,1(z)|<Î· for all zâˆˆ.
Moreover,
by LemmaÂ <ref>, there exists r_0>0 such that 
âŸ¨âˆ‡ f_w,1(z),Ï•(z)âŸ© < 0
for all z=(x,y)âˆˆ satisfying xâ‰¥ r_02^-1/|w|-k_w.
Note that the upper bound on f_w,1 inÂ (<ref>) 
implies that 
any zâˆˆ with 
f_w,1(z)â‰¥ r_0
must satisfy 
xâ‰¥ r_02^-1/|w|-k_w (and hence 
âŸ¨âˆ‡ f_w,1(z),Ï•(z)âŸ© < 0).


For any stopping time T âˆˆ,
recall the definition inÂ (<ref>) of the exit time S_r,T
of the process Îº from the interval (r_0,r) after time T.
In order to apply LemmaÂ <ref>, 
assume that the stopping time T is such that [Îº_T1{T < Ï_âˆ}] < âˆ.
Then, by ItÃ´'s formula inÂ (<ref>) and the choice of the constants Î· and r_0, the process Î¶^T,r=(Î¶_t^T,r)_tâˆˆ, defined for any tâˆˆ by  
Î¶_t^T,r := (Îº_(t+T) âˆ§ S_r,T - Î· ( t âˆ§ ( S_r,T - T ) ) ) 1{T < Ï_âˆ},
 satisfies 
 
    Î¶_t^T,r-Î¶_s^T,râ‰¤(M_(t+T) âˆ§ S_r,T-M_(s+T) âˆ§ S_r,T)1{T < Ï_âˆ}  a.s. for any 0â‰¤ sâ‰¤ t,
 
  where M is the local martingale arising inÂ (<ref>) (for the function f_w,1). Since Îº is continuous, on the event {T < Ï_âˆ} it holds that S_r,T < Ï_âˆ. Thus, byÂ (<ref>), we get
 
    [M]_(t+T) âˆ§ S_r,T-[M]_T â‰¤ C_1((t+T) âˆ§ S_r,T-T)â‰¤ C_1t   for all tâˆˆ,

 ensuring that (M_(t+T) âˆ§ S_r,T)_tâˆˆ is a true (_t+T)-martingale and implying 
 [Î¶_t^T,r-Î¶_s^T,r|_s+T] â‰¤ 0
 for all 0â‰¤ sâ‰¤ t.
 Since Î¶^T,r is an (_t+T)-supermartingale
 for all râˆˆ(r_0,âˆ), LemmaÂ <ref>
 yields (Ï_âˆ=âˆ)=1. Thus, 
 _z(Ï„_ = âˆ)=1
 for all zâˆˆ. 
 In the remainder of the section we assume that Z satisfies SDEÂ (<ref>)
on the entire time interval . 








We now prove there exists a constant C_2>0 such that _zZ_t_d+1^2â‰¤ C_2 (t+z_d+1^2+1) holds for any zâˆˆ and tâˆˆ.
Pick wâˆˆ(-âˆ,1-Î² s_0/c_0)âˆ–{0}, note Î² s_0/c_0-1+w<0 and apply LemmaÂ <ref> to find the constants 0<x_0<x_1 and kâˆˆ(0,âˆ) such that the corresponding function  F_w,2, defined inÂ (<ref>), satisfies âŸ¨âˆ‡ F_w,2(z),Ï•(z)âŸ©â‰¤ 0 for all zâˆˆâˆ‚. Moreover, byÂ (<ref>), we have Î”_Î£ F_w,2(z)=Î”_Î£ f_w,2(z) for all z=(x,y)âˆˆâˆ© [x_1,âˆ)Ã—^d. Since F_w,2 is smooth on a neighbourhood of 
and, byÂ (<ref>) in  LemmaÂ <ref>,
the function zâ†¦|Î”_Î£ f_w,2(z)| is bounded on ,
there exists a constant 
C_0'âˆˆ(0,âˆ) satisfying |Î”_Î£ F_w,2(z)|<C_0' for all zâˆˆ.
By AssumptionÂ ass:domain2, the boundary function b is sublinear (cf. RemarkÂ <ref> above): there exist constants C_1',C_2'âˆˆ(0,âˆ) such that b(x)^2<C_1'x^2+C_2' for all xâˆˆ.
Thus, by the definition of F_w,2 inÂ (<ref>)
and the lower bound on f_w,2 inÂ (<ref>), there exist positive constants C_i'âˆˆ(0,âˆ), iâˆˆ{3,4,5,6},  satisfying 

    z_d+1^2â‰¤ x^2+b(x)^2â‰¤ 
    (C_1'+1)x^2+C_2'â‰¤
    C_3' F_w,2(z)+C_4'â‰¤ C_5' z_d+1^2 +C_6'  for all zâˆˆ.


Recall that the coordinates of Z=(X,Y), taking values in , satisfy X_tâˆˆ and Y_tâˆˆ^d for all tâˆˆ. Define the passage time of the level râˆˆ for the process X by

    Ï±_r := inf{tâˆˆ: X_tâ‰¥ r},

(with infâˆ… =âˆ).
Fix r and assume that the starting point zâˆˆ of the process Z
lies in [0,r)Ã—^d or, equivalently, _z(Ï±_r>0)=1.
The definition of F_w,2 in the previous paragraph and
ItÃ´'s formula inÂ (<ref>) applied to the process
(F_w,2(Z_tâˆ§Ï±_r))_tâˆˆ
yield the following inequalities for all tâˆˆ:

    F_w,2(Z_tâˆ§Ï±_r)â‰¤ F_w,2(z)+ 1/2âˆ«_0^tâˆ§Ï±_rÎ”_Î£ F_w,2(Z_s) s + M_Ï±_râˆ§ t+â‰¤ 
    F_w,2(z)+ tC_0' + M_Ï±_râˆ§ t.





Moreover, the quadratic variation of M_Ï±_râˆ§Â· inÂ (<ref>) is almost surely bounded 
and hence integrable,
since the gradient 
âˆ‡ F_w,2 is bounded on compact sets. Thus 
_zM_tâˆ§Ï±_r=0 for all t,râˆˆ, implying the inequality 
_z  F_w,2 (Z_tâˆ§Ï±_r) â‰¤ tC_0' + F_w,2(z)
for all t,râˆˆ and zâˆˆâˆ© [0,r)Ã—^d.

Since Z does not explode in finite time and has continuous paths,
we have Ï±_râ†’âˆ a.s. as râ†’âˆ and hence 
Z_tâˆ§Ï±_râ†’ Z_t
a.s. as râ†’âˆ.
By Fatou's lemma and the inequalities inÂ (<ref>),
for all tâˆˆ and zâˆˆ, we obtain

    _zZ_t_d+1^2= _z lim inf_râ†’âˆZ_tâˆ§Ï±_r_d+1^2â‰¤lim inf_râ†’âˆ_zZ_tâˆ§Ï±_r_d+1^2
    
    â‰¤ tC_0'C_3'+ C_5'  z_d+1^2 +C_6',

concluding the proof of TheoremÂ <ref>.



 
The proof of TheoremÂ <ref> can be modified to get
sup_tâˆˆ_z Z_t_d+1^2p/(1+t)^p<âˆ
for any pâˆˆ(0,âˆ).
For pâˆˆ, we note that F_w,2p
can be constructed by LemmaÂ <ref> as above, so that
âŸ¨âˆ‡ F_w,2p(z),Ï•(z)âŸ©â‰¤ 0 for all zâˆˆâˆ‚.
ByÂ (<ref>) in  LemmaÂ <ref> there exists
C_0'âˆˆ(0,âˆ) satisfying |Î”_Î£ F_w,2p(z)|<C_0'F_w,2(p-1)(z) for all zâˆˆ.
This inequality, combined with the modification ofÂ (<ref>) for z_d+1^2p
and F_w,2p(z), and induction on pâˆˆ yields the diffusive property of moments for all even powers. 
The statement for all positive real powers p can be deduced from the even powers via 
Lyapunov's

inequality. As the generalisation 
of the p=1 is not essential for the development in the present paper, the details are omitted for brevity.  
















 Â§.Â§ Proof of recurrence/transience classification


By TheoremÂ <ref>, in the remainder of the section we may assume without loss of generality that Z satisfies SDEÂ (<ref>)
on the entire time interval . 
The proof of TheoremÂ <ref>
starts with a lemma about non-confinement, essential  for the applications of LemmasÂ <ref> andÂ <ref> in the proof of recurrence/transience dichotomy.



UnderÂ ass:vector1, ass:domain1 and ass:covariance1, the process Z=(X,Y) defined by SDEÂ (<ref>), started at any zâˆˆ, satisfies

    lim sup_tâ†’âˆX_t=lim sup_tâ†’âˆf_w,1(Z_t)=lim sup_tâ†’âˆF_w,1(Z_t)=lim sup_tâ†’âˆg_Î´(Z_t)=âˆ  _z-a.s.
 
for any wâˆˆâˆ–{0} and Î´âˆˆ(0,âˆ), where the functions f_w,1, F_w,1 and g_Î´ are given  inÂ (<ref>),Â (<ref>) andÂ (<ref>), respectively.



UnderÂ ass:vector1, ass:domain1, ass:covariance1, <cit.> implies that the process Z=(X,Y) cannot be confined to a compact set:

lim sup_t â†’âˆ X_t = âˆ _z-a.s.Â for all zâˆˆ. 


In particular, by the inequality inÂ (<ref>) (resp.Â (<ref>)), for any parameter value wâˆˆâˆ–{0}
(resp. Î´âˆˆ(0,âˆ))
the process f_w,1(Z) (resp. g_Î´(Z)) is also not confined: lim sup_t â†’âˆf_w,1(Z_t) = âˆ (resp. lim sup_tâ†’âˆg_Î´(Z_t)=âˆ) a.s. Since, byÂ (<ref>), the functions f_w,1 and F_w,1 coincide on the complement of a neighbourhood of the origin, the lemma follows.    



    Since AssumptionsÂ ass:vector1, ass:domain1, ass:covariance1 hold ifÂ ass:vector2, ass:domain2, ass:covariance2 are satisfied, we may apply LemmaÂ <ref> in the proofs of this section.





(a) Recurrence for Î²<Î²_c.
The definition of Î²_c inÂ (<ref>) and the assumption  Î²<Î²_c imply that Î² s_0/c_0<Ïƒ_1^2/Ïƒ_2^2 (recall the the definition of Ïƒ_1^2,Ïƒ_2^2 and s_0,c_0
in AssumptionsÂ ass:covariance2 andÂ ass:vector2, respectively).
Pick wâˆˆ(1-Ïƒ_1^2/Ïƒ_2^2,1-Î² s_0/c_0)âˆ–{0}
and note that
0<1-(1-w)Ïƒ_2^2/Ïƒ_1^2. Choose Î³âˆˆ(0,min{1,1-(1-w)Ïƒ_2^2/Ïƒ_1^2})
and observe the inequalities:

    Ïƒ_1^2(Î³-1)+Ïƒ_2^2(1-w)<0  and  Î³(s_0Î²/c_0-1+w)<0.

LemmaÂ <ref> and the inequalities inÂ (<ref>) andÂ (<ref>) imply that there exists
r_0âˆˆ(0,âˆ) such that for all z=(x,y)âˆˆ with xâ‰¥ 2^-1/|w|r_0-k_w
we have

    Î”_Î£ f_w,Î³(z)<0  and  âŸ¨âˆ‡ f_w,Î³(z),Ï•(z)âŸ© < 0.



Consider the process Îº = f_w,1(Z) and a continuous function V:â†’(0,âˆ), satisfying V(r) = r^Î³ for all râˆˆ(2^-1/|w|-1,âˆ).
Since, byÂ (<ref>), f_w,1(z)â‰¥ 2^-1/|w| for all zâˆˆ,
we have V(Îº)=f_w,Î³(Z). Moreover, byÂ (<ref>) and the fact that 0<Î³<1, there exist constants D_1,D_2âˆˆ(0,âˆ) such that the inequality f_w,Î³(z) â‰¤ D_1 z_d+1+D_2 
holds
for all zâˆˆ. Thus, by TheoremÂ <ref>, we get 0<[V(Îº_t)]=_z[f_w,Î³(Z_t)] â‰¤ D_1 _z Z_t_d+1+D_2< âˆ for any tâˆˆ and zâˆˆ.

For any fixed t_0âˆˆ and any râˆˆ(r_0,âˆ),
recall the definition inÂ (<ref>) of
the exit time S_r,t_0
of the process Îº from the interval (r_0,r) after time t_0.
The choice of r_0, the inequalities inÂ (<ref>), and 
ItÃ´'s formula inÂ (<ref>), applied to the process
V(Îº_(Â·+t_0) âˆ§ S_r,t_0)=f_w,Î³(Z_(Â·+t_0) âˆ§ S_r,t_0)
 imply 

    f_w,Î³(Z_(t+t_0) âˆ§ S_r,t_0)- f_w,Î³(Z_t_0)-(M_(t+t_0) âˆ§ S_r,t_0-M_t_0)â‰¤ 0  a.s.

The local martingale (M_t)_tâˆˆ has integrable quadratic variation byÂ (<ref>), making it a true martingale and implying [V(Îº_(t+t_0)âˆ§ S_r,t_0) -V(Îº_(s+t_0)âˆ§ S_r,t_0)|â„±_s+t_0]â‰¤ 0 for all 0 â‰¤ sâ‰¤ t. Since
V(Îº_t_0âˆ§ S_r,t_0)=V(Îº_t_0)
is integrable, the process
(V(Îº_(t+t_0)âˆ§ S_r,t_0))_tâˆˆ is an (_t+t_0)-supermartingale for all râˆˆ(r_0,âˆ). ByÂ LemmaÂ <ref>,
we have lim sup_t â†’âˆÎº_t = âˆ a.s. Since lim_r â†’âˆV(r) = âˆ, we may apply LemmaÂ <ref> to conclude that Îº= f_w,1(Z) is recurrent. ByÂ (<ref>) andÂ (<ref>), the recurrence of Z follows.



(b) Transience for Î²>Î²_c.
The definition of Î²_c inÂ (<ref>) and the assumption  Î²>Î²_c imply that Ïƒ_1^2/Ïƒ_2^2<Î² s_0/c_0. Pick w âˆˆ (1-Î² s_0/c_0,1-Ïƒ_1^2/Ïƒ_2^2)âˆ–{0} and note that 1-Ïƒ_2^2/Ïƒ_1^2(1-w)<0. Choose Î³âˆˆ (1-Ïƒ_2^2/Ïƒ_1^2(1-w),0) and observe the inequalities:

    Î³(Ïƒ_1^2(Î³-1)+Ïƒ_2^2(1-w))<0  and  Î³(s_0Î²/c_0-1+w)<0.

LemmaÂ <ref>, along with the inequalities inÂ (<ref>) andÂ (<ref>) imply that there exists 
r_0âˆˆ(0,âˆ) such that for all z=(x,y)âˆˆ with xâ‰¥ 2^-1/|w|r_0-k_w
we have

    Î”_Î£ f_w,Î³(z)<0  and  âŸ¨âˆ‡ f_w,Î³(z),Ï•(z)âŸ© < 0.

Consider the process Îº = f_w,1(Z) and a continuous function V:â†’(0,âˆ), satisfying V(r) = r^Î³ for all râˆˆ(2^-1/|w|-1,âˆ).
Since, byÂ (<ref>), f_w,1(z)â‰¥ 2^-1/|w| for all zâˆˆ,
we have V(Îº)=f_w,Î³(Z).
For any 
stopping time T âˆˆ, satisfying  T < âˆ a.s.,
we have _zV(Îº_T)<âˆ for all zâˆˆ since the function V is bounded.
Pick râˆˆ(r_0,âˆ)
and recall the definition inÂ (<ref>) of
the exit time S_r,T
of the process Îº from the interval (r_0,r) after time T.
The choice of r_0 and 
ItÃ´'s formula inÂ (<ref>), applied to the process
V(Îº_(Â·+T âˆ§ S_r,T)=f_w,Î³(Z_(Â·+T) âˆ§ S_r,T),
imply

    f_w,Î³(Z_(t+T) âˆ§ S_r,T)- f_w,Î³(Z_T)-(M_(t+T) âˆ§ S_r,T-M_T)â‰¤ 0  a.s.

Moreover, local martingale (M_t)_tâˆˆ has integrable quadratic variation byÂ (<ref>), making it a true martingale, and for any tâˆˆ, [V(Îº_t)] < âˆ by the fact that V is bounded. This implies [V(Îº_(t+T)âˆ§ S_r,T)-V(Îº_(s+T)âˆ§ S_r,T)|_s+T]â‰¤ 0 for all 0 â‰¤ s â‰¤ t.  Thus, (V(Îº_(t+T)âˆ§ S_r,T)_tâˆˆ is an (_t+T)-supermartingale for all râˆˆ(r_0,âˆ).  Since lim sup_t â†’âˆÎº_t = âˆ a.s. and lim_r â†’âˆV(r) = 0, Lemma <ref> yields transience of Îº=f_w,1(Z).
ByÂ (<ref>), the transience of Z follows.



(c) The critical case Î²=Î²_c. Assume Î²=Î²_c and ass:domain2plus, ass:vector2plus, ass:covariance2plus. Consider the process Îº := g_Î´(Z) with g_Î´ defined inÂ (<ref>) and the parameter Î´ chosen to satisfy the assumption in LemmaÂ <ref>.
Then, by LemmaÂ <ref>, there exists  x_0>0 such that the inequalities inÂ (<ref>) hold.
Define r_0:=C_Î´ + log x_0 and note that, 
byÂ (<ref>), the inequality
r_0â‰¥ g_Î´(z) (where z=(x,y))
implies 
xâˆˆ[x_0,âˆ).
Set V(r) = r for all r âˆˆ (1/2,âˆ)
and note V(Îº_t) =Îº_t= g_Î´(Z_t) (recall g_Î´ > 1 on ).
Pick t_0âˆˆ and râˆˆ(r_0,âˆ)
and 
recall the definition inÂ (<ref>)
of the exit time S_r,t_0 
of the process Îº from the interval (r_0,r) after time t_0.
The choice of r_0, the inequalities inÂ (<ref>) and 
ItÃ´'s formula inÂ (<ref>), applied to the process
Îº_(Â·+t_0) âˆ§ S_r,t_0=g_Î´(Z_(Â·+t_0) âˆ§ S_r,t_0),
imply

    g_Î´(Z_(t+t_0) âˆ§ S_r,t_0)- g_Î´(Z_t_0)-(M_(t+t_0) âˆ§ S_r,t_0-M_t_0)â‰¤ 0  a.s.

By continuity, the gradient âˆ‡ g_Î´(z)_d+1^2 is bounded on compact sets and Î£_op is bounded by AssumptionÂ ass:covariance1. Thus, by the representation inÂ (<ref>), we can bound the quadratic variation

    [M]_(t+t_0) âˆ§ S_r,t_0-[M]_t_0â‰¤âˆ«_t_0^(t+t_0) âˆ§ S_r,t_0Î£(Z_s)_opâˆ‡ g_Î´(Z_s)_d+1^2ds â‰¤CÌƒ_1t  a.s.,

where CÌƒ_1âˆˆ(0,âˆ) is a positive constant. Thus the process (M_(t+t_0) âˆ§ S_r,t_0-M_t_0)_tâˆˆ is a true martingale.
Moreover, since g_Î´(z) â‰¤CÌƒ_2z_d+1 + CÌƒ_3 holds for all zâˆˆ for some positive constants CÌƒ_2,CÌƒ_3, TheoremÂ <ref> implies _z[Îº_t]=_z[g_Î´(Z_t)]â‰¤CÌƒ_2 _
z Z_t_d+1 +CÌƒ_3<âˆ for any tâˆˆ and zâˆˆ.
Thus, [Îº_(t+t_0)âˆ§ S_r,t_0 -Îº_(s+t_0)âˆ§ S_r,t_0|â„±_s+t_0]â‰¤ 0 for all 0 â‰¤ sâ‰¤ t, and hence (Îº_(t+t_0)âˆ§ S_r,t_0)_tâˆˆ is an (_t+t_0)-supermartingale for all râˆˆ(r_0,âˆ) and any t_0âˆˆ. Moreover, by 
LemmaÂ <ref>,
we have
 lim sup_t â†’âˆÎº_t=âˆ a.s.
Since lim_r â†’âˆV(r) = âˆ, we may apply LemmaÂ <ref> to conclude that Îº= g_Î´(Z) is recurrent. ByÂ (<ref>) andÂ (<ref>), the recurrence of Z follows.







Â§ RETURN TIMES, DRIFT CONDITIONS, AND THE PROOF OF THEOREMÂ <REF>



The tails of return times are controlled by PropositionsÂ <ref> andÂ <ref>,
established in this section. The two propositions are crucial
in the proof of TheoremÂ <ref>(b);
see RemarkÂ <ref> below for more details.
Moreover, PropositionsÂ <ref> is key in obtaining the lower bounds on the tails of the  invariant distribution of Z in the positive-recurrent regime:
see the proof of TheoremÂ <ref>
in SectionÂ <ref> below. The drift conditions in LemmaÂ <ref>, proved in the present section, are used for establishing finite moments (and hence upper bounds on the tails) of the invariant distribution and the rate of convergence to stationarity of Z
in the positive-recurrent regime (see the proof of PropositionÂ <ref> in SectionÂ <ref> below). The common theme of the proofs of the results in this section is that they are all based on the supermartingale property of certain processes. 

Recall the definitions of the return time Ï‚_r (for râˆˆ(0,âˆ)) inÂ (<ref>) and  of the critical exponent m_c=(1-Î²/Î²_c)/2 inÂ (<ref>).



Suppose thatÂ ass:domain2, ass:covariance2, ass:vector2 hold and Î² < Î²_c. Then, for every p âˆˆ(0,m_c), there exists x_0>0 such that for all x_1 âˆˆ(x_0,âˆ) and zâˆˆ  there exists a constant C âˆˆ (depending only on z and p) for which

    _z(Ï‚_x_1 > t) â‰¤ Ct^-p    for all tâˆˆ(0,âˆ).


Moreover, equivalently, for every p âˆˆ (0,m_c) and every z âˆˆ, we have _z[Ï‚_x_1^p] < âˆ.



Pick Î³âˆˆ (0,(1-Î²/Î²_c)/2).  Then we can choose w âˆˆ  (-âˆ,1-Î² s_0/c_0)âˆ–{0}, such that Ïƒ_1^2(2Î³ -1) + Ïƒ_2^2(1-w)<0.
Thus, for any âˆˆ(0,-(Ïƒ_1^2(2Î³ -1) + Ïƒ_2^2(1-w))),
LemmaÂ <ref> implies the existence of â„“_0 âˆˆ(0,âˆ),  such that for all z=(x,y)âˆˆ with x > 2^-1/|w|â„“_0 -k_w (the constant k_w
is given above displayÂ (<ref>)), 
the function f_w,2Î³ defined inÂ (<ref>) 
satisfies

    Î”_Î£ f_w,2Î³(z) + f_w,2Î³-2(z) < 0    and  âŸ¨âˆ‡ f_w,2Î³(z),Ï•(z)âŸ© < 0.


Having chosen the parameters Î³, w, and , consider the process Îº = f_w,1(Z).
The key step in the proof of the proposition consists of the application ofÂ <cit.> to deduce that,  for any zâˆˆ with Îº_0=f_w,1(z)> â„“_0, 
the return time Î»_â„“_0 of Îº
below the level â„“_0, defined inÂ (<ref>), has finite Î³-moment, i.e.,
_z[Î»_â„“_0^Î³] < âˆ. 
This will hold byÂ <cit.>
if we establish that the process 
(Î¾_t)_tâˆˆ, given by 
Î¾_t:=Îº_t âˆ§Î»_â„“_0^2Î³ + Ïµâˆ«_0^t âˆ§Î»_â„“_0Îº_u^2Î³ - 2 u,
is a supermartingale. 

With this in mind, take an arbitrary râˆˆ(â„“_0,âˆ) and consider the stopped process 
(Î¾_t âˆ§Ï_r)_tâˆˆ,
where the stopping time Ï_r, defined inÂ (<ref>), is the first time the process Îº reaches level r.
Since 0â‰¤Î¾_t âˆ§Ï_râ‰¤max{r^2Î³,f_w,2Î³(z)}+ t max{r^2Î³-2,â„“_0^2Î³-2}
for all tâˆˆ, we have _z[Î¾_t âˆ§Ï_r]<âˆ.
Moreover, by ItÃ´'s formula inÂ (<ref>), the inequalities
inÂ (<ref>)
and the fact that Îº_tâ‰¥â„“_0 for all tâˆˆ,
for any two times 0â‰¤ s â‰¤ t < âˆ we have
Î¾_t âˆ§Ï_r-Î¾_s âˆ§Ï_r-M_t âˆ§Î»_â„“_0âˆ§Ï_r+M_s âˆ§Î»_â„“_0âˆ§Ï_râ‰¤ 0 a.s.
Since the local martingale M has, byÂ (<ref>)
 andÂ ass:covariance2, bounded quadratic variation for each 
tâˆˆ with probability one,
 the stopped process (Î¾_t âˆ§Ï_r)_tâˆˆ
 is a supermartingale for any râˆˆ(â„“_0,âˆ).
 By TheoremÂ <ref>
 we have lim_râ†’âˆÏ_r=âˆ.
 Thus Î¾_t=lim inf_râ†’âˆÎ¾_tâˆ§Ï_r for all tâˆˆ.
 Since the process 
 (Î¾_t)_tâˆˆ is non-negative, the conditional Fatou lemma implies that it is a supermartingale.
 Hence, byÂ <cit.>, we have
 _z[Î»_â„“_0^Î³] < âˆ. 





















Recall that f_w,1(Z)=Îº. Hence the second inequality inÂ (<ref>) implies that, for x_0:= 2^1/|w|â„“_0-k_w, we have Ï‚_x_0â‰¤Î»_â„“_0 a.s., and thus  _z[Ï‚_x_0^Î³]<âˆ. Moreover, for any 
x_1âˆˆ(x_0,âˆ), we have 
 _z(Ï‚_x_0â‰¥Ï‚_x_1)=1 
 and hence 
 _z(Ï‚_x_1 > t)â‰¤_z(Ï‚_x_0>t) for all tâˆˆ.
 Since,
for any Î³âˆˆ(0,m_c), 
Markov's inequality implies 
_z(Ï‚_x_0>t)â‰¤_z[Ï‚_x_0^Î³]/t^Î³<âˆ for all tâˆˆ(0,âˆ), we have  

    _z(Ï‚_x_1 > t)â‰¤_z(Ï‚_x_0>t) â‰¤ Ct^-p   for all tâˆˆ, pâˆˆ(0,m_c) and

the constant C:=_z[Ï‚_x_0^p]âˆˆ(0,âˆ), independent of x_1âˆˆ(x_0,âˆ).




The next proposition provides lower bounds on the tails of return times and related path functionals in the recurrent case. This result is a key ingredient in the proof of TheoremsÂ <ref>(b), as well as in the proof of lower bounds in TheoremÂ <ref>.
The proof of PropositionÂ <ref>
is based on an application of LemmaÂ <ref> of SectionÂ <ref> above.
Recall m_c=(1-Î²/Î²_c)/2 defined inÂ (<ref>).





Suppose thatÂ ass:domain2, ass:covariance2, ass:vector2 hold with Î² < Î²_c. Then, for every pâˆˆ(2m_c,âˆ), there exist x_0âˆˆ(0,âˆ) and constants c_1,c_2âˆˆ(1,âˆ)
such that,
for every 
non-decreasing measurable function h:â†’,
qâˆˆ(0,1),
x_1âˆˆ(x_0,âˆ)
and z=(x,y)âˆˆâˆ© (c_1x_1+c_2,âˆ)Ã—^d

we have 


    _z(âˆ«_0^Ï‚_x_1 h(c_1(X_s + c_2)) s â‰¥ r^2h(r)) â‰¥ qmin{(c_1^-p(x-c_2)^p-x_1^p)(1-q)^pr^-p,1},

for all râˆˆ(c_1x_1+c_2,âˆ) and all sufficiently small >0. In particular, 
    _z(Ï‚_x_1â‰¥ t) â‰¥ qmin{(c_1^-p(x-c_2)^p-x_1^p)^p/2(1-q)^p t^-p/2,1},
 for every tâˆˆ(c_1x_1+c_2,âˆ) and all  sufficiently small >0.





PropositionsÂ <ref> andÂ <ref> provide crucial estimates in the proof of TheoremÂ <ref>(b) in SectionÂ <ref> below.
The only assertion of 
TheoremÂ <ref>(b) not contained in PropositionsÂ <ref> andÂ <ref>
is that the lower bound in 
PropositionsÂ <ref>
actually holds for all zâˆˆâˆ© (x_0,âˆ)Ã—^d
and not only for the starting points z sufficiently far (in the x-direction) from x_0. This generalisation requires uniform ellipticity and will be established in SectionÂ <ref>.




 Pick pâˆˆ (1-Î²/Î²_c,âˆ) and note p>0. Then there exists w âˆˆ(1-Î² s_0/c_0,âˆ)âˆ–{0}, such that p  > 1 - Ïƒ_2^2/Ïƒ_1^2(1-w). LemmaÂ <ref> implies that there exist â„“_0> 0 and a constant C âˆˆ such that, for all z=(x,y)âˆˆ with x > 2^-1/|w|â„“_0 -k_w (the constant k_w
is defined above displayÂ (<ref>)),
we have

    Î”_Î£ f_w,p(z)  > 0      and  âŸ¨âˆ‡ f_w,p(z),Ï•(z)âŸ© > 0,
    Î”_Î£ f_w,-2(z)  â‰¤ Cf_w,-4(z)       and  âŸ¨âˆ‡ f_w_1,-2(z),Ï•(z)âŸ© < 0.


Define Îº := f_w,1(Z)
and recall the return time Î»_â„“_0 of Îº
below the level â„“_0, defined inÂ (<ref>).
ByÂ (<ref>), on the event {Îº_t=f(Z_t)â‰¥â„“_0}, the first coordinate X_t  of Z_t satisfies
X_t > 2^-1/|w|â„“_0 -k_w.
ItÃ´'s formula inÂ (<ref>) 
applied to  Îº = f_w,1(Z) and the inequalities inÂ (<ref>)
imply that, for all r>â„“â‰¥â„“_0 and 0â‰¤ s â‰¤ t < âˆ, we have 
Îº_tâˆ§Î»_â„“âˆ§Ï_r ^p - M_tâˆ§Î»_â„“âˆ§Ï_râ‰¥Îº_s âˆ§Î»_â„“âˆ§Ï_r ^p - M_s âˆ§Î»_â„“âˆ§Ï_r.
 The process M is a true martingale, since its quadratic variation is bounded byÂ (<ref>) andÂ ass:covariance2. Thus,
 since  _z[Îº_tâˆ§Î»_â„“âˆ§Ï_r^p] â‰¤max{r^p, f_w,p(z)}, the process (Îº_tâˆ§Î»_â„“âˆ§Ï_r^p)_tâˆˆ is an (_t)-submartingale.


 Pick râˆˆ(â„“_0,âˆ), qâˆˆ(0,1) and set r_q := r/(1-q). Recall that f_w,1(Z_t) = Îº and define the process Î¾=(Î¾_t)_tâˆˆ by Î¾_t :=  Îº_(Ï_r_q + t)âˆ§Î»_r,Ï_r_q^-2 - Câˆ«_Ï_r_q^t âˆ§Î»_r,Ï_r_qÎº_u^-4 u,
 where the constant C>0 is as inÂ (<ref>).
 By ItÃ´'s formula inÂ (<ref>) and the inequalities inÂ (<ref>),  for every  0â‰¤ s â‰¤ t < âˆ, we have 
 
    Î¾_t - Î¾_s - (M_(Ï_r_q + t)âˆ§Î»_r,Ï_r_q- M_(Ï_r_q + s)âˆ§Î»_r,Ï_r_q) â‰¤ 0  a.s.

 Since the process Î¾ is bounded, an analogous argument to the one in the previous paragraph implies that Î¾ is a supermartingale.
 
 
 
 We have now proved that  Assumptions (a) and (b) of LemmaÂ <ref> are satisfied. 
 Moreover, by 
 LemmaÂ <ref>,
  we have lim sup_tâ†’âˆÎº_t=âˆ a.s.
Hence, by LemmaÂ <ref>, for any 

 zâˆˆ and â„“>â„“_0, satisfying f_w,1(z) > â„“, any non-decreasing measurable function h:â†’ and all sufficiently small >0, 
 we obtain
 
    _z(âˆ«_0^Î»_â„“ h(f_w,1(Z_s))  sâ‰¥ r^2h(r)) â‰¥ qmin{(f_w,1(z)^p-â„“^p)(1-q)^pr^-p,1},
      râˆˆ(â„“,âˆ).

 


Define x_0:=2^-1/|w|â„“_0-k_w,
c_1:=2^1/|w| 
and
c_2:=k_w. Then, for any x_1âˆˆ(x_0,âˆ)
there exists â„“>â„“_0,
such that 
x_1=2^-1/|w|â„“-k_w.
The second inequality  inÂ (<ref>) implies
Ï‚_x_1â‰¥Î»_â„“
and 
h(f_w,1(Z_s))â‰¤ h(2^1/|w|(X_s+k_w))
for all non-decreasing measurable functions h:â†’ and sâˆˆ[0,Î»_â„“].
Thus the inequality 
âˆ«_0^Î»_â„“ h(f_w,1(Z_s))  sâ‰¤âˆ«_0^Ï‚_x_0 h(2^1/|w|(X_s+k_w))  s
holds, implying  byÂ (<ref>) the inequality in the proposition
for all râˆˆ(2^1/|w|x_0+k_w,âˆ).
The special case follows by choosing hâ‰¡1.




The next result establishes a drift condition (in the positive-recurrent case), used in the proofs of the upper bounds 
of TheoremÂ <ref>
concerning the finite moments of the invariant distribution Ï€ of Z and the total variation distance between _z(Z_tâˆˆÂ·) and Ï€.

The proof of LemmaÂ <ref> is analogous to the proof of PropositionÂ <ref>.
For any râˆˆ, denote

    ^(r) := âˆ© [0,r]Ã—^d.




Suppose thatÂ ass:covariance2, ass:vector2 and ass:domain2 hold with Î² < -Î²_c. Then, for any  Î³âˆˆ(0,1-Î²/Î²_c), there exist parameters w âˆˆ(-âˆ,1-Î² s_0/c_0)âˆ–{0} and x_0,x_1,kâˆˆ, defining the function F_w,Î³ inÂ (<ref>), and
x_2âˆˆ, C_1,C_2âˆˆ, such that the process Î¾ = (Î¾_t)_tâˆˆ,

    Î¾_t := F_w,Î³(Z_t) + C_1âˆ«_0^t  F_w,Î³-2(Z_u) u - C_2âˆ«_0^t1_^(x_2)(Z_u) u,

is an (_t)-supermartingale.







Note that the process  F_w,Î³(Z) in LemmaÂ <ref> gets a non-positive push 
(by LemmaÂ <ref>)
when Z hits the boundary âˆ‚. The constant C_1 (resp.Â C_2)  needs to be 
sufficiently small (resp. large) for the process Î¾ to have non-positive drift in the entire interior of .


Pick 
Î³âˆˆ(0,1-Î²/Î²_c) 
and note that 
1+Ïƒ_1^2/Ïƒ_2^2(Î³-1)<1-Î² s_0/c_0, since
Î²_c=c_0Ïƒ_1^2/(s_0Ïƒ_2^2) by definitionÂ (<ref>).

Pick 
wâˆˆ(1+Ïƒ_1^2/Ïƒ_2^2(Î³-1),1-Î² s_0/c_0)âˆ–{0}
and note that 
Î³(Î² s_0/c_0-1+w)< 0. LemmaÂ <ref> implies that there exist 
x_0,x_1,kâˆˆ(0,âˆ) such that the function F_w,Î³ defined inÂ (<ref>) satisfies  âŸ¨âˆ‡ F_w,Î³(z),Ï•(z)âŸ© < 0 for all zâˆˆâˆ‚.


ByÂ (<ref>) we have  F_w,Î³(z)=f_w,Î³(z) on zâˆˆâˆ©(x_1,âˆ)Ã—^d
andÂ (<ref>) yields

    Î”_Î£ F_w,Î³(z) = Î³ F_w,1(z)^Î³-2(Ïƒ_1^2(Î³-1)+Ïƒ_2^2(1-w)  +o_(1))  as xâ†’âˆ,

where o_(1) is defined after AssumptionÂ ass:vector2. 

Since Ïƒ_1^2(Î³-1)+Ïƒ_2^2(1-w)<0, there exists x_2âˆˆ(x_1,âˆ), 
such that for 
C_1:=-(Ïƒ_1^2(Î³-1)+Ïƒ_2^2(1-w))Î³/4
we have 


    1/2Î”_Î£ F_w,Î³(z) + C_1F_w,Î³-2(z) â‰¤ 0   on  z âˆˆâˆ©(x_2,âˆ)Ã—^d.

 Thus, since the functions Î”_Î£ F_w,Î³ and Î£ are bounded on the compact set _x_2,
 there exists C_2âˆˆ
 such that 

    1/2Î”_Î£ F_w,Î³(z) + C_1F_w,Î³-2(z) â‰¤ C_21_^(x_2)(z)    for all  zâˆˆ.


 Recall the definition ofÂ Î¾ inÂ (<ref>)
 and set Îº:=F_w,1(Z). 
 Note that by definitionÂ (<ref>), there exist Î´_0>0 such that  inf_zâˆˆF_w,1(z)>Î´_0.
 For any r>max{1,Î´_0}, the stopped process (Î¾_tâˆ§Ï_r)_tâˆˆ, where the stopping time Ï_r, defined inÂ (<ref>)
 as the first time the process Îº crosses level r, satisfies 
 -C_2 t â‰¤_z[Î¾_t âˆ§Ï_r] â‰¤max{F_w,Î³(z),r^Î³} +C_1 tmax{ r^Î³-2,Î´_0^Î³-2} for all tâˆˆ. Thus _z | Î¾_tâˆ§Ï_r | <âˆ for all tâˆˆ and zâˆˆ. 
 Moreover, the inequalityÂ (<ref>) and  ItÃ´'s formulaÂ (<ref>) applied to F_w,Î³(Z) imply that, for any 0 â‰¤ s â‰¤ t<âˆ, we have Î¾_tâˆ§Ï_r-Î¾_sâˆ§Ï_r - (M_tâˆ§Ï_r - M_sâˆ§Ï_r) â‰¤ 0 a.s. Since, byÂ (<ref>) andÂ ass:covariance2,
 [M]_tâˆ§Ï_râ‰¤ C_0 t a.s.Â for all tâˆˆ and some constant C_0>0,  (Î¾_tâˆ§Ï_r)_tâˆˆ is a supermartingale for any râˆˆ. By TheoremÂ <ref> we have lim_râ†’âˆÏ_r = âˆ. Thus, Î¾_s = lim inf_râ†’âˆÎ¾_sâˆ§Ï_r for all sâˆˆ. Since Î¾_sâ‰¥ -C_2t for all sâˆˆ[0,t], the conditional Fatou lemma implies that for any 0â‰¤ s â‰¤ t <âˆ, we have 
    _z[Î¾_t |_s] = _z[lim inf_râ†’âˆÎ¾_tâˆ§Ï_r|_s] â‰¤lim inf_râ†’âˆ_z[Î¾_tâˆ§Ï_r|_s] â‰¤Î¾_s,

 in addition we deduce the integrability of Î¾_t by choosing s=0 and noting that _z[Î¾_0]= F_w,Î³(z), hence Î¾ is an (_t)-supermartingale.




 Â§.Â§ Proof of TheoremÂ <ref>


Recall the definition of the first crossing time Ï±_r (over r) inÂ (<ref>) and the return timeÂ Ï‚_r (below r) inÂ (<ref>). We start with the following claim.

Claim. For any z=(x,y)âˆˆ and r_0<x<r_1, we have _z(Ï±_r_1<Ï‚_r_0)>0.

Proof of Claim.
Consider the process started at z = (x,y) âˆˆ and satisfying r_0<x<r_1. There are two possibilities. 

(I) zâˆˆâˆ–âˆ‚.
Fix  0<h'<h<âˆ.
Let _h := {zâ€âˆˆ: âˆƒ z'âˆˆâˆ‚ such that zâ€-z'_d+1<h} and  _r_0,r_1,h := (âˆ–_h) âˆ© [r_0,r_1]Ã—^d, such that zâˆˆ_r_0,r_1,h, and 

    _r_0,r_1,hâŠ‚_r_0,r_1,h'âŠ‚_r_0,r_1,h',   _r_0,r_1,hâ€âˆ©{r_1}Ã—^d  = _r_0,r_1,h'âˆ©{r_1}Ã—^d   for some hâ€âˆˆ(h',h),

where _r_0,r_1,h' is a closed domain with C^2 boundary.
Note that the closed domain _r_0,r_1,h' can be obtained from _r_0,r_1,h' by smoothing its corners appropriately. 

A Dirichlet problem on _r_0,r_1,h' with boundary condition f: âˆ‚_r_0,r_1,h'â†’ is given by 

    1/2Î”_Î£u    = 0  on _r_0,r_1,h'âˆ–âˆ‚_r_0,r_1,h'; 
    
        u    = f,  on âˆ‚_r_0,r_1,h'.

 Choose a continuous function f: âˆ‚_r_0,r_1,h'â†’, such that f â‰¡ 1 on _r_0,r_1,hâˆ©{r_1}Ã—^d = âˆ‚_r_0,r_1,hâˆ©{r_1}Ã—^d and f â‰¡ 0 on âˆ‚_r_0,r_1,h'âˆ– (_r_0,r_1,h'âˆ©{r_1}Ã—^d ). Then, byÂ <cit.>, the function

    u(z) := _z[f(Z_Ï„)],   where Ï„:= inf{tâˆˆ:Z_tâˆˆâˆ‚_r_0,r_1,h'},

solves the Dirichlet problem in (<ref>)â€“(<ref>). Moreover, f(Z_Ï„) â‰¤1{Ï±_r_1 < Ï‚_r_0}, _z-a.s., implying u(z) â‰¤_z(Ï±_r_1 < Ï‚_r_0). Since f is continuous, _r_0,r_1,h' has a C^2 boundary and thus satisfies the inside the sphere property (seeÂ <cit.> for definition), and coefficients in (<ref>)â€“(<ref>) are continuous and uniformly elliptic by assumption ass:covariance2, the maximum principle <cit.>, applied to -u, yields u(z) > 0.

(II) zâˆˆâˆ‚.
Define the stopping time v_h := inf{t>0:Z_tâˆˆâˆ–_h}. For the process started at z âˆˆâˆ‚âˆ© (r_0,r_1)Ã—^d, the continuity of paths implies _z[Ï‚_r_0]>0. Moreover, AssumptionsÂ ass:domain2, ass:vector2 andÂ ass:covariance2 imply the conditions ofÂ <cit.>, implying that 
for some Î´_Î£>0 and all
sufficiently small h > 0, we have _z[v_h âˆ§Ï±_r_1] â‰¤ 2h^2/Î´_Î£. Hence, there exists hâˆˆ(0, (Î´_Î£_z[Ï‚_r_0]/2)^1/2) such that _z[v_h âˆ§Ï±_r_1] < _z[Ï‚_r_0]. In particular, this implies  _z(v_h âˆ§Ï±_r_1 < Ï‚_r_0) > 0. If _z({v_h âˆ§Ï±_r_1 < Ï‚_r_0}âˆ©{Ï±_r_1 <v_h} ) > 0 the proof is complete. Otherwise,  {v_h âˆ§Ï±_r_1 < Ï‚_r_0}  = 
{v_h âˆ§Ï±_r_1 < Ï‚_r_0}âˆ©{Ï±_r_1 >v_h}=
{v_h < Ï‚_r_0}, _z-a.s. Thus _z(v_h < Ï‚_r_0)=_z(v_h âˆ§Ï±_r_1 < Ï‚_r_0) > 0.
By the strong Markov property at v_h and stepÂ (I) of the proof, the claim follows. 

Proof ofÂ (a): in this case we have Î² > Î²_c. By TheoremÂ <ref> the process Z is transient.  
The Lyapunov function f_w,Î³(x,y) (with Î³<0) tends to zero  byÂ (<ref>) as xâ†’âˆ. Analogous to the proof of TheoremÂ <ref>(b), an application of LemmaÂ <ref> (and in particular
the bound inÂ (<ref>) with Îº=f_w,1(Z), V(u)=u^Î³),  implies that for every x_0âˆˆ, there exist c(x_0), such that for all zâˆˆâˆ© [x_0+c(x_0),âˆ)Ã—^d, we have _z(Ï‚_x_0 = âˆ) > 0. Moreover, the Claim implies that 
for all zâˆˆâˆ© (x_0,âˆ)Ã—^d we have 
_z(Ï±_x_0+c(x_0)<Ï‚_x_0)>0. 
The strong Markov property at the stopping time 
Ï±_x_0+c(x_0) concludes the proof of TheoremÂ <ref>(a).

Proof of (b): in this case we have Î² < Î²_c. Recall the definition of m_c inÂ (<ref>). The upper bound holds by PropositionÂ <ref>. Moreover, PropositionÂ <ref> implies that, for any pâˆˆ(m_c,âˆ), there exist constants x_0âˆˆ(0,âˆ) and c_1,c_2âˆˆ(1,âˆ), such that for all x_1âˆˆ[x_0,âˆ) and zâˆˆâˆ© (c_1(x_1+1)+c_2,âˆ)Ã—^d we have _z(Ï‚_x_1 > t) â‰¥ Ct^-p, for some constant C and all t â‰¥ 1, say. By the Claim, for any zâˆˆâˆ© (x_1,c_1(x_1+1)+c_2)Ã—^d we have _z(Ï±_c_1(x_1+1)+c_2<Ï‚_x_1)>0. Hence the strong Markov property applied at the stopping time Ï±_c_1(x_1+1)+c_2 implies  TheoremÂ <ref>(b).




Â§ FELLER CONTINUITY AND IRREDUCIBILITY OF THE REFLECTED PROCESS AND APPLICATIONS



The existence of the invariant distribution of Z requires positive recurrence (see definition preceding TheoremÂ <ref> above). The study of its moments requires certain technical results established in the present section. SectionÂ <ref> is dedicated to the proofs of Feller continuity and irreducibility of the process Z. In SectionÂ <ref> we apply these two properties to prove that the reflected process Z
is Harris recurrent with an irreducible skeleton chain and that the set âˆ© [0,r]Ã—^d is petite for any r âˆˆ(0,âˆ).
Moreover, in SectionÂ <ref> we will also show that every petite set for Z is bounded. 



 Â§.Â§ Feller continuity and irreducibility of the reflected process


In this section we prove
that the reflected process Z is Feller-continuous (see TheoremÂ <ref> below) and that 
the (d+1)-dimensional Lebesgue measure 
_d+1
on 
the Borel Ïƒ-algebra () on 
is absolutely continuous with respect to 
its marginals of the reflected process at positive times (PropositionÂ <ref> below).
We start with the latter.






LetÂ ass:domain2, ass:covariance2, ass:vector2 hold. Then, for any zâˆˆ and tâˆˆ(0,âˆ) and any Aâˆˆ(), such that 
_d+1(A)>0, we have _z(Z_t âˆˆ A)>0. 



The proofs of PropositionÂ <ref> and TheoremÂ <ref> below require the following lemma.
For small h>0, define a â€œthinâ€ neighborhood of âˆ‚ in  by _h := {zâˆˆ: âˆƒ z'âˆˆâˆ‚ such that z-z'_d+1<h}.



LetÂ ass:domain1, ass:covariance1, ass:vector1 hold.
Then there exists a functions G:â†’, twice-differentiable on a neighbourhood of âŠ‚^d+1 
and strictly positive on the open set âˆ–âˆ‚. Moreover, the function g(z) := G(z)^2 satisfies âˆ‡ g(z) = 0  for all zâˆˆâˆ‚ and for any r>0 there exist h_r>0, Î´ > 0,  such that the following hold


  (a) 
Î£^1/2(z)âˆ‡ G(z)_d+1^2> Î´  for all zâˆˆ_h_râˆ©[0,r]Ã—^d;

  (b)
âŸ¨Ï•(z),âˆ‡ G(z)âŸ© >  Î´ for all zâˆˆâˆ‚âˆ©[0,r]Ã—^d.




Recall that AssumptionsÂ ass:domain2, ass:covariance2, ass:vector2 imply AssumptionsÂ ass:domain1, ass:covariance1, ass:vector1.



Extend the function 
G:â†’, defined by G(z):=b(x)^2-y_d^2
for any z=(x,y)âˆˆ, to a 
C^2-function on a neighbourhood of  in ^d+1.  Hence 
âˆ‡ G(z)_d+1^2=4(b(x)^2b'(x)^2+y_d^2)
for all z=(x,y)âˆˆ and âˆ‡ g(z) = 2G(z)âˆ‡ G(z) = 0 for all zâˆˆâˆ‚, since G(z) = 0 onÂ âˆ‚. 
Recall thatÂ ass:domain1 yields lim inf_xâ†’0b(x)b'(x)>0. Thus, for any r>0, there exists a sufficiently small h_r>0, such that 0<inf_zâˆˆ_h_râˆ©[0,r]Ã—^dâˆ‡ G(z)_d+1^2=:Î´_h_r
(we restrict to xâˆˆ[0,r] because of functions b with Î²â‰¤ 0, e.g. example in LemmaÂ <ref>).
Moreover, byÂ ass:covariance1, there exists Î´_Î£>0
such that 
Î£^1/2(z)âˆ‡ G(z)_d+1^2=âŸ¨Î£(z)âˆ‡ G(z),âˆ‡ G(z)âŸ©â‰¥Î´_Î£âˆ‡ G(z)_d+1^2â‰¥Î´_Î£Â·Î´_h_r>0
for all zâˆˆ_h_râˆ©[0,r]Ã—^d, implyingÂ (a).

Note that gradient âˆ‡ G(z) for any zâˆˆâˆ‚ equals 
n(z)âˆ‡ G(z)_d+1, where n(z) is the inwards-pointing unit normal vector to âˆ‚ at z. Hence, byÂ ass:vector1, there exists a Î´_Ï•>0 such that âŸ¨Ï•(z),âˆ‡ G(z)âŸ©â‰¥Î´_h_r^1/2âŸ¨Ï•(z), n(z)âŸ© > Î´_Ï•Â·Î´_h_r^1/2>0 for all zâˆˆâˆ‚âˆ© [0,r]Ã—^d.




We start by proving that Z spends no time at the boundary. 

Claim 0. The equality âˆ«_0^âˆZ_tâˆˆâˆ‚ t=0 
holds _z-a.s. 
for any starting point zâˆˆ.

Proof of Claim 0. Let G be a function whose existence is guaranteed by LemmaÂ <ref>. Define the non-negative continuous semimartingale Î¾=(Î¾_t)_tâˆˆ, 
Î¾_t:=G(Z_t), denote its local time field by (L_t^u(Î¾))_t,uâˆˆ
(seeÂ <cit.> for definition and properties)
and note that Î¾_t=0
if and only if Z_tâˆˆâˆ‚, since G>0 on âˆ–âˆ‚ by  LemmaÂ <ref>.
Thus the local-time process L in SDEÂ (<ref>) satisfies
L^0(Î¾)=L.  
ItÃ´'s formula inÂ (<ref>), applied to G(Z),
yields that the quadratic variation [Î¾] equals  [M] given inÂ (<ref>). 
Pick any t,râˆˆ(0,âˆ).
The occupation times formula inÂ <cit.> applied to the indicator  uâ†¦_{0}(u) of zero,
the representation of the quadratic variation [M] inÂ (<ref>),
the property in LemmaÂ <ref>(a)
and the fact that Î¾_s=0
is equivalent to 
 Z_sâˆˆâˆ‚ for all sâˆˆ
yield

    0=âˆ«__{0}(u)L_tâˆ§Ï±_r^u(Î¾) u = âˆ«_0^tâˆ§Ï±_r_{0}(Î¾_s) [M]_sâ‰¥Î´âˆ«_0^tâˆ§Ï±_rZ_sâˆˆâˆ‚ sâ‰¥0,

implying 0=âˆ«_0^tâˆ§Ï±_rZ_sâˆˆâˆ‚ s. 
Since Ï±_r, given inÂ (<ref>), satisfies lim_râ†’âˆÏ±_r=âˆ a.s. (by TheoremÂ <ref>)
and t>0 is arbitrary, our claim follows.

Fubini's theorem and Claim 0 yield 
âˆ«_0^âˆ_z(Z_tâˆˆâˆ‚) t=_zâˆ«_0^âˆZ_tâˆˆâˆ‚ t=0
for any zâˆˆ
(since Z is continuous, it is progressively measurable, implying the  various integrals are well defined and measurable).
In particular, denoting := âˆ–âˆ‚, for any zâˆˆ and t>0, it holds that âˆ«_0^t _z(Z_sâˆˆ) s = t.



Claim 1. For every zâˆˆ, t>0 and Aâˆˆ() the following holds: if _d+1(A) > 0 then âˆ«_0^t _z(Z_sâˆˆ A) s > 0.

In order to prove Claim 1, we need Claims 2 and 3 below. For zâˆˆ and h>0, define the open ball in  by B(z,h) := { z'âˆˆ: z-z'_d+1 < h}.

Claim 2. Pick any zâˆˆ, sâˆˆ and any ball B(z',h)âŠ‚ 
and
Aâˆˆ().
The inequalities 
_z(Z_sâˆˆ B(z',h))>0 and 
_d+1(B(z',h)âˆ© A)>0
imply
_z(Z_vâˆˆ B(z',h)âˆ© A) >0
for all vâˆˆ(s,s+h^2).



Proof of Claim 2. Since B(z',h)âŠ‚,
the stopping time Ï„_âˆ‚ B(z',h):=inf{tâˆˆ: Z_tâˆ‰ B(z',h)}
is strictly positive _zâ€-a.s. for all 
zâ€âˆˆ B(z',h).
Moreover, the process Z on the stochastic interval [0,Ï„_âˆ‚ B(z',h)), started at any zâ€âˆˆ B(z',h), coincides with a uniformly elliptic diffusion on ^d+1, stopped upon exiting the ball B(z',h).
Thus,Â <cit.> is applicable and, together with the strong Markov property of ZÂ <cit.>, yields the claim.

Claim 3.
For any zâˆˆ, t>0 and A_0âˆˆ(), such that _d+1(A_0)>0,
there exist  z_0âˆˆ, h_0>0
and sâˆˆ(0,t) satisfying
B(z_0,h_0)âŠ‚,  _d+1(A_0 âˆ© B(z_0,h_0)) > 0 and _z(Z_s âˆˆ B(z_0,h_0)) > 0.

 

Proof of Claim 3. Since âˆ«_0^t _z(Z_s âˆˆ)  s = t, there exist s < t, z'âˆˆ and h>0, such that B(z',h)âŠ‚ and  _z(Z_sâˆˆ B(z',h)) > 0.
Moreover, the assumption _d+1(A_0) > 0 implies that there exists a ball B(z_0,h_0) âŠ‚ such that _d+1(B(z_0,h_0) âˆ© A_0) > 0.

It remains to prove that for some sâˆˆ(0,t) we have _z(Z_s âˆˆ B(z_0,h_0)) > 0.
If B(z_0,h_0)âˆ© B(z',h)â‰ âˆ…, then, since
_d+1(B(z_0,h_0) âˆ© B(z',h))>0,
by ClaimÂ 2 applied with 
A:=B(z_0,h_0)
and 
_z(Z_sâˆˆ B(z',h))>0,
there exist vâˆˆ(s,t)
with
_z(Z_vâˆˆ B(z_0,h_0))>0.
If B(z_0,h_0)âˆ© B(z',h)=âˆ…,
then there exists a  sequence of nâˆˆ balls
B(z_i,h_i)âŠ‚, where  iâˆˆ{1,â€¦,n},
 such that z_n=z_0, h_n=h_0 and 
z_1=z', h_1=h  and B(z_i,h_i)âˆ© B(z_i+1,h_i+1)â‰ âˆ… for all iâˆˆ{1,â€¦,n-1}.
Since 
_z(Z_sâˆˆ B(z_1,h_1))>0,
byÂ Claim 2 (applied with A:=B(z_2,h_2)),
there exists time v_1âˆˆ(s,t), such that 
_z(Z_v_1âˆˆ B(z_2,h_2))>0.
The Markov property at v_1 andÂ Claim 2
imply the existence of v_2âˆˆ(v_1,t)
such that 
_z(Z_v_2âˆˆ B(z_3,h_3))>0.
Construct inductively the increasing sequence v_1,v_2,â€¦,v_n-1âˆˆ(0,t), set s:=v_n-1
and note _z(Z_v_n-1âˆˆ B(z_n,h_n))>0, implying  Claim 3.

Proof of Claim 1. Assume that ClaimÂ 1 does not hold. More precisely, there exist t>0, zâˆˆ and A_0 âˆˆ(), such that _d+1(A_0)>0 and âˆ«_0^t _z(Z_vâˆˆ A_0) v = 0.




By ClaimÂ 3 there exist a ball B(z_0,h_0) in  and sâˆˆ(0,t) such that 
_d+1(A_0 âˆ© B(z_0,h_0)) > 0 and _z(Z_s âˆˆ B(z_0,h_0)) > 0.
Claim 2 (applied with z':=z_0, h:=h_0 and A:=A_0) yields the contradiction:
0=âˆ«_0^t_z(Z_vâˆˆ A_0) v â‰¥âˆ«_s^t âˆ§ (s+h_0^2)_z(Z_vâˆˆ B(z_0,h_0)âˆ© A_0)  v>0.





To conclude the proof of the proposition, we strengthen Claim 1. 
Suppose there exist zâˆˆ, t>0 and Aâˆˆ() with _d+1(A)>0, such that _z(Z_tâˆˆ A)=0. Since there exists a ball B(z',h)âˆˆ(), such that _d+1(A âˆ© B(z',h)) > 0, 
by ClaimÂ 1 applied to A âˆ© B(z',h) we have
 âˆ«_0^h^2_z(Z_v âˆˆ A âˆ© B(z',h)) v > 0
for all zâˆˆ.
We may assume h^2âˆˆ(0,t).
Since  Z is Markov, we have
âˆ«_t-h^2^t _z(Z_s âˆˆ A âˆ© B(z',h)) s > 0
and hence _z(Z_s âˆˆ A âˆ© B(z',h)) > 0
for some sâˆˆ(t-h^2,t). Thus tâˆˆ(s, s+h^2).
ByÂ Claim 2
we get 

_z(Z_tâˆˆ A) â‰¥_z(Z_t âˆˆ A âˆ© B(z',h))>0, completing the proof of the proposition.



    
    By ClaimÂ 0 in the proof of PropositionÂ <ref>  above, for any zâˆˆ, the equality _z(Z_tâˆˆâˆ‚)=0
    holds for Lebesgue almost every tâˆˆ. 
    Note also that the proof of ClaimÂ 0
    uses only the occupation times formula for continuous semimartingales and basic properties of the solution of SDEÂ (<ref>). 


Domain , defined inÂ (<ref>), with increasing boundary (e.g. Î²>0, seeÂ (<ref>) for definition) satisfies the conditions ofÂ <cit.>, which establishes Feller continuity for reflecting processes Z. However, as explained inÂ <cit.>, 
the assumptions ofÂ <cit.> are not satisfied if the boundary function b decreases to zero (e.g. Î²<0). In the case Î²=0, the domain , may but need not, satisfy the assumptions ofÂ <cit.>, see example in LemmaÂ <ref> below.
Since the case Î²<0 is when positive recurrence occurs, we develop a new approach to Feller continuity of Z, relying on the localisation of the process. This is  more involved than the standard approach in the literature (see e.g.Â <cit.>)
due to the difficulty of obtaining a global bound on the growth of the local time in the case 
Î²<0, which requires localisation.



LetÂ ass:domain2, ass:covariance2, ass:vector2 hold. For a
continuous bounded function f:â†’,
tâˆˆ,
and a convergent sequence (z_n)_nâˆˆ in  with limit lim_nâ†’âˆz_n= z_âˆâˆˆ, we have 

    _z_n[f(Z_t)] â†’_z_âˆ[f(Z_t)]  as nâ†’âˆ.



The proof of TheoremÂ <ref>
requires LemmasÂ <ref>
andÂ <ref>. LemmaÂ <ref> provides growth estimates required for the proof of tightness via the Aldus's criterionÂ <cit.>.



LetÂ ass:domain2, ass:covariance2, ass:vector2 hold.
Fix any r>0, T>0 and Î¸âˆˆ(0,T]. Then there exist positive constants C_i, for iâˆˆ{1,2,3,4},
such that for any zâˆˆ and (_t)-stopping times S_1,S_2  ((_t)_tâˆˆ is the Brownian filtration  inÂ (<ref>)), satisfying S_1â‰¤ S_2â‰¤ S_1+Î¸â‰¤ T,
for any >0 the following hold:


  (a)_z(L_S_2âˆ§Ï±_r-L_S_1âˆ§Ï±_râ‰¥) â‰¤  (C_1 Î¸ + C_2Î¸^1/2)/; 

  (b)_z(Z_S_2âˆ§Ï±_r - Z_S_1âˆ§Ï±_r_d+1^2â‰¥) â‰¤ (C_3Î¸+ C_4Î¸^1/2)/.
   
Moreover, _z[L_T âˆ§Ï±_r]<âˆ holds.



Let G be the function whose existence is guaranteed by LemmaÂ <ref> and let g(z) := G(z)^2,  zâˆˆ. Since the first and second derivatives of functions G and g are continuous on , and Î£ is bounded byÂ ass:covariance2, it follows that Î£^1/2âˆ‡ G_d+1^2, Î£^1/2âˆ‡ g_d+1^2, |Î”_Î£ G| and  |Î”_Î£ g|  are bounded on ^(r)= âˆ© [0,r]Ã—^d for any r>0.

Pick r>0,  T>0 and Î¸âˆˆ (0,T]. Recall from LemmaÂ <ref> that âˆ‡ g(z) = 0 and âŸ¨Ï•(z),âˆ‡ G(z)âŸ© >  Î´_r for all zâˆˆâˆ‚âˆ©[0,r]Ã—^d and some positive constant Î´_r.
Let the bounded stopping times S_1,S_2 be as in the statement of the lemma.
ItÃ´'s formulaÂ (<ref>) applied to the processes g(Z) and G(Z) on the stochastic interval [S_1âˆ§Ï±_r,S_2âˆ§Ï±_r]
(recall the definition of Ï±_r inÂ (<ref>))
yields 

    g(Z_S_2 âˆ§Ï±_r) = g(Z_S_1 âˆ§Ï±_r) + M_S_2âˆ§Ï±_r^g-M_S_1âˆ§Ï±_r^g + 1/2âˆ«_S_1âˆ§Ï±_r^S_2âˆ§Ï±_rÎ”_Î£ g(Z_u) u,    _z-a.s.,

and 

    Î´_r (L_S_2 âˆ§Ï±_r-L_S_1âˆ§Ï±_r)â‰¤  G(Z_S_2âˆ§Ï±_r) - G(Z_S_1âˆ§Ï±_r) - M_S_2 âˆ§Ï±_r^G+ M_S_1 âˆ§Ï±_r^G - 1/2âˆ«_S_1âˆ§Ï±_r^S_2âˆ§Ï±_rÎ”_Î£ G(Z_u) u,Â _z-a.s.

 for any zâˆˆ.
 
 
 Note that (M^g_tâˆ§Ï±_r)_tâˆˆ and (M^G_tâˆ§Ï±_r)_tâˆˆ are true martingales byÂ (<ref>). The
optional sampling theorem 
at the bounded stopping time S_2âˆ§Ï±_r
yields _z[M_S_2âˆ§Ï±_r^g-M_S_1âˆ§Ï±_r^g|_S_1âˆ§Ï±_r]=0, _z-a.s. and _z[M_S_2âˆ§Ï±_r^G-M_S_1âˆ§Ï±_r^G|_S_1âˆ§Ï±_r]=0, _z-a.s.
There exists a constant C_1>0 such that |Î”_Î£ g(z)|â‰¤ 2C_1 for all zâˆˆ^(r), which implies that

    _z[g(Z_S_2âˆ§Ï±_r) |_S_1âˆ§Ï±_r] â‰¤  g(Z_S_1âˆ§Ï±_r) + C_1Î¸,  _z-a.s.

holds for any zâˆˆ. Moreover, there exists a constant C_2 such that |Î”_Î£ G(z)|â‰¤ 2C_2 for zâˆˆ^(r).
Using the fact that g(z) = G(z)^2, and applying the optional sampling theorem at the bounded stopping time S_2âˆ§Ï±_r implies 

    Î´_r _z[L_S_2 âˆ§Ï±_r - L_S_1 âˆ§Ï±_r]    â‰¤_z[_z[G(Z_S_2 âˆ§Ï±_r)|_S_1 âˆ§Ï±_r] - G(Z_S_1 âˆ§Ï±_r)+ C_2 (S_2-S_1)] 
       â‰¤_z[_z[g(Z_S_2 âˆ§Ï±_r)|_S_1 âˆ§Ï±_r]^1/2 - G(Z_S_1 âˆ§Ï±_r)+ C_2 Î¸] 
       â‰¤_z[(C_1 Î¸ + g(Z_S_1 âˆ§Ï±_r))^1/2 - G(Z_S_1 âˆ§Ï±_r) + C_2 Î¸] 
       â‰¤ (C_1 Î¸)^1/2 + C_2 Î¸,

 where we used the Cauchy-Schwarz inequality, the inequality inÂ (<ref>) and the triangle inequality in the 
 second, third and fourth inequalities in the display above, respectively. Application of Markov inequality toÂ (<ref>) implies  (a). Moreover, since  L_0 = 0, setting S_1 = 0, S_2 = T, Î¸ = T inÂ (<ref>), we get _z[L_T âˆ§Ï±_r]<âˆ, as claimed.

To prove (b), define the function V_z_0:â†’ by V_z_0(z) := z-z_0_d+1^2 for a parameter z_0âˆˆ. Pick r>0, T>0 and Î¸âˆˆ(0,T]. 
Since first and second derivatives of V_z_0(z) are continuous on  in both variable z and parameter z_0, it follows by ass:vector2 and ass:covariance2 that there exist constants CÌƒ_1,CÌƒ_2,CÌƒ_3 such that  sup_z_0âˆˆ^(r)âŸ¨âˆ‡ V_z_0(z),Ï•(z)âŸ©â‰¤CÌƒ_1, sup_z_0âˆˆ^(r)|Î”_Î£ V_z_0(z)|â‰¤ 2CÌƒ_2, and sup_z_0âˆˆ^(r)Î£(z)^1/2âˆ‡ V_z_0(z)_d+1^2â‰¤CÌƒ_3 hold for every zâˆˆ^(r).
ItÃ´'s formulaÂ (<ref>) applied to V_z_0(Z), with Z started at z_0, gives

    V_z_0(Z_Sâˆ§Ï±_r) =  M_Sâˆ§Ï±_r^V_z_0 + âˆ«_0^Sâˆ§Ï±_râŸ¨âˆ‡ V_z_0(Z_u),Ï•(Z_u)âŸ© L_u + 1/2âˆ«_0^Sâˆ§Ï±_rÎ”_Î£ V_z_0(Z_u) u,  _z_0-a.s.,

for any stopping time S and any z_0âˆˆ.
Moreover, byÂ (<ref>) the process (M^V_z_0_tâˆ§Ï±_r)_tâˆˆ is a true martingale.  ByÂ (<ref>), for S  satisfying Sâ‰¤Î¸,  we have sup_z_0âˆˆ^(r)_z_0[L_Sâˆ§Ï±_r]â‰¤(C_1 Î¸)^1/2 + C_2 Î¸. Hence, the optional sampling theorem at the bounded stopping time Sâˆ§Ï±_r yields

    _z_0[Z_Sâˆ§Ï±_r-Z_0_d+1^2] = _z_0[V_z_0(Z_Sâˆ§Ï±_r)] â‰¤CÌƒ_1 _z_0[L_Sâˆ§Ï±_r] + CÌƒ_2 Î¸â‰¤CÌƒ_1((C_1Î¸)^1/2+C_2Î¸)+CÌƒ_2 Î¸,

for any Sâ‰¤Î¸ and z_0âˆˆ^(r), where C_1,C_2 come from part (a) of this lemma.  
It follows from the strong Markov property that for any stopping times S_1,S_2 satisfying assumptions of the lemma, and any z_0âˆˆ we have

    _z_0[Z_S_2âˆ§Ï±_r-Z_S_1âˆ§Ï±_r_d+1^2] =_z_0[_z_0[Z_S_2âˆ§Ï±_r-Z_S_1âˆ§Ï±_r_d+1^2|_S_1âˆ§Ï±_r]] â‰¤CÌƒ_1((C_1Î¸)^1/2+C_2Î¸)+CÌƒ_2 Î¸.

Application of Markov inequality gives part (b) of the lemma.


   
LetÂ ass:domain2, ass:covariance2, ass:vector2 hold. 
Suppose that for any t>0, any continuous bounded function f:â†’, and a convergent sequence z_nâ†’ z_âˆâˆˆ (as nâ†’âˆ), there exists a sequence (r_k)_kâˆˆ satisfying lim_kâ†’âˆr_k = âˆ, such that for every kâˆˆ the following holds:

    _z_n[f(Z_tâˆ§Ï±_r_k)]â†’_z_âˆ[f(Z_tâˆ§Ï±_r_k)]  
      as nâ†’âˆ.

Then the process Z is Feller continuous, that is, _z_n[f(Z_t)] â†’_z_âˆ[f(Z_t)] as nâ†’âˆ.



Fix t>0. For any r>0, define the events _r := {Ï±_râ‰¤ t} (and their complements  _r^c). 

Claim. For any convergent sequence  z_n â†’ z_âˆâˆˆ and  >0, there exists r_0>0 such that for all râˆˆ[r_0,âˆ) we have sup_nâˆˆ_z_n(_r)â‰¤ and _z_âˆ(_r)â‰¤.

Proof of claim. Pick wâˆˆ (-âˆ,1-Î² s_0/c_0). LemmaÂ <ref> guarantees the existence of constants k,x_0,x_1âˆˆ in the definition of the function F_w,1 such that âŸ¨âˆ‡ F_w,1(z),Ï•(z)âŸ©â‰¤0 for all zâˆˆâˆ‚. ByÂ (<ref>), we have F_w,1(z)=f_w,1(z) for all z=(x,y)âˆˆâˆ© [x_1,âˆ)Ã—^d. Since F_w,1 is smooth on a neighbourhood of , byÂ (<ref>) andÂ (<ref>) in  LemmaÂ <ref>,
the functions zâ†¦|Î”_Î£ F_w,1(z)| and zâ†¦Î£(z)^1/2âˆ‡ F_w,1(z)_d+1^2 are bounded on . Hence,
there exist constants 
CÌƒ_1,CÌƒ_2âˆˆ(0,âˆ) satisfying |Î”_Î£ F_w,1(z)|â‰¤ 2CÌƒ_1 and Î£(z)^1/2âˆ‡ F_w,1(z)_d+1^2â‰¤CÌƒ_2 for all zâˆˆ. 
Define the process Îº := 2^1/| w|F_w,1(Z),  and recall the definition of Ï_r inÂ (<ref>). Since F_w,1(z) = f_w,1(z) for zâˆˆâˆ© [x_1,âˆ)Ã—^d,Â (<ref>) implies that for râˆˆ[x_1,âˆ) we have Ï_râ‰¤Ï±_r.
Moreover, application of ItÃ´'s formulaÂ (<ref>) implies that the process
Îº_tâˆ§Ï_r - C(tâˆ§Ï_r)
is a supermartingale for C=2^1/|w|CÌƒ_1, and any r>0, where the local martingale appearing in ItÃ´'s formula is a true martingale byÂ (<ref>). Thus, applying PropositionÂ <ref> (with Î¾=Îº and a constant function fâ‰¡ C) we infer that for any râ‰¥ x_1 and any zâˆˆ,

    _z(_r)â‰¤_z(Ï_r â‰¤ t) â‰¤ r^-1(2^1/|w|F_w,1(z) 
    + C t).

Since (2^1/|w|sup_nâˆˆF_w,1(z_n)+Ct) is finite by the continuity of F_w,1, there exists r_0 as claimed.

To prove the lemma, pick an arbitrary continuous bounded function f:â†’, >0, and a convergent sequence z_nâ†’ z_âˆ.  Let  the sequence (r_k)_kâˆˆ tend to infinity and satisfyÂ (<ref>) for every kâˆˆ.
 Since f is bounded, the Claim above implies that there exists kâˆˆ such that sup_zâˆˆ| f(z)|(_z_n(_r_k)+_z_âˆ(_r_k))</3 holds for every nâˆˆ. 
Thus, as f(Z_t)=f(Z_tâˆ§Ï±_r_k)1(_r_k^c)+f(Z_t)1(_r_k), for every nâˆˆ we get

    |_z_n[f(Z_t)]-_z_âˆ[f(Z_t)]|   â‰¤|_z_n[f(Z_tâˆ§Ï±_r_k)1(_r_k^c)]-_z_âˆ[f(Z_tâˆ§Ï±_r_k)1(_r_k^c)]| +
    /3.

Next, byÂ (<ref>), for all large nâˆˆ we have |_z_n[f(Z_tâˆ§Ï±_r_k)] - _z_âˆ[f(Z_tâˆ§Ï±_r_k)]| </3. 
 Since
 f(Z_tâˆ§Ï±_r_k)1(_r_k^c)=f(Z_tâˆ§Ï±_r_k)-f(Z_tâˆ§Ï±_r_k)1(_r_k),
 the triangle inequality yields 

    |_z_n[f(Z_tâˆ§Ï±_r_k)1(_r_k^c)   ]-_z_âˆ[f(Z_tâˆ§Ï±_r_k)1(_r_k^c)]|
    â‰¤|_z_n[f(Z_tâˆ§Ï±_r_k)]    - _z_âˆ[f(Z_tâˆ§Ï±_r_k)] | + sup_zâˆˆ| f(z)|(_z_n(_r_k)+_z_âˆ(_r_k)) â‰¤ 2/3,

which, together withÂ (<ref>),
implies |_z_n[f(Z_t)]-_z_âˆ[f(Z_t)]|<
for all large nâˆˆ.









 
By LemmaÂ <ref>, it suffices to prove that for any f:â†’,
Tâˆˆ and a convergent sequence z_nâ†’ z_âˆâˆˆ (as nâ†’âˆ), there exists a sequence (r_k)_kâˆˆ tending to infinity, such that for any kâˆˆ we have

    _z_n[f(Z_Tâˆ§Ï±_r_k)] â†’_z_âˆ[f(Z_Tâˆ§Ï±_r_k)]
    
      as nâ†’âˆ.

The first step is to prove that, for a fixed r>0, the laws of
(Z_Â·âˆ§Ï±_r,L_Â·âˆ§Ï±_r,W_Â·) under _z_n are tight. 

The second step consists of proving that 
every subsequence converges to the law of 
(Z_Â·âˆ§Ï±_r,L_Â·âˆ§Ï±_r,W_Â·) 
under _z_âˆ.



Let E^(1) :=E_1Ã— E_2Ã— E_3, where E_1:=, E_2:= and E_3:=^d+1, and denote by D_E^(1)([0,âˆ))  the space of cÃ dlÃ g  functions (i.e.Â right-continuous functions with left limits), mapping the interval [0,âˆ) into the metric space E^(1). Denote by C_E^(1)([0,âˆ)) âŠ‚ D_E^(1)([0,âˆ)) the subspace of continuous functions. Endow D_E^(1)([0,âˆ)) with the Skorohod topology and its Borel Ïƒ-algebra ^1, see e.g.Â <cit.> for details. Any function Ï‰âˆˆ D_E^(1)([0,âˆ))
can be expressed as Ï‰ = (a^(1),a^(2),a^(3)), for some â€œcoordinateâ€ cÃ dlÃ g functions a^(i): [0,âˆ)â†’ E_i for i=1,2,3.
For any tâˆˆ[0,âˆ), define maps A^(i)_t:D_E^(1)([0,âˆ))â†’ E_i
by
A^(i)_t(Ï‰):=a^(i)(t), iâˆˆ{1,2,3}. 


Define a Ïƒ-algebra 
_t^1 := Ïƒ{A^(i)_s:0â‰¤ sâ‰¤ t, iâˆˆ{1,2,3}}âŠ‚^1 generated by  continuous maps A^(i)_s.
ByÂ <cit.> we have _âˆ^1=^1.






For any zâˆˆ, 
byÂ <cit.>, there exists a filtered probability space (Î©,(_t)_tâˆˆ,,_z),

supporting the  processes (Z,L,W), taking values in E^(1)
such that, under _z,
the SDE inÂ (<ref>) holds and 
W is a standard (_t)-Brownian motion.
We may assume that the filtration (_t)_tâˆˆ is complete (i.e.Â _0
contains all _z-null sets of ) and right continuous (i.e.Â _t = âˆ©_t<s_s).


Pick arbitrary r_0âˆˆ and T>0, and recall the stopping time 
Ï±_r_0, defined inÂ (<ref>), is the first time the coordinate X
of Z=(X,Y)
reaches level r_0.
The stopped process   
(Z_t âˆ§Ï±_r_0âˆ§ T,L_t âˆ§Ï±_r_0âˆ§ T,W_tâˆ§ T)_tâˆˆ
produces a measurable map 
(Z_Â·âˆ§Ï±_r_0âˆ§ T,L_Â·âˆ§Ï±_r_0âˆ§ T,W_Â·âˆ§ T):(Î©,)â†’(D_E^(1)([0,âˆ)),^1) 
and induces the probability measure Q_z^1(Â·):=_z((Z,L,W)âˆˆÂ·) on ^1.

Moreover, using the notation 















Z^(z)_t(Ï‰):=A^(1)_t(Ï‰) = (A_t^(1,X)(Ï‰),A_t^(1,Y)(Ï‰))âˆˆÃ—^d,
L^(z)_t(Ï‰):=A^(2)_t(Ï‰),
W^(z)_t(Ï‰):=A^(3)_t(Ï‰),
Ï±^(z)_r := inf{t>0:A_t^(1,X)â‰¥ r} for any râˆˆ(0,âˆ), Ï‰âˆˆ D_E([0,âˆ))
and tâˆˆ[0,âˆ),
the following holds for any râˆˆ(0,âˆ) and tâˆˆ[0,T]:

    
  (a)  Z^(z)_tâˆ§Ï±_r^(z) = z + âˆ«_0^tâˆ§Ï±_r^(z)Î£^1/2(Z^(z)_s) W^(z)_s + âˆ«_0^tâˆ§Ï±_r^(z)Ï•(Z^(z)_s)  L^(z)_s, Q_z-a.s.
    
  (b) L^(z)_tâˆ§Ï±_r^(z) = âˆ«_0^tâˆ§Ï±_r^(z)Z^(z)_sâˆˆâˆ‚ L^(z)_s, Q_z-a.s.
    
  (c) Under Q_z, the process W^(z) is an (_t)-Brownian motion stopped at time T.








Moreover, it is easy to see that the equality in (b) above is equivalent to âˆ«_0^tâˆ§Ï±_r^(z) (b(X^(z)_s)^2 - Y^(z)_s_d^2)  L^(z)_s = 0, Q_z-a.s.
Indeed, since b(x)^2-y_d^2=0 for all (x,y)âˆˆâˆ‚, (b) implies 
âˆ«_0^tâˆ§Ï±_r^(z) (b(X^(z)_s)^2 - Y^(z)_s_d^2)  L^(z)_s =
âˆ«_0^tâˆ§Ï±_r^(z) (b(X^(z)_s)^2 - Y^(z)_s_d^2) Z^(z)_sâˆˆâˆ‚ L^(z)_s=
0.
Conversely, since b(x)^2-y_d^2>0 for all (x,y)âˆˆâˆ–âˆ‚, the sets _n:={(x,y)âˆˆ:b(x)-y_dâˆˆ[1/n+1,1/n)}
are pairwise disjoint and satisfy âˆª_nâˆˆ_n=âˆ–âˆ‚
and 0â‰¤âˆ«_0^tâˆ§Ï±_r^(z)Z^(z)_sâˆˆ_n L^(z)_sâ‰¤ (n+1)âˆ«_0^T (b(X^(z)_s)^2 - Y^(z)_s_d^2) Z^(z)_sâˆˆ_n L^(z)_s=0. Note 
L^(z)_tâˆ§Ï±_r^(z) = âˆ«_0^tâˆ§Ï±_r^(z)Z^(z)_sâˆˆâˆ‚ L^(z)_s +âˆ‘_nâˆˆâˆ«_0^tâˆ§Ï±_r^(z)Z^(z)_sâˆˆ_n L^(z)_s
=âˆ«_0^tâˆ§Ï±_r^(z)Z^(z)_sâˆˆâˆ‚ L^(z)_s.

We will show that if z_nâ†’ z_âˆ, for all but countably many râˆˆ(0,r_0), the limiting point of laws of the processes (Z_tâˆ§Ï±_r^(z_n)^(z_n))_nâˆˆ coincides with the law of Z_tâˆ§Ï±_r^(z_âˆ)^(z_âˆ).


Denote by (D_E^(1)([0,âˆ)),^1) the space of probability measures on the measurable space (D_E^(1)([0,âˆ)),^1) and endow it with the topology of weak convergenceÂ (see <cit.> for details). We say that the sequence of measures (Q_n)_nâˆˆâˆˆ(D_E^(1)[0,âˆ),^1) is C-tight, if every subsequence of (Q_n)_nâˆˆ has a convergent subsequence and the limiting probability measure Q_* charges only the set C_E^(1)([0,âˆ)), i.e.Â Q_*(C_E^(1)[0,âˆ)) = 1. 


Recall that the measures Q_z^1, for zâˆˆ, are defined by the laws of the stopped processes (Z_Â·âˆ§Ï±_râˆ§ T,L_Â·âˆ§Ï±_râˆ§ T,W_Â·âˆ§ T) under the measure _z.
LemmaÂ <ref>, and the fact that W is a Brownian motion, imply that for any Î¸>0 there exist positive constants C_1,C_2 such that for any stopping times S_1,S_2âˆˆ_T satisfying S_1â‰¤ S_2â‰¤ S_1+Î¸â‰¤ T,
for any nâˆˆ we have 

    _z_n( (Z_S_2âˆ§Ï±_r_0,L_S_2 âˆ§Ï±_r_0,W_S_2)-(Z_S_1âˆ§Ï±_r_0,L_S_1 âˆ§Ï±_r_0,W_S_1)_2d+3^2 â‰¥) â‰¤ (C_1 Î¸ + C_2Î¸^1/2)/.
 
There exists a positive constant C>0, such that  sup_tâˆˆ_+Z_tâˆ§Ï±_r_0_d+1â‰¤  C _z_n-a.s. for all nâˆˆ.  Since LemmaÂ <ref> bounds the expected growth of the local time L, for any >0, there exists K>0, such that for all nâˆˆ we have _z_n(sup_0â‰¤ sâ‰¤ T(Z_s âˆ§Ï±_r_0,L_sâˆ§Ï±_r_0,W_s)_2d+3â‰¥ K)â‰¤. Thus we may apply Aldous's tightness criterionÂ <cit.> to deduce that the sequence of measures  (Q_z_n^1)_nâˆˆ is tight. Moreover, since Q_z_n^1(C[0,âˆ)) = 1 for every nâˆˆ,Â <cit.> implies that the sequence (Q_z_n^1)_nâˆˆ is C-tight.
It follows that there exists a subsequence 

(Q_z_n_k^1)_kâˆˆ that converges weakly to a probability measure  Q_*^1, satisfying Q_*^1(C[0,âˆ)) = 1. For notational convenience we assume that the sequence (Q_z_n^1)_nâˆˆ itself converges to Q_*^1. 

Our aim is to prove that (A^(1),A^(2),A^(3)), under the measure Q_*^1, solves SDEÂ (<ref>). 

Consider the process :=_Â·âˆ§ T, where 

    :=(Z_Â·âˆ§Ï±_r_0,L_Â·âˆ§Ï±_r_0,W_Â·,âˆ«_0^Â·Î£^1/2(Z_u) W_u,âˆ«_0^Â·âˆ§Ï±_r_0Ï•(Z_u) L_u,âˆ«_0^Â·âˆ§Ï±_r_0(b(X_u)^2 - Y_u_d^2) L_u).
 
The state space of  is E^(2) := E^(1)Ã— E_4Ã— E_5Ã— E_6, where E_4 = ^d+1,E_5=^d+1 and E_6=. Let  (D_E^(2)([0,âˆ)),(_t^2)_tâˆˆ[0,âˆ), ^2) be the filtered measurable space with coordinate projections A^(i):D_E^(2)([0,âˆ))â†’ D_E_i([0,âˆ)) for iâˆˆ{1,â€¦,6} (note that A^(i), for iâˆˆ{1,2,3}, agrees with the definition in the beginning of the second paragraph of this proof).  Moreover, a measurable map :(Î©,)â†’(D_E^(2)([0,âˆ)),^2)
 induces the probability measure Q_z^2(Â·):=_z(âˆˆÂ·) on ^2. Note that Q_z^2((A^(1),A^(2),A^(3))^-1(Â·)) = Q_z^1(Â·) for all zâˆˆ. Hence 
 the first three coordinates converge weakly under  (Q_z_n^2)_nâˆˆ.



Denote A^(1) = (A^(1,X),A^(1,Y)), where A^(1,X):D_E^(2)([0,âˆ)) â†’ D_([0,âˆ)) and A^(1,Y):D_E^(2)([0,âˆ)) â†’ D_^d([0,âˆ)).
 
 Note that for each zâˆˆ, L and W under the measures _z are adapted to the complete, right-continuous filtration (_t)_tâˆˆ and have continuous sample paths, which are thus in D_E_2([0,âˆ)) and D_E_3([0,âˆ)), respectively.[We work with cÃ dlÃ g paths because we applyÂ <cit.> to conclude the stability of the stochastic integrals.] Moreover, the processes W,L are semimartingales, which satisfy _z_n[L_tâˆ§Ï±_r_0âˆ§ T]<âˆ (by LemmaÂ <ref>)  and  _z_n[[W]_tâˆ§ T] â‰¤ T for any tâˆˆ and nâˆˆ. Thus, AssumptionÂ <cit.> is satisfied with the deterministic time Ï„^Î±_n := Î±+1, where Î±âˆˆ(0,âˆ), nâˆˆ are arbitrary parameters and Ï„^Î±_n is a sequence of stopping times inÂ <cit.>. Since   the functions zâ†¦Î£(z), zâ†¦Ï•(z), zâ†¦ b(x)^2-y_d+1^2 are continuous for z=(x,y)âˆˆ and _z(âˆˆÂ·) = Q_z^2(Â·),Â <cit.> implies that there exists a probability measure Q_*^2 on (D_E^(2)([0,âˆ)),^2), such that
 

    A :=(A^(1)_Â·,A_Â·^(2),A_Â·^(3),âˆ«_0^Â·Î£^1/2(A^(1)_u) A_u^(3),âˆ«_0^Â·Ï•(A^(1)_u) A^(2)_u,âˆ«_0^Â· (b(A_u^(1,X))^2 - A^(1,Y)_u_d^2) A^(2)_u),

under the measure Q_z_n^2, converges weakly
(as nâ†’âˆ) to
A
under Q_*^2. In particular,<cit.> ensures that A^(2),A^(3) are semimartingales under Q_*^2.
Note that all limiting processes have continuous paths Q_*^2-a.s., which follows from the fact that A^(1),A^(2) and A^(3) have continuous paths Q_*^2-a.s.
We now extend (usingÂ <cit.>) the weak convergence to stopping times Ï±_r and the corresponding stopped processes.

For a^(1,X)âˆˆ D_([0,âˆ)) and r>0, denote Ï„_r(a^(1,X)) := inf{ t>0: a^(1,X)_t â‰¥ r  or  a^(1,X)_t-â‰¥ r}, where a^(1,X)_t- denotes the left limit of a^(1,X) at time t. Since, for any zâˆˆ, the process X has _z-a.s.Â continuous paths, we have Ï„_r(X) = Ï±_r, _z-a.s.
We now  make the final extension of the state space, which will capture the convergence of the stopping times. Denote E^(3) := E^(2)Ã—, and let (D_E^(3)([0,âˆ)),(_t^3)_tâˆˆ[0,âˆ), ^3) be the filtered measurable space with coordinate projections A^(i), for iâˆˆ{1,â€¦,7}.
For any râˆˆ (0,âˆ), a measurable map (,Ï±_r):(Î©,)â†’(D_E^(3)([0,âˆ)),^3)
 induces the probability measure Q_z^3,r(Â·):=_z((,Ï±_r)âˆˆÂ·) on ^3. 
 Furthermore, for any râˆˆ(0,âˆ), it holds that Q_z^3,r(A^-1(Â·)) = Q_z^2(Â·).

As before, A under Q^3,r_z_n converge to Ãƒ under some probability measure Q^3,r_*.
Moreover, A^(1,X) has Q_*^3,r-a.s. continuous paths.
Thus,Â <cit.> implies that for all but at most countably many râˆˆ(0,r_0), the map D_([0,âˆ))â†’, given by a^(1,X)â†¦Ï„_r(a^(1,X)), is continuous at A^(1,X), Q_*^3,r-a.s. (recall that r_0>0 is an arbitrary number, fixed at the beginning of the proof). Pick r_1âˆˆ(r_0/2,r_0) such that a^(1,X)â†¦Ï„_r_1(a^(1,X)) is continuous at a^(1,X), Q_*^r_1-a.s. The  Continuous mapping theoremÂ <cit.> implies that (Ãƒ,Ï„_r_1(A^(1,X))), under Q_z_n^3,r_1, converges weakly  to (Ãƒ,Ï„_r_1(A^(1,X))) under Q_*^3,r_1. 
The convergence of the stopped processes follows by applyingÂ <cit.> to the stochastic integral âˆ«_0^t 1{sâ‰¤Ï±_r_1}_s  (conditionÂ <cit.> is satisfied with Ï„^Î±_n := Î±+1 as above). Since _z((,Ï±_r_1)âˆˆÂ·) =Q_z^3,r_1(Â·), it follows that
(Ãƒ_Â·âˆ§Ï„_r_1(A^(1,X))), under Q_z_n^3,r_1, converges weakly as nâ†’âˆ to (Ãƒ_Â·âˆ§Ï„_r_1(A^(1,X))) under the probability measure Q_*^3,r_1.

To conclude the proof, we have to show that the process (A^(1),A^(2),A^(3)) under Q_*^3,r_1 solves SDEÂ (<ref>).
Denote by 0âˆˆ D_E_1([0,âˆ)) 
the function mapping every tâˆˆ[0,âˆ) into the origin of ^d+1.
For every nâˆˆ, we have

    A^(1)_Â·âˆ§Ï„_r_1(A^(1,X)) - z_n -âˆ«_0^Â·âˆ§Ï„_r_1(A^(1,X))Ï•(A^(1)_u) A^(2)_u - âˆ«_0^Â·âˆ§Ï„_r_1(A^(1,X))Î£^1/2(A^(1)_u) A^(3)_uâ‰¡0,   Q_z_n^3,r_1-a.s.

Since the set {0} is closed in 
D_E_1([0,âˆ)),Â <cit.> implies that 
    A_Â·âˆ§Ï„_r_1(A^(1,X))^(1) -z_âˆ - âˆ«_0^Â·âˆ§Ï„_r_1(A^(1,X))Î£^1/2(A^(1)_u) A_u^(3) - âˆ«_0^Â·âˆ§Ï„_r_1(A^(1,X))Ï•(A^(1)_u) A^(2)_uâ‰¡0,   Q_*^3,r_1-a.s.


Note that since A^(3) is a Brownian motion under 
Q_z_n^3,r_1 for every nâˆˆ, it is also a Brownian motion under the weak limit Q_*^3,r_1.

It remains to prove that, under Q^3,r_1_*, A^(2) is a local time
of A^(1) at the boundary âˆ‚. For any zâˆˆ, 
the local time has to satisfy L_tâˆ§Ï±_r = âˆ«_0^tâˆ§Ï±_rZ_sâˆˆâˆ‚ L_s, _z-a.s.
This requirement is equivalent to 

    âˆ«_0^tâˆ§Ï±_r (b(X_s)^2 - Y_s_d^2)  L_s = 0,   _z-a.s.

Indeed, since b(x)^2-y_d^2=0 for all (x,y)âˆˆâˆ‚, we have
âˆ«_0^tâˆ§Ï±_r (b(X_s)^2 - Y_s_d^2)  L_s =
âˆ«_0^tâˆ§Ï±_r (b(X_s)^2 - Y_s_d^2) Z_sâˆˆâˆ‚ L_s=
0, _z-a.s., by the definition of local time.
Conversely, since b(x)^2-y_d^2>0 for all (x,y)âˆˆâˆ–âˆ‚, the sets _k:={(x,y)âˆˆ:b(x)^2-y_d^2âˆˆ[1/(k+1),1/k)}
are pairwise disjoint and satisfy âˆª_kâˆˆ_k=âˆ–âˆ‚.
Moreover, we have
0â‰¤âˆ«_0^tâˆ§Ï±_rZ_sâˆˆ_k L_sâ‰¤ (k+1)âˆ«_0^tâˆ§Ï±_r (b(X_s)^2 - Y_s_d^2) Z_sâˆˆ_k L_s=0, implyingÂ (<ref>) via
L_tâˆ§Ï±_r = âˆ«_0^tâˆ§Ï±_rZ_sâˆˆâˆ‚ L_s +âˆ‘_kâˆˆâˆ«_0^tâˆ§Ï±_rZ_sâˆˆ_k L_s
=âˆ«_0^tâˆ§Ï±_rZ_sâˆˆâˆ‚ L_s.

Note that âˆ«_0^Â·âˆ§Ï„_r_1(A^(1,X)) (b(A^(1,X))^2 - A^(1,Y)_d^2) A^(2)_u â‰¡0, Q_z_n^3,r_1-a.s., for every nâˆˆ, where 0  now denotes the zero function in D_E_6([0,âˆ)) (recall that E_6=).
Thus, byÂ <cit.>,
we get âˆ«_0^Â·âˆ§Ï„_r_1(A^(1,X)) (b(A^(1,X))^2 - A^(1,Y)_d^2) A^(2)_u â‰¡ 0, Q_*^3,r_1-a.s. Hence, the condition inÂ (<ref>) implies that 
A^(2) is indeed the local time of A^(1)
at the boundary âˆ‚.



 We have thus proved that (A^(1)_Â·âˆ§Ï„_r_1(A^(1,X)),A^(2)_Â·âˆ§Ï„_r_1(A^(1,X)),A^(3)_Â·âˆ§Ï„_r_1(A^(1,X))), under Q_*^3,r_1 (and hence under Q_*^1), solves SDEÂ (<ref>) on the stochastic interval [0,Ï±_r_1]. The pathwise uniquenessÂ <cit.> of solutions of SDEÂ (<ref>) implies 
 that every sub-sequential limit Q_*^1 of the sequence of (Q_z_n^1)_nâˆˆ 
 equals Q_z_âˆ^1, implying the
 Feller continuity for the process stopped at Ï±_r_1, i.e.Â the limit inÂ (<ref>) holds for r_1.
 Since  r_0 was chosen arbitrarily and r_1âˆˆ(r_0/2,r_0), we can inductively construct a sequence (r_k)_kâˆˆ with lim_kâ†’âˆr_k = âˆ, such thatÂ (<ref>) holds for every kâˆˆ. An application of LemmaÂ <ref> concludes the proof of TheoremÂ <ref>.






 Â§.Â§ Application to petite sets and Harris recurrence



The family of probability measures 
_z(Z_t âˆˆÂ·) on (), indexed by tâˆˆ
and zâˆˆ 
constitutes a Markov transition kernel byÂ <cit.> and TheoremÂ <ref>.

A non-empty set B âˆˆ() is called petite if there exists  
a probability measure a on (,()), which does
not charge zero (i.e.Â  a({0})=0), and 
a non-trivial measure Ï†_a  on (,())  satisfying

    K_a(z, Â·) â‰¥Ï†_a(Â·)    for all z âˆˆ B,

where the Markov transition function
K_a: Ã—() â†’ is given by

    K_a(z,Â·) := âˆ«__z(Z_tâˆˆÂ·)a( t).

The measurability of  zâ†¦ K_a(z,A) for any
Aâˆˆ() follows fromÂ <cit.>.

Let Ï† be a Ïƒ-finite measure on the Borel Ïƒ-algebra (). 

The  process Z is Harris recurrent if  Ï†(A) > 0 implies  âˆ«_0^âˆ1_A(Z_s)  s = âˆ, _z-a.s., for all Aâˆˆ() and z âˆˆ. 







Suppose that ass:covariance2, ass:vector2 and ass:domain2 hold. Then all compact subsets of  are petite. Moreover, if Î²<Î²_c, the process Z is Harris recurrent.






Fix z_0âˆˆâˆ–âˆ‚=
and h_0>0, such that 
B(z_0,2h_0)={zâˆˆ:z-z_0_d+1<2h_0}âŠ‚.
We now prove that the ball B(z_0,h_0) is petite.
Recall that 
the stopping time Ï„_âˆ‚ B(z_0,2h_0):=inf{tâˆˆ: Z_tâˆ‰ B(z_0,2h_0)}
is strictly positive _z-a.s. for all 
zâˆˆ B(z_0,h_0).
Moreover, the process Z on the stochastic interval [0,Ï„_âˆ‚ B(z_0,2h_0)), started at any zâˆˆ B(z_0,h_0), coincides with a uniformly elliptic diffusion on ^d+1, stopped upon exiting the ball B(z_0,2h_0).
Thus, byÂ <cit.>, we have inf_zâˆˆ B(z_0,h_0)_z(Z_h_0^2âˆˆÂ·)â‰¥Ï†(Â·), where 
Ï† is the Lebesgue measure multiplied by a positive scalar and supported in B(z_0,h_0). 

Hence, for any zâˆˆ B(z_0,h_0),  conditionÂ (<ref>) holds with a_1( t) = Î´_h_0^2( t), where Î´_h_0^2 is the Dirac delta concentrated at h_0^2>0, and taking the non-trivial measure Ï†_a_1:=Ï† on (,()). 

We now prove that  an arbitrary compact set D in  is also petite. Since B(z_0,h_0) is an open set, TheoremÂ <ref> andÂ <cit.> imply that the function zâ†¦_z(Z_1âˆˆ B(z_0,h_0)) is lower semi-continuous on . Moreover, by PropositionÂ <ref>, we have _z(Z_1âˆˆ B(z_0,h_0))>0 for all zâˆˆ D. Hence, by compactness of D and the lower semi-continuity of the function zâ†¦_z(Z_1âˆˆ B(z_0,h_0)), we get inf_zâˆˆ D_z(Z_1âˆˆ B(z_0,h_0))>0. 

For any zâˆˆ D, the Markov property of Z implies 
    _z(Z_1+h_0^2âˆˆÂ·)â‰¥_z(Z_1âˆˆ B(z_0,h_0))  inf_z'âˆˆ B(z_0,h_0)_z'(Z_h_0^2âˆˆÂ·)â‰¥inf_zâ€âˆˆ D_zâ€(Z_1âˆˆ B(z_0,h_0))Ï†_a_1(Â·).
 
Thus the set D satisfies conditionÂ (<ref>)   with the probability measure a_2( t) = Î´_1+h_0^2( t) and non-trivial measure Ï†_a_2 := inf_zâˆˆ D_z(Z_1âˆˆ B(z_0,h_0))Ï†_a_1 on (,()), making D petite.


 In particular, the set âˆ© [r_0,âˆ)Ã—^d is a petite set for every r_0âˆˆ(0,âˆ). Moreover, if Î²<Î²_c, PropositionÂ <ref> implies that, for all sufficiently large  r_0âˆˆ(0,âˆ), we have _z(Ï‚_r_0 < âˆ) = 1 for all z âˆˆ. We conclude that the process Z is Harris recurrent by <cit.>. 






The following proposition is crucial for establishing the lower bounds on the tail of the invariant distribution  of the reflected process Z in TheoremÂ <ref> (the proof of TheoremÂ <ref> requires an estimate of the return times to an arbitrary petite set).



Suppose that ass:covariance2, ass:vector2 and ass:domain2 hold with Î² < Î²_c. Then every petite set is bounded.



 Let B be an arbitrary petite set and let the probability measure a on _+ and a non-zero measure Ï†_a on (,()) be such thatÂ (<ref>) holds,
 with K_a as inÂ (<ref>). 
 Denote ^(r)=âˆ© [0,r]Ã—^d for any r>0. 
  Since Ï†_a is a non-trivial measure on (,()), there exists r_0âˆˆ(0,âˆ), such that c:=Ï†_a(^(r_0))> 0.
 



 Proposition <ref> implies that for every qâˆˆ(0,1), pâˆˆ(1-Î²/Î²_c,âˆ) and z=(x,y)âˆˆ, there exists r_1âˆˆ(0,âˆ) such that  for  every râˆˆ(r_1,âˆ) there exist constants c_1,c_2âˆˆ(1,âˆ) and âˆˆ(0,âˆ) satisfying

    _z(Ï‚_r â‰¥ t_0) â‰¥ qmin{(c_1^-p(x-c_2)^p-r^p)(1-q)^p^-1/2 t_0^-p/2,1}

for all t_0âˆˆ(c_1 r_1+c_2,âˆ)
(recall that the return time Ï‚_r_0 is defined inÂ (<ref>)).
Since a is a probability measure, there exists t_0âˆˆ(c_1 r_1+c_2,âˆ) satisfying
a([t_0,âˆ)) < c/2.

We now show that there exists x_0âˆˆ(0,âˆ), such that 
_z(Ï‚_r_0 <t_0) < c/2
for all zâˆˆâˆ–^(x_0). 
Indeed, fix
r â‰¥max{r_0,r_1} (note  Ï‚_râ‰¤Ï‚_r_0), q âˆˆ(1-c/2,1) and pâˆˆ(1-Î²/Î²_c,âˆ). 
Pick x_0>0, such that (c_1^-p(x-c_2)^p-r^p)(1-q)^p^-1/2 t_0^-p/2â‰¥ 1 for all xâˆˆ(x_0,âˆ). 
Note that this choice of x_0 implies 
x_0>r and, in particular, x_0âˆˆ(r_0,âˆ).
For any z=(x,y)âˆˆâˆ–^(x_0), the inequality inÂ (<ref>)
implies _z(Ï‚_r_0 < t_0) â‰¤_z(Ï‚_r < t_0) < 1-q <c/2. 

ByÂ (<ref>), we have 
K_a(z,^(r_0))â‰¤âˆ«_0^t_0_z(Z_tâˆˆ^(r_0))a( t)+a([t_0,âˆ)).  Since, for all zâˆˆâˆ–^(x_0), we have _z(Z_tâˆˆ^(r_0))â‰¤_z(Ï‚_r_0 < t_0)<c/2 for all tâˆˆ[0,t_0], the inequality 
Ï†_a(^(r_0)) =c> K_a(z,^(r_0)) holds for all
zâˆˆâˆ–^(x_0). 
Since the petite set B satisfiesÂ (<ref>),
we must have BâŠ‚^(x_0), making B bounded.






Â§ STABILITY: THE PROOF OF THEOREMÂ <REF>
 


Existence and uniqueness of the invariant distribution of Z, the upper bounds on the tails of
the invariant distribution and upper bounds on the rate of convergence of Z to stationarity will be established using the drift condition (i.e.Â supermartingale property) given in LemmaÂ <ref> (see SectionÂ <ref>) and the fact that every compact set in  is petite for the reflected process Z (see PropositionÂ <ref> in SectionÂ <ref> above). The lower bounds on the tails of the invariant distribution and the rate of convergence to stationarity will follow from the fact that every petite set of Z is bounded (see PropositionÂ <ref> above) and the control we have established on the return time and length of excursions away from bounded sets (see PropositionÂ <ref>).
TheoremÂ <ref> follows easily from PropositionsÂ <ref> andÂ <ref> proved in this section. 

 

 Â§.Â§ Existence, uniqueness, and upper bounds

The upper bounds on the tails of the invariant distribution are obtained by establishing finiteness of certain moments and applying the Markov inequality. In SectionÂ <ref> below we show that these bounds cannot be improved. 
 


Suppose that ass:covariance2, ass:vector2 and ass:domain2 hold with Î² < -Î²_c
and recall 
M_c = -(1+Î²/Î²_c)/2>0.
Then there exists the unique invariant distribution Ï€ on (,())  for the process Z. Pick Ïµ>0. There exists a constant C_Ï€âˆˆ(0,âˆ), such that

    Ï€({zâˆˆ:z_d+1â‰¥ r})â‰¤ C_Ï€ r^-2M_c+Ïµ    for all râˆˆ[1,âˆ).

Furthermore, for every  zâˆˆ there exists a constant C_TVâˆˆ(0,âˆ), such that 
 
    _z(Z_tâˆˆÂ·)-Ï€_TV   â‰¤  C_TVt^-M_c +   for all tâˆˆ[1,âˆ).





ByÂ PropositionÂ <ref>, the process Z admits an irreducible skeleton chain. Moreover, by PropositionÂ <ref> the sets ^(r)=âˆ©[0,r]Ã—^d, defined inÂ (<ref>), are petite for every r>0. Pick arbitrary âˆˆ(0,1-Î²/Î²_c-2) and note that Î³:=1-Î²/Î²_c - >2. By LemmaÂ <ref>, the process Î¾, defined inÂ (<ref>), is a supermartingale. Note that by definition of F_w,Î³ inÂ (<ref>), we have F_w,Î³(z)^(Î³-2)/Î³ = F_w,Î³-2(z) for zâˆˆâˆ©[x_1,âˆ)Ã—^d, where x_1 is the constant appearing in the definition of the function m inÂ (<ref>). We may thus applyÂ <cit.> (with V=F_w,Î³, Ï•(u) = C_1 u^(Î³-2)/Î³, b=C_2 and the petite set ^(x_2) from LemmaÂ <ref>), to deduce the existence and uniqueness of the invariant distribution Ï€ of Z and âˆ«_F_w,Î³-2(z)Ï€( z)<âˆ. From the definition of F_w,Î³(z) inÂ (<ref>) and the lower bound inÂ (<ref>) it follows that CÌƒ_Ï€:=âˆ«_z=(x,y)âˆˆx^2M_c-Ï€( z)<âˆ. Moreover, Markov's inequality implies 
    Ï€(âˆ© [r,âˆ)Ã—^d)â‰¤âˆ«_ (x/r)^2M_c-ÏµÏ€( z)â‰¤CÌƒ_Ï€ r^-2M_c+Ïµ    for all râˆˆ[1,âˆ).


Recall that 
for any z = (x,y)âˆˆ we have x â‰¤z_d+1â‰¤ (x^2+b(x)^2)^1/2 and the boundary function b has sublinear growth (cf. RemarkÂ <ref>), implying  (x^2+b(x)^2)^1/2/x â†’ 1 as x â†’âˆ. Thus, the upper bound Ï€(âˆ© [r,âˆ)Ã—^d)â‰¤CÌƒ_Ï€ r^-2M_c+Ïµ implies the existence of the constant C_Ï€âˆˆ(0,âˆ) such that the bound on the tail  Ï€({z âˆˆ:z_d+1â‰¥ r})â‰¤ C_Ï€ r^-2M_c+Ïµ holds for all râˆˆ[1,âˆ) as claimed in the proposition.

Recall that _d+1 is a Lebesgue measure on ^d+1. The process Z admits an _d+1-irreducible skeleton chain, since for every Aâˆˆ(), such that  _d+1(A) > 0, and z âˆˆ, by PropositionÂ <ref>, we have _z(Z_kâˆˆ A) > 0 for every k âˆˆ. In particular, AssumptionÂ (i) inÂ <cit.> is satisfied for Z.
For Î³ = 1-Î²/Î²_c-,  LemmaÂ <ref> ensures that AssumptionÂ (ii) ofÂ <cit.> is satisfied. ByÂ <cit.>, with the pair of functions Î¨ = (Id,1), where Id,1:â†’ denote the identity and the constant functions, respectively, we obtain

    r_*(t)_z(Z_tâˆˆÂ·)-Ï€_TVâ‰¤  F_w,Î³(z)    for all tâ‰¥ 0,

where r_*(t) = Ï†âˆ˜ H_Ï†^-1(t). Here, the function Ï† is positive, satisfying Ï†(u) = CÌƒ_1u^(Î³-2)/Î³ for uâ‰¥ 1, and H_Ï†^-1 is the inverse of the increasing function H_Ï†, satisfying H_Ï†(u) = âˆ«_1^u Ï†(s)^-1 s for uâ‰¥ 1. This implies r_*(t) = CÌƒ_2 (t+1)^Î³/2-1 for a positive constant CÌƒ_2âˆˆ(0,âˆ) and tâˆˆ(0,âˆ). 




 Â§.Â§ Lower bounds
 

The lower bounds on the tails of the invariant distribution Ï€ of the reflected process Z 
are closely related to the tail behaviour of 
certain additive functionals of the paths of Z until the return time to a petite set. For a measurable subset D âŠ‚ and Î´ > 0, define the return time of the process Z  to the set D after the time Î´>0 by Ï„_Î´(D) := inf{ t > Î´: Z_t âˆˆ D} (with convention infâˆ…=âˆ).



Suppose thatÂ ass:domain2, ass:covariance2, ass:vector2 hold with Î² < Î²_c and pick p âˆˆ(1-Î²/Î²_c,âˆ), a bounded measurable set DâŠ‚ and zâˆˆ. Then there exist constants 
Î´âˆˆ (0,âˆ) and 
C,r_0,c_1,c_2,Ïµâˆˆ(0,âˆ), such that for every 
non-decreasing continuous function H:â†’
with r_H:=inf{r'â‰¥:H(r')>0}<âˆ,
we have

    _z(âˆ«_0^Ï„_Î´(D) H(c_1(X_s +c_2)) s â‰¥ r) â‰¥ C/ G(r/Ïµ)^p  for all râˆˆ(r_0,âˆ),

where G:â†’ is the inverse of the strictly increasing function defined on [r_H,âˆ) by the formula vâ†¦ v^2 H(v).




    (a) The assumption Î² < Î²_c in PropositionÂ <ref>
    covers both the null-recurrent and positive-recurrent cases.
    However, the main application of PropositionÂ <ref> in the proof of 
    LemmaÂ <ref>
     below requires only the positive-recurrent case.
     Since LemmaÂ <ref> is crucial in the proof of 
     PropositionÂ <ref>, 
the bound in PropositionÂ <ref> is key for 
     the lower bounds in TheoremÂ <ref>.
     

    (b) The statement of PropositionÂ <ref>
    in fact holds for every Î´>0. 
    In the proof of PropositionÂ <ref> below, we apply the non-confinement property of Z, given in LemmaÂ <ref>, to conclude that Î´>0  exists. 
    However, since  by PropositionÂ <ref> Z is irreducible, the event  {X_Î´ > c_1(d_0+1)+c_2} has positive probability for every Î´>0. Since the existence of Î´>0 is sufficient for our analysis of the lower bound on the tail of the invariant distribution and non-confinement is weaker (and easier to prove) than irreducibility, we use the formulation of PropositionÂ <ref> above.

    (c) The assumed continuity of the function H in PropositionÂ <ref> is not necessary: measurability would be sufficient but it would complicate the formulation of the proposition.



Pick  a non-decreasing continuous function H:â†’ 
with r_H=inf{r':H(r')>0}<âˆ.
PropositionÂ <ref> implies that for every p âˆˆ (1-Î²/Î²_c,âˆ) and qâˆˆ(0,1), there exist constants x_0âˆˆ(0,âˆ), c_1,c_2âˆˆ(1,âˆ) and (q)âˆˆ(0,âˆ), such that for every x_1âˆˆ(x_0,âˆ) and z=(x,y)âˆˆâˆ© (c_1x_1+c_2,âˆ)Ã—^d and function HÌ…(r):=H(c_1(r+c_2)), râˆˆ, we have

    _z(âˆ«_0^Ï‚_x_1HÌ…(X_s) s â‰¥ v^2H(v)) â‰¥ qmin{(c_1^-p(x-c_2)^p-x_1^p)v^-p,1},

for all vâˆˆ(c_1x_1+c_2,âˆ).
Recall here that Ï‚_x_1, defined inÂ (<ref>) above,  is the return time of the first coordinate X (of Z) below the level x_1 and X_0=x _z-a.s.
Note that the following elementary inequality holds since the function is monotonically increasing as p>0:

    c_1^-p(x-c_2)^p-x_1^pâ‰¥ (x_1+1)^p-x_1^p  for all xâˆˆ(c_1(x_1+1)+c_2,âˆ).





Since vâ†¦ v^2H(v) is strictly increasing on [r_H,âˆ) with range equal to , for any râˆˆ(c_1x_1+c_2,âˆ) we 
can define v:=G(r/Ïµ), implying
r=Ïµ v^2 H(v). 
 Thus, for every z=(x,y)âˆˆâˆ© (c_1(x_1+1)+c_2,âˆ)Ã—^d
 and any  C_x_1âˆˆ(0,q((x_1+1)^p-x_1^p)/G(c_1x_1+c_2/Ïµ)^p)
 we have

    _z(âˆ«_0^Ï‚_x_1HÌ…(X_s) s â‰¥ r)
    
       â‰¥ qmin{((x_1+1)^p-x_1^p)/G(r/Ïµ)^p,1}
    
       â‰¥ C_x_1 /G(r/Ïµ)^p   for all râˆˆ(c_1x_1+c_2,âˆ),

where the first inequality inÂ (<ref>) follows fromÂ (<ref>) above.

Fix zâˆˆ and a bounded set DâŠ‚.
Let m_D:=sup{x:(x,y)âˆˆ D}âˆˆ satisfy DâŠ‚ [0,m_D]Ã—^dâˆ© (note that m_D<âˆ by assumption on D) 
and denote d_0 := max{m_D,x_1}. Since, by LemmaÂ <ref>, X is not confined
to any compact set, there exists Î´ > 0, such that _z(X_Î´ > c_1(d_0+1)+c_2)  > 0. 
Note that, on the event 
{X_Î´ > c_1(d_0+1)+c_2}, _z-a.s.
we have 
Z_Î´âˆˆâˆ© (c_1(x_1+1)+c_2,âˆ)Ã—^d. The
Markov property of Z andÂ (<ref>) thus imply that for every pâˆˆ(1-Î²/Î²_c,âˆ) and 
r_0:=c_1 d_0+c_2,
there exists a constant C_d_0âˆˆ(0,q((d_0+1)^p-d_0^p)/G(c_1d_0+c_2/Ïµ)^p), such that

    _z(âˆ«_0^Ï‚_x_1HÌ…(X_s)  s â‰¥ r)    â‰¥_z( âˆ«_0^Ï„_Î´(D)HÌ…(X_s) s â‰¥ r, X_Î´ > r_0+c_1)
       â‰¥_z[X_Î´ > r_0+c_1Â·_Z_Î´( âˆ«_0^Ï„_Î´(D)HÌ…(X_s) s â‰¥ r)]
       â‰¥_z[X_Î´ > r_0+c_1Â·_Z_Î´( âˆ«_0^Ï‚_d_0HÌ…(X_s) s â‰¥ r)]
       â‰¥_z(X_Î´ > r_0+c_1) C/G(r/Ïµ)^p   for all râˆˆ(r_0,âˆ).




We can now establish the lower bounds on the tail of the the invariant distribution of Z.



Suppose thatÂ ass:domain2, ass:covariance2, ass:vector2 hold with Î² < -Î²_c and recall M_c = -(1+Î²/Î²_c)/2. Let Ï€ be the invariant distribution of the process Z and pick >0. There exists a  constant
c_Ï€âˆˆ(0,âˆ)
 such that

    c_Ï€ r^-2M_c-Ïµâ‰¤Ï€({zâˆˆ:z_d+1â‰¥ r})    for all râˆˆ[1,âˆ).

Furthermore, for any zâˆˆ, there exists a constant c_TVâˆˆ(0,âˆ), such that 

    c_TVt^-M_c-Ïµâ‰¤_z(Z_tâˆˆÂ·)-Ï€_TV    for all tâˆˆ[1,âˆ).



The key step in the proof of PropositionÂ <ref>
is the following lemma.



Suppose thatÂ ass:domain2, ass:covariance2, ass:vector2 hold with Î² < -Î²_c.
For any Ïµ>0 there exists a constant c_Ï€âˆˆ(0,âˆ),
such that 
c_Ï€ r^1+Î²/Î²_c-â‰¤Ï€(âˆ© [r,âˆ)Ã—^d) for all râˆˆ[1,âˆ).



The reflected process Z is positive Harris recurrent, i.e., Z is Harris recurrent (by PropositionÂ <ref>) and admits an invariant distribution (by PropositionÂ <ref>). Thus, byÂ <cit.>, a measurable function f: â†’ [1,âˆ) satisfies âˆ«_z âˆˆf(z)Ï€( z) < âˆ if and only if sup_z âˆˆ D_z[âˆ«_0^Ï„_Î´(D)f(Z_s) s]< âˆ for some closed petite set DâŠ‚ and all Î´ > 0, where Ï„_Î´(D)= inf{ t > Î´: Z_t âˆˆ D} is the return time to the set D after time Î´ (defined before the statement of PropositionÂ <ref> above). Since by PropositionÂ <ref> all petite sets are bounded, PropositionÂ <ref>
implies that for any closed petite set D
of Z there exists Î´>0 such that for any
non-decreasing continuous function HÌƒ:â†’[1,âˆ)
we have 
_z[âˆ«_0^Ï„_Î´(D)HÌƒ(c_1(X_s+c_2)) s]â‰¥ Câˆ«_r_0^âˆ G(r/Ïµ)^-p r
for all zâˆˆ and pâˆˆ(1-Î²/Î²_c,âˆ),
where G:â†’
is the inverse of the function vâ†¦ v^2HÌƒ(v)
and the positive constants Ïµ, r_0, C, c_1,c_2 are as in PropositionÂ <ref>.
By the criterion inÂ <cit.> stated above we thus obtain that 

    âˆ«_r_0^âˆ G(r/Ïµ)^-p r = âˆ   implies   âˆ«_z=(x,y)âˆˆHÌƒ(c_1(x+c_2))Ï€( z)=âˆ.




The proof of LemmaÂ <ref> proceeds by contradiction. Note that the statement in the lemma is equivalent to the following: for every Ïµ>0
there exists r_0âˆˆ(0,âˆ) such that 
    r^1+Î²/Î²_c-â‰¤Ï€(âˆ© [r,âˆ)Ã—^d)    for all râˆˆ[r_0,âˆ).

Assume to the contrary that there exists Ïµ>0, such that for every r_0>0 there exists r_1âˆˆ[r_0,âˆ) satisfying
r_1^1+Î²/Î²_c->Ï€(âˆ© [r_1,âˆ)Ã—^d).
We may pick r_0>1 and r_1>2r_0. Using a recursive construction, we obtain a sequence (r_n)_nâˆˆ, such that 
r_n+1>2r_n and r_n^1+Î²/Î²_c->Ï€(âˆ© [r_n,âˆ)Ã—^d) for all nâˆˆ.
Using this sequence, we now construct a function H 
satisfying âˆ«_ H(x)Ï€( z)<âˆ 

but which violates the implication inÂ (<ref>).


Set Î± := -(1+Î²/Î²_c)+ and define the function 
Î¼:â†’ by 
Î¼(x):=1 for xâˆˆ[0,r_1) and
Î¼(x) := r_n^-Î± for xâˆˆ [r_n,r_n+1), nâˆˆ.  
Since the function xâ†¦Ï€(âˆ© [x,âˆ)Ã—^d) is non-increasing, we have  
Ï€(âˆ© [x,âˆ)Ã—^d)â‰¤Î¼(x) for all xâˆˆ. 
Let H:â†’[1,âˆ) be a differentiable function such that H(x) = 1 
for xâˆˆ[0,r_1) and, for xâˆˆ[r_n,r_n+1), we have

    H'(x) = 
    r_n^Î±-/2,   xâˆˆ [r_n,r_n+1);
    
    1/(r_n+1-r_n),   xâˆˆ [r_n+1,r_n+1).

Since Î¼ is non-increasing by definition, for xâˆˆ[r_n,r_n+1), we have Î¼(x) â‰¤ r_n^-Î± and 

    H'(x)Î¼(x) = 
    r_n^-/2,   xâˆˆ[r_n,r_n+1); 
    
    r_n^-Î±/(r_n+1-r_n),   xâˆˆ[r_n+1,r_n+1).

The inequality Ï€(âˆ©[x,âˆ)Ã—^d)â‰¤Î¼(x) and Tonelli's theorem (with H(0)=1) imply

    âˆ«_z=(x,y)âˆˆ H(x)Ï€( z)    â‰¤ 1+âˆ«_r_1^âˆ H'(x)Ï€(âˆ© [x,âˆ)Ã—^d) x 
     â‰¤ 1+ âˆ«_r_1^âˆ H'(x)Î¼(x) x
       =1+âˆ‘_n=1^âˆ(âˆ«_r_n^1+r_nH'(x)Î¼(x) x + âˆ«_1+r_n^r_n+1H'(x)Î¼(x) x )
       â‰¤1+âˆ‘_n=1^âˆr_n^-/2 + âˆ‘_n=1^âˆ r_n^-Î±<âˆ,

where the final inequality follows from 2^n-1r_1â‰¤ r_n for every nâˆˆ and Î±>>0.

Let >0 and c_1, c_2âˆˆ(1,âˆ) whose existence is guaranteed by PropositionÂ <ref>. Let
HÌƒ:â†’[1,âˆ) be a non-decreasing differentiable function  satisfying HÌƒ(x)=H(x/c_1- c_2) for all xâˆˆ(c_1 c_2,âˆ).
 
 
 
 
 
 
Pick pâˆˆ(1-Î²/Î²_c,1-Î²/Î²_c+/2) and note
that p>2 and
2-p+Î±-/2>0.
Let G:â†’ be the inverse of the function uâ†¦ u^2 HÌƒ(u). 
Introduce the substitution 
 r=Ïµ u^2 HÌƒ(u)
 into the first integral inÂ (<ref>) to obtain
 
    âˆ«_1^âˆG(r/)^-p r    = âˆ«_G(1/Ïµ)^âˆ u^-p(2uHÌƒ(u) + u^2HÌƒ'(u)) u 
       â‰¥âˆ‘_n=n_0^âˆâˆ«_c_1(r_n+c_2)^c_1(2r_n+c_2) u^1-pHÌƒ(u) u=
    âˆ‘_n=n_0^âˆH(r_n)âˆ«_c_1(r_n+c_2)^c_1(2r_n+c_2) u^1-p u
     
       =/(p-2)âˆ‘_n=n_0^âˆ r_n^Î±-/2 c_1^2-p((r_n-c_2)^2-p-(2r_n-c_2)^2-p) 
       â‰¥/(p-2)âˆ‘_n=n_0^âˆ r_n^Î±-/2(r_n-c_2)^2-p (1-((2r_n-c_2)/(r_n-c_2))^2-p)
       â‰¥(1-2^2-p)/(p-2)âˆ‘_n=n_0^âˆ (r_n-c_2)^2-p+Î±-/2 =âˆ,

where n_0âˆˆ is sufficiently large so that  
c_1(r_n+c_2)>G(1/Ïµ) and r_n>c_2 hold for all nâ‰¥ n_0. The first inequality in the previous display uses the fact that HÌƒ is non-decreasing and positive, while the second follows from c_1>1 and 2-p<0.

Note that HÌƒ(c_1(x+c_2))=H(x) for every xâˆˆ.
Thus, the implication  inÂ (<ref>) 
and the estimate inÂ (<ref>)
yield   
 
    âˆ  = âˆ«_z=(x,y)âˆˆHÌƒ(c_1(x+c_2))Ï€( z) = âˆ«_z=(x,y)âˆˆH(x)Ï€( z).
 
 This contradictsÂ (<ref>) and concludes the proof of the lemma.



 
Note that 
Ï€({zâˆˆ:z_d+1â‰¥ r}) â‰¥Ï€(âˆ© [r,âˆ)Ã—^d)
for every râˆˆ.
Thus, the lower bound on the invariant distribution Ï€ follows form LemmaÂ <ref>.

Pick arbitrary 'âˆˆ(0,1). LemmaÂ <ref> implies that for  and Î³ := 1-Î²/Î²_c - ', there exists wâˆˆ(-âˆ,1-Î² s_0/c_0), some constant x_0,x_1,dâˆˆ, defining the function F_w,Î³, and a constant 
C_3âˆˆ(0,âˆ)
such that _z[F_w,Î³(Z_t)] â‰¤ F_w,Î³(z)+C_3t for all tâˆˆ and zâˆˆ. Since F_w,Î³(z) = f_w,Î³(z) on z=(x,y)âˆˆâˆ©[x_1,âˆ)Ã—^d, the upper bound inÂ (<ref>) 
implies that 

    Ï€({zâˆˆ:F_w,Î³(z) â‰¥ r})    â‰¥Ï€({z=(x,y)âˆˆ:x â‰¥ 2^Î³/|w|r^1/Î³-k_w})   for all râˆˆ(x_1,âˆ).

This inequality and the lower bound on the invariant distribution 
in LemmaÂ <ref>
imply that there exists a constant C_4âˆˆ(0,1) such that 

    Ï€({zâˆˆ:F_w,Î³(z) â‰¥ r})    â‰¥  C_4r^(1 + Î²/Î²_c - Ïµ')/Î³= C_4r^(1 + Î²/Î²_c - Ïµ')/(1-Î²/Î²_c-Ïµ')

for all râˆˆ(x_1,âˆ). By further reducing C_4>0
if necessary, we may assume that the inequality in the last display holds for all râˆˆ[1,âˆ).


 Define the functions f: [1,âˆ) â†’ (0,1], f(a)  := C_4 a^(1 + Î²/Î²_c - Ïµ')/(1-Î²/Î²_c-Ïµ')
 and F(a):=af(a)= C_4 a^(2 -2Ïµ')/(1-Î²/Î²_c-Ïµ') and note that F is strictly increasing with  lim_a â†’âˆ F(a) = âˆ. By LemmaÂ <ref>, applied  with  functions G(z) = F_w,Î³(z) (recall from the previous display that Ï€({zâˆˆ:G(z)â‰¥ r})â‰¥ f(r) for all râˆˆ[1,âˆ)) and  g(z,t) := F_w,Î³(z)+C_3 tâ‰¥_z[G(Z_t)], yields  constants C_2,C_5âˆˆ(0,âˆ), such that for all tâˆˆ[1,âˆ) we get 

    C_2t^(1+Î²/Î²_c-')/(2-2')â‰¤C_5/2(2g(z,t))^(1+Î²/Î²_c-Ïµ')/(2-2Ïµ')â‰¤_z(Z_t_nâˆˆÂ·)-Ï€_TV.



Pick arbitrary âˆˆ(0,1) and let Ïµ'âˆˆ(0,1) 
be such that 
0>(1+Î²/Î²_c-')/(2-2')>(1+Î²/Î²_c)/2-. 
Then the bound in the proposition follows fromÂ (<ref>).











Â§ A LOWER BOUND ON THE CONVERGENCE TO STATIONARITY OF A MARKOV PROCESS


Fix mâˆˆ and 
let Îº=(Îº_t)_tâˆˆ be a Markov process on an unbounded domain _Îº in ^m 
with an invariant distribution Ï€_Îº satisfying Ï€_Îº(Â·) = âˆ«__Îº_u(Îº_tâˆˆÂ·) Ï€_Îº( u) for every t>0.
Via a suitable Lyapunov function, the following lemma converts a lower bound estimate on the tail of invariant distribution Ï€_Îº into a lower bound on the rate of convergence in total variation of the law of Îº_t  to the invariant distribution Ï€_Îº. The elementary proof of LemmaÂ <ref> below is adapted fromÂ <cit.>. This  lemma is key in the proof of the lower bound on the rate of convergence in total variation stated in TheoremÂ <ref>(b).



Let 
 _Îº be an an unbounded domain in ^m and
Îº = (Îº_t)_tâˆˆ a _Îº-valued Markov process with invariant distribution Ï€_Îº. Assume the function G:_Îºâ†’ [1,âˆ) satisfies: 


  (a) there exists  f:[1,âˆ)â†’(0,1], such that the function F:yâ†¦ yf(y) is increasing, lim_yâ†‘âˆF(y)=âˆ and  Ï€_Îº({vâˆˆ_Îº:G(v)â‰¥ y})â‰¥ f(y) for all yâˆˆ[1,âˆ);

  (b) there exists g:_ÎºÃ—â†’[1,âˆ), such that for every uâˆˆ_Îº 
the function tâ†¦ g(u,t) is continuous and increasing to infinity and 

_u[G(Îº_t)] â‰¤ g(u,t) for all tâˆˆ.

Then, for any starting point uâˆˆ_Îº
we have 

    Ï€_Îº(Â·)-_u(Îº_tâˆˆÂ·)_TVâ‰¥1/2f(F^-1(2g(u,t)))
        for all tâˆˆ.




A good choice for the function G in LemmaÂ <ref>
has the following properties:  the expectation   
_u [G(Îº_t)]
is bounded as a function of the starting point u and time t
and 
the function 
yâ†¦Ï€_Îº(G^-1([y,âˆ)))
satisfies
lim_yâ†’âˆÏ€_Îº(G^-1([y,âˆ)))=0
and
lim_yâ†’âˆyÏ€_Îº(G^-1([y,âˆ)))=âˆ.
The proof of LemmaÂ <ref>
shows that if the assumption inÂ (a) holds for y
sufficiently large, then the conclusion of the lemma is valid for all t sufficiently large. 



The definition of the total variation distance (together with assumptionÂ (a)) and the Markov inequality (together with assumptionÂ (b)) imply  that for every
uâˆˆ_Îº and 
tâˆˆ the following inequalities hold for all yâˆˆ[1,âˆ):

    Ï€_Îº(Â·)-_u(Îº_tâˆˆÂ·)_TVâ‰¥Ï€_Îº({vâˆˆ^d:G(v)â‰¥ y})-_u(G(Îº_t)â‰¥ y)â‰¥ f(y) -g(u,t)/y.

Since F(y)â†’âˆ (as yâ†’âˆ) and tâ†¦ g(u,t) is increasing and continuous, for all yâˆˆ[F^-1(2g(u,0)),âˆ) (where F^-1 is the inverse of the increasing function F
defined inÂ (a)), there exists 
a unique tâˆˆ
satisfying
F(y)=2g(u,t)âˆˆ[1,âˆ). 
Differently put, for every tâˆˆ, there exists
y_tâˆˆ[F^-1(1),âˆ)âŠ‚ [1,âˆ)
satisfying y_t=F^-1(2g(u,t)).
Thus, for every tâˆˆ, we have 
f(y_t)-g(u,t)/y_t=f(F^-1(2g(u,t)))/2.




Â§ ASYMPTOTICALLY OSCILLATING DOMAIN




Let b:â†’ (0,âˆ) be a C^2 function with b(0)=0, satisfying

    b(x) = loglog x(1 + (loglog x)^-2 + sinloglog x)    for  x > exp(+1).

Then lim sup_xâ†’âˆb(x) = âˆ and lim inf_x â†’âˆb(x) = 0. Moreover the function b satisfies assumption ass:domain2 with Î²=0, i.e.Â lim_xâ†’âˆxb'(x)/b(x)=Î²=0, and lim_xâ†’âˆb'(x)=lim_xâ†’âˆbâ€(x)=0


To show lim inf_xâ†’âˆb(x) = 0, consider â„“_k := exp(exp(-Ï€/2 + 2kÏ€)), for any kâˆˆ. It follows that 

    lim_kâ†’âˆb(â„“_k) = lim_kâ†’âˆ(loglogâ„“_k)^-1= lim_kâ†’âˆ(-Ï€/2 + 2kÏ€)^-1 = 0.

Similarly, to show lim sup_xâ†’âˆb(x)=âˆ, consider â„“Ìƒ_k := exp(exp(2kÏ€)), for any kâˆˆ. We obtain

    lim_kâ†’âˆb(â„“Ìƒ_k) = lim_kâ†’âˆ(â„“Ìƒ_k + (loglogâ„“Ìƒ_k)^-1)= lim_kâ†’âˆ2kÏ€ + (2kÏ€)^-1 =âˆ.

The first two derivatives of b on x > exp(+1) take the form

    b'(x)    = (xlog x)^-1(1-(loglog x)^-1 + sinloglog x + cosloglog x),
    
        bâ€(x)    = (xlog x)^-2((1+log x)(1 -(loglog x)^-2 + sinloglog x+cosloglog x) + 2(loglog x)^-3),

implying that lim_xâ†’âˆ b'(x) =lim_xâ†’âˆ bâ€(x) = 0. For the result about Î² it is enough to show lim sup_xâ†’âˆ |xb'(x)|/b(x) â‰¤ 0. We estimate

    lim sup_xâ†’âˆxb'(x)/b(x)   =  lim sup_xâ†’âˆ(log x)^-1|1-(loglog x)^-1 + sinloglog x + cosloglog x)/loglog x(1 + (loglog x)^-2 + sinloglog x)
       â‰¤lim sup_xâ†’âˆloglog x(3 + (loglog x)^-1)/log x = 0,

this concludes the proof.




Â§ ACKNOWLEDGEMENTS



MB is funded by the CDT in Mathematics and Statistics at The University of Warwick.
AM is supported by EPSRC under grants EP/W006227/1 & EP/V009478/1 and by The Alan Turing
Institute under the EPSRC grant EP/X03870X/1.
The work of AW is supported by EPSRC grant EP/W00657X/1.


amsplain


